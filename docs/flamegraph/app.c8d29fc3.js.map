{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-8b5c020a626ebb4a.js","node_modules/@parcel/runtime-js/lib/runtime-8346714aaa1f9283.js","package.json","node_modules/@parcel/runtime-js/lib/runtime-ca80b31a6a1f319f.js","node_modules/preact/src/constants.js","node_modules/preact/src/options.js","node_modules/preact/src/component.js","node_modules/preact/src/render.js","node_modules/preact/src/create-context.js","node_modules/preact/src/util.js","node_modules/preact/src/create-element.js","node_modules/preact/src/diff/children.js","node_modules/preact/src/diff/props.js","node_modules/preact/src/diff/index.js","src/lib/utils.ts","node_modules/preact/src/diff/catch-error.js","src/lib/lru-cache.ts","src/lib/math.ts","src/gl/graphics.ts","src/gl/utils.ts","src/gl/rectangle-batch-renderer.ts","src/lib/color.ts","src/gl/row-atlas.ts","src/gl/texture-renderer.ts","src/gl/overlay-rectangle-renderer.ts","src/gl/flamechart-color-pass-renderer.ts","src/gl/canvas-context.ts","src/views/app_types.tsx","src/app-state/getters.ts","node_modules/preact/hooks/src/index.js","node_modules/preact/compat/src/util.js","node_modules/preact/compat/src/PureComponent.js","node_modules/preact/compat/src/memo.js","node_modules/preact/compat/src/forwardRef.js","node_modules/preact/compat/src/suspense.js","node_modules/preact/compat/src/suspense-list.js","node_modules/preact/compat/src/portals.js","node_modules/preact/compat/src/render.js","node_modules/preact/compat/src/events.js","src/lib/atom.ts","src/lib/view-mode.ts","src/lib/hash-params.ts","src/app-state/profile-group.ts","src/app-state/index.ts","src/app-state/active-profile-state.ts","src/app-state/color-scheme.ts","src/views/themes/dark-theme.ts","src/views/themes/light-theme.ts","src/views/themes/theme.tsx","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/calc.js","node_modules/css-in-js-utils/lib/isPrefixedValue.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/crossFade.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/cursor.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/filter.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flex.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flexboxIE.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flexboxOld.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/gradient.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/imageSet.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/position.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/sizing.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/transition.js","node_modules/css-in-js-utils/lib/hyphenateProperty.js","node_modules/hyphenate-style-name/index.js","node_modules/aphrodite/node_modules/inline-style-prefixer/utils/capitalizeString.js","node_modules/string-hash/index.js","node_modules/aphrodite/node_modules/inline-style-prefixer/static/createPrefixer.js","node_modules/aphrodite/node_modules/inline-style-prefixer/utils/prefixProperty.js","node_modules/aphrodite/node_modules/inline-style-prefixer/utils/prefixValue.js","node_modules/aphrodite/node_modules/inline-style-prefixer/utils/addNewValuesOnly.js","node_modules/aphrodite/node_modules/inline-style-prefixer/utils/isObject.js","node_modules/asap/browser-raw.js","node_modules/asap/browser-asap.js","node_modules/aphrodite/es/index.js","src/views/style.ts","src/lib/profile-search.ts","src/views/search-view.tsx","src/lib/value-formatters.ts","src/lib/profile.ts","src/views/color-chit.tsx","src/views/scrollable-list-view.tsx","src/views/profile-table-view.tsx","src/lib/flamechart.ts","src/gl/flamechart-renderer.ts","src/views/flamechart-style.ts","src/lib/text-utils.ts","src/views/flamechart-minimap-view.tsx","src/views/flamechart-detail-view.tsx","src/lib/canvas-2d-batch-renderers.ts","src/views/flamechart-pan-zoom-view.tsx","src/views/hovertip.tsx","src/views/flamechart-search-view.tsx","src/lib/preact-helpers.tsx","src/views/flamechart-view.tsx","src/views/flamechart-view-container.tsx","src/views/flamechart-wrapper.tsx","src/views/inverted-caller-flamegraph-view.tsx","src/views/callee-flamegraph-view.tsx","src/views/sandwich-search-view.tsx","src/views/sandwich-view.tsx","src/views/application.tsx","src/views/application-container.tsx","src/speedscope.tsx"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","module.exports = (__parcel__import__(\"./\" + require('./helpers/bundle-manifest').resolve(\"jcw0e\"))).then(() => parcelRequire('92x6n'));","module.exports = (__parcel__import__(\"./\" + require('./helpers/bundle-manifest').resolve(\"H4mWn\"))).then(() => parcelRequire('eCNwS'));","{\n  \"name\": \"speedscope\",\n  \"version\": \"1.15.0\",\n  \"description\": \"\",\n  \"repository\": \"jlfwong/speedscope\",\n  \"main\": \"index.js\",\n  \"targets\": {\n    \"main\": false\n  },\n  \"bin\": {\n    \"speedscope\": \"./bin/cli.js\"\n  },\n  \"scripts\": {\n    \"deploy\": \"./scripts/deploy.sh\",\n    \"prepack\": \"./scripts/build-release.sh\",\n    \"prettier\": \"prettier --write 'src/**/*.ts' 'src/**/*.tsx'\",\n    \"lint\": \"eslint 'src/**/*.ts' 'src/**/*.tsx'\",\n    \"jest\": \"./scripts/test-setup.sh && jest --runInBand\",\n    \"coverage\": \"npm run jest -- --coverage\",\n    \"typecheck\": \"tsc --noEmit\",\n    \"test\": \"./scripts/ci.sh\",\n    \"build\": \"parcel build assets/index.html assets/app.html assets/data/**/* --no-autoinstall --dist-dir ../../tail2-server/static/flamegraph --public-url /flamegraph\",\n    \"watch\": \"parcel watch assets/index.html assets/app.html assets/data/**/* --no-autoinstall --dist-dir ../../tail2-server/static/flamegraph --public-url /flamegraph\"\n  },\n  \"files\": [\n    \"bin/cli.js\",\n    \"dist/release/**\",\n    \"!*.map\"\n  ],\n  \"browserslist\": [\n    \"last 2 Chrome versions\",\n    \"last 2 Firefox versions\"\n  ],\n  \"author\": \"\",\n  \"license\": \"MIT\",\n  \"devDependencies\": {\n    \"@types/jest\": \"22.2.3\",\n    \"@types/jszip\": \"3.1.4\",\n    \"@types/node\": \"14.0.1\",\n    \"@types/pako\": \"1.0.0\",\n    \"@typescript-eslint/eslint-plugin\": \"4.19.0\",\n    \"@typescript-eslint/parser\": \"4.19.0\",\n    \"acorn\": \"7.2.0\",\n    \"eslint\": \"6.0.0\",\n    \"eslint-plugin-prettier\": \"2.6.0\",\n    \"eslint-plugin-react-hooks\": \"4.0.2\",\n    \"jest\": \"24.3.0\",\n    \"jsverify\": \"0.8.3\",\n    \"jszip\": \"3.1.5\",\n    \"pako\": \"1.0.6\",\n    \"parcel\": \"^2.8.0\",\n    \"parcel-resolver-ignore\": \"^2.1.3\",\n    \"postcss\": \"^8.4.19\",\n    \"prettier\": \"2.0.4\",\n    \"protobufjs\": \"6.8.8\",\n    \"tailwindcss\": \"^3.1.6\",\n    \"ts-jest\": \"24.3.0\",\n    \"typescript\": \"4.2.3\",\n    \"typescript-json-schema\": \"0.42.0\",\n    \"uglify-es\": \"3.2.2\",\n    \"uint8array-json-parser\": \"0.0.2\"\n  },\n  \"jest\": {\n    \"transform\": {\n      \"^.+\\\\.tsx?$\": \"ts-jest\"\n    },\n    \"setupFilesAfterEnv\": [\n      \"./src/jest-setup.js\"\n    ],\n    \"testRegex\": \"\\\\.test\\\\.tsx?$\",\n    \"collectCoverageFrom\": [\n      \"**/*.{ts,tsx}\",\n      \"!**/*.d.{ts,tsx}\"\n    ],\n    \"moduleFileExtensions\": [\n      \"ts\",\n      \"tsx\",\n      \"js\",\n      \"jsx\",\n      \"json\"\n    ]\n  },\n  \"dependencies\": {\n    \"@parcel/transformer-postcss\": \"^2.8.1\",\n    \"@tailwindcss/forms\": \"^0.5.3\",\n    \"aphrodite\": \"2.1.0\",\n    \"chart.js\": \"^4.0.1\",\n    \"chartjs-adapter-moment\": \"^1.0.1\",\n    \"open\": \"7.2.0\",\n    \"preact\": \"10.4.1\",\n    \"preact-transition-group\": \"^2.0.0\",\n    \"source-map\": \"0.6.1\"\n  },\n  \"parcelIgnore\": [\n    \"./app\\\\?profileURL=.+\"\n  ]\n}\n","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"lNlOQ\\\":\\\"app.c8d29fc3.js\\\",\\\"jcw0e\\\":\\\"demangle-cpp.ff403f05.js\\\",\\\"H4mWn\\\":\\\"source-map.f62d5ab4.js\\\"}\"));","export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n","import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError\n};\n\nexport default options;\n","import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\tupdate = update(s, this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = oldVNode;\n\n\t\tlet newDom = diff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tnull,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (newDom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\nlet rerenderCount = 0;\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\nconst IS_HYDRATE = EMPTY_OBJ;\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {Element | Text} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we\n\t// are in hydration mode or not by passing `IS_HYDRATE` instead of a\n\t// DOM element.\n\tlet isHydrating = replaceNode === IS_HYDRATE;\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\tvnode = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\t((isHydrating ? parentDom : replaceNode || parentDom)._children = vnode),\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\treplaceNode && !isHydrating\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: EMPTY_ARR.slice.call(parentDom.childNodes),\n\t\tcommitQueue,\n\t\treplaceNode || EMPTY_OBJ,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, IS_HYDRATE);\n}\n","import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue) {\n\tconst ctx = {};\n\n\tconst context = {\n\t\t_id: '__cC' + i++,\n\t\t_defaultValue: defaultValue,\n\t\tConsumer(props, context) {\n\t\t\treturn props.children(context);\n\t\t},\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tconst subs = [];\n\t\t\t\tthis.getChildContext = () => {\n\t\t\t\t\tctx[context._id] = this;\n\t\t\t\t\treturn ctx;\n\t\t\t\t};\n\n\t\t\t\tthis.shouldComponentUpdate = _props => {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\tsubs.some(c => {\n\t\t\t\t\t\t\tc.context = _props.value;\n\t\t\t\t\t\t\tenqueueRender(c);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\told && old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\tcontext.Consumer.contextType = context;\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\tcontext.Provider._contextRef = context;\n\n\treturn context;\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\ti;\n\tfor (i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(\n\t\ttype,\n\t\tnormalizedProps,\n\t\tprops && props.key,\n\t\tprops && props.ref,\n\t\tnull\n\t);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\tconstructor: undefined,\n\t\t_original: original\n\t};\n\n\tif (original == null) vnode._original = vnode;\n\tif (options.vnode) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn {};\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n","import { diff, unmount, applyRef } from './index';\nimport { createVNode } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { removeNode } from '../util';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Node | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, newDom, sibDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\t// Only in very specific places should this logic be invoked (top level `render` and `diffElementNodes`).\n\t// I'm using `EMPTY_OBJ` to signal when `diffChildren` is invoked in these situations. I can't use `null`\n\t// for this purpose, because `null` is a valid value for `oldDom` which can mean to skip to this logic\n\t// (e.g. if mounting a new tree in which the old DOM should be ignored (usually for Fragments).\n\tif (oldDom == EMPTY_OBJ) {\n\t\tif (excessDomChildren != null) {\n\t\t\toldDom = excessDomChildren[0];\n\t\t} else if (oldChildrenLength) {\n\t\t\toldDom = getDomSibling(oldParentVNode, 0);\n\t\t} else {\n\t\t\toldDom = null;\n\t\t}\n\t}\n\n\ti = 0;\n\tnewParentVNode._children = toChildArray(\n\t\tnewParentVNode._children,\n\t\tchildVNode => {\n\t\t\tif (childVNode != null) {\n\t\t\t\tchildVNode._parent = newParentVNode;\n\t\t\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t\t\t// Check if we find a corresponding element in oldChildren.\n\t\t\t\t// If found, delete the array item by setting to `undefined`.\n\t\t\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t\t\t// (holes).\n\t\t\t\toldVNode = oldChildren[i];\n\n\t\t\t\tif (\n\t\t\t\t\toldVNode === null ||\n\t\t\t\t\t(oldVNode &&\n\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t\t\t) {\n\t\t\t\t\toldChildren[i] = undefined;\n\t\t\t\t} else {\n\t\t\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t\t\t// We always match by type (in either case).\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\toldVNode &&\n\t\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toldVNode = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\t\t\tnewDom = diff(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\tglobalContext,\n\t\t\t\t\tisSvg,\n\t\t\t\t\texcessDomChildren,\n\t\t\t\t\tcommitQueue,\n\t\t\t\t\toldDom,\n\t\t\t\t\tisHydrating\n\t\t\t\t);\n\n\t\t\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\t\t\tif (!refs) refs = [];\n\t\t\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t\t\t}\n\n\t\t\t\t// Only proceed if the vnode has not been unmounted by `diff()` above.\n\t\t\t\tif (newDom != null) {\n\t\t\t\t\tif (firstChildDom == null) {\n\t\t\t\t\t\tfirstChildDom = newDom;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet nextDom;\n\t\t\t\t\tif (childVNode._nextDom !== undefined) {\n\t\t\t\t\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t\t\t\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t\t\t\t\t// of last DOM child of this child VNode\n\t\t\t\t\t\tnextDom = childVNode._nextDom;\n\n\t\t\t\t\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t\t\t\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t\t\t\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t\t\t\t\t// can clean up the property\n\t\t\t\t\t\tchildVNode._nextDom = undefined;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\texcessDomChildren == oldVNode ||\n\t\t\t\t\t\tnewDom != oldDom ||\n\t\t\t\t\t\tnewDom.parentNode == null\n\t\t\t\t\t) {\n\t\t\t\t\t\t// NOTE: excessDomChildren==oldVNode above:\n\t\t\t\t\t\t// This is a compression of excessDomChildren==null && oldVNode==null!\n\t\t\t\t\t\t// The values only have the same type when `null`.\n\n\t\t\t\t\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\t\t\t\t\tparentDom.appendChild(newDom);\n\t\t\t\t\t\t\tnextDom = null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\t\t\t\t\tfor (\n\t\t\t\t\t\t\t\tsibDom = oldDom, j = 0;\n\t\t\t\t\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildrenLength;\n\t\t\t\t\t\t\t\tj += 2\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\t\t\t\t\tnextDom = oldDom;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t\t\t\t// there are probably some internal data structures that aren't\n\t\t\t\t\t\t// updated properly.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t\t\t\t// value check in `diff()` won't be skipped.\n\t\t\t\t\t\tif (newParentVNode.type == 'option') {\n\t\t\t\t\t\t\tparentDom.value = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t\t\t\t\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t\t\t\t\t// See more detail in create-element.js:createVNode\n\t\t\t\t\tif (nextDom !== undefined) {\n\t\t\t\t\t\toldDom = nextDom;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toldDom = newDom.nextSibling;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof newParentVNode.type == 'function') {\n\t\t\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t\t\t// node's nextSibling.\n\n\t\t\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t\t\t}\n\t\t\t\t} else if (\n\t\t\t\t\toldDom &&\n\t\t\t\t\toldVNode._dom == oldDom &&\n\t\t\t\t\toldDom.parentNode != parentDom\n\t\t\t\t) {\n\t\t\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\t\t\toldDom = getDomSibling(oldVNode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti++;\n\t\t\treturn childVNode;\n\t\t}\n\t);\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove children that are not part of any vnode.\n\tif (excessDomChildren != null && typeof newParentVNode.type != 'function') {\n\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t}\n\t}\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) unmount(oldChildren[i], oldChildren[i]);\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @param {(vnode: import('../internal').VNode) => import('../internal').VNode} [callback]\n * A function to invoke for each child before it is added to the flattened list.\n * @param {Array<import('../internal').VNode | string | number>} [flattened] An flat array of children to modify\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, callback, flattened) {\n\tif (flattened == null) flattened = [];\n\n\tif (children == null || typeof children == 'boolean') {\n\t\tif (callback) flattened.push(callback(null));\n\t} else if (Array.isArray(children)) {\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\ttoChildArray(children[i], callback, flattened);\n\t\t}\n\t} else if (!callback) {\n\t\tflattened.push(children);\n\t} else if (typeof children == 'string' || typeof children == 'number') {\n\t\tflattened.push(callback(createVNode(null, children, null, null, children)));\n\t} else if (children._dom != null || children._component != null) {\n\t\tflattened.push(\n\t\t\tcallback(\n\t\t\t\tcreateVNode(\n\t\t\t\t\tchildren.type,\n\t\t\t\t\tchildren.props,\n\t\t\t\t\tchildren.key,\n\t\t\t\t\tnull,\n\t\t\t\t\tchildren._original\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tflattened.push(callback(children));\n\t}\n\n\treturn flattened;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (\n\t\ttypeof value == 'number' &&\n\t\tIS_NON_DIMENSIONAL.test(key) === false\n\t) {\n\t\tstyle[key] = value + 'px';\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else {\n\t\tstyle[key] = value;\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet s, useCapture, nameLower;\n\n\tif (isSvg) {\n\t\tif (name === 'className') {\n\t\t\tname = 'class';\n\t\t}\n\t} else if (name === 'class') {\n\t\tname = 'className';\n\t}\n\n\tif (name === 'style') {\n\t\ts = dom.style;\n\n\t\tif (typeof value == 'string') {\n\t\t\ts.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\ts.cssText = '';\n\t\t\t\toldValue = null;\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (let i in oldValue) {\n\t\t\t\t\tif (!(value && i in value)) {\n\t\t\t\t\t\tsetStyle(s, i, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (let i in value) {\n\t\t\t\t\tif (!oldValue || value[i] !== oldValue[i]) {\n\t\t\t\t\t\tsetStyle(s, i, value[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tnameLower = name.toLowerCase();\n\t\tname = (nameLower in dom ? nameLower : name).slice(2);\n\n\t\tif (value) {\n\t\t\tif (!oldValue) dom.addEventListener(name, eventProxy, useCapture);\n\t\t\t(dom._listeners || (dom._listeners = {}))[name] = value;\n\t\t} else {\n\t\t\tdom.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t} else if (\n\t\tname !== 'list' &&\n\t\tname !== 'tagName' &&\n\t\t// HTMLButtonElement.form and HTMLInputElement.form are read-only but can be set using\n\t\t// setAttribute\n\t\tname !== 'form' &&\n\t\tname !== 'type' &&\n\t\tname !== 'size' &&\n\t\t!isSvg &&\n\t\tname in dom\n\t) {\n\t\tdom[name] = value == null ? '' : value;\n\t} else if (typeof value != 'function' && name !== 'dangerouslySetInnerHTML') {\n\t\tif (name !== (name = name.replace(/^xlink:?/, ''))) {\n\t\t\tif (value == null || value === false) {\n\t\t\t\tdom.removeAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase()\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdom.setAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase(),\n\t\t\t\t\tvalue\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\tvalue == null ||\n\t\t\t(value === false &&\n\t\t\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t\t\t// The value `false` is different from the attribute not\n\t\t\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t\t\t// that other VDOM frameworks also always stringify `false`.\n\t\t\t\t!/^ar/.test(name))\n\t\t) {\n\t\t\tdom.removeAttribute(name);\n\t\t} else {\n\t\t\tdom.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type](options.event ? options.event(e) : e);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Element | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\t(newVNode._original === oldVNode._original && !c._processingException)\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (tmp = 0; tmp < newVNode._children.length; tmp++) {\n\t\t\t\t\t\tif (newVNode._children[tmp]) {\n\t\t\t\t\t\t\tnewVNode._children[tmp]._parent = newVNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type == Fragment && tmp.key == null;\n\t\t\tnewVNode._children = isTopLevelFragment\n\t\t\t\t? tmp.props.children\n\t\t\t\t: Array.isArray(tmp)\n\t\t\t\t? tmp\n\t\t\t\t: [tmp];\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n\n\treturn newVNode._dom;\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet i;\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvg = newVNode.type === 'svg' || isSvg;\n\n\tif (excessDomChildren != null) {\n\t\tfor (i = 0; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild != null &&\n\t\t\t\t((newVNode.type === null\n\t\t\t\t\t? child.nodeType === 3\n\t\t\t\t\t: child.localName === newVNode.type) ||\n\t\t\t\t\tdom == child)\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (newVNode.type === null) {\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tdom = isSvg\n\t\t\t? document.createElementNS('http://www.w3.org/2000/svg', newVNode.type)\n\t\t\t: document.createElement(\n\t\t\t\t\tnewVNode.type,\n\t\t\t\t\tnewProps.is && { is: newProps.is }\n\t\t\t  );\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (newVNode.type === null) {\n\t\tif (oldProps !== newProps && dom.data != newProps) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\tif (excessDomChildren != null) {\n\t\t\texcessDomChildren = EMPTY_ARR.slice.call(dom.childNodes);\n\t\t}\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\tif (oldProps === EMPTY_OBJ) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (!newHtml || !oldHtml || newHtml.__html != oldHtml.__html) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\tnewVNode._children = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tnewVNode.type === 'foreignObject' ? false : isSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tEMPTY_OBJ,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\ti !== dom.value\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","export function lastOf<T>(ts: T[]): T | null {\n  return ts[ts.length - 1] || null\n}\n\nexport function sortBy<T>(ts: T[], key: (t: T) => number | string): void {\n  function comparator(a: T, b: T) {\n    const keyA = key(a)\n    const keyB = key(b)\n    return keyA < keyB ? -1 : keyA > keyB ? 1 : 0\n  }\n  ts.sort(comparator)\n}\n\nexport function getOrInsert<K, V>(map: Map<K, V>, k: K, fallback: (k: K) => V): V {\n  if (!map.has(k)) map.set(k, fallback(k))\n  return map.get(k)!\n}\n\nexport function getOrElse<K, V>(map: Map<K, V>, k: K, fallback: (k: K) => V): V {\n  if (!map.has(k)) return fallback(k)\n  return map.get(k)!\n}\n\nexport function getOrThrow<K, V>(map: Map<K, V>, k: K): V {\n  if (!map.has(k)) {\n    throw new Error(`Expected key ${k}`)\n  }\n  return map.get(k)!\n}\n\n// Intended to be used to de-duplicate objects based on a key property. This\n// allows value comparisons to be done efficiently and for the returned objects\n// to be used intuitively in Map objects.\n//\n// Example usage:\n//\n// export class Frame {\n//   private constructor(readonly file: string, readonly name: string) {}\n//   get key() { return `${this.file}:${this.name}` }\n//   static getOrInsert(set: KeyedSet<Frame>, file: string, name: string) {\n//     return set.getOrInsert(set, new Frame(file, name))\n//   }\n// }\n//\nexport interface HasKey {\n  readonly key: string | number\n}\nexport class KeyedSet<T extends HasKey> implements Iterable<T> {\n  private map = new Map<string | number, T>()\n\n  getOrInsert(t: T): T {\n    const key = t.key\n    const existing = this.map.get(key)\n    if (existing) return existing\n    this.map.set(key, t)\n    return t\n  }\n  forEach(fn: (t: T) => void) {\n    this.map.forEach(fn)\n  }\n  [Symbol.iterator]() {\n    return this.map.values()\n  }\n}\n\nexport function* itMap<T, U>(it: Iterable<T>, f: (t: T) => U): Iterable<U> {\n  for (let t of it) {\n    yield f(t)\n  }\n}\n\nexport function itForEach<T>(it: Iterable<T>, f: (t: T) => void): void {\n  for (let t of it) {\n    f(t)\n  }\n}\n\nexport function itReduce<T, U>(it: Iterable<T>, f: (a: U, b: T) => U, init: U): U {\n  let accum: U = init\n  for (let t of it) {\n    accum = f(accum, t)\n  }\n  return accum\n}\n\nexport function zeroPad(s: string, width: number) {\n  return new Array(Math.max(width - s.length, 0) + 1).join('0') + s\n}\n\nexport function formatPercent(percent: number) {\n  let formattedPercent = `${percent.toFixed(0)}%`\n  if (percent === 100) formattedPercent = '100%'\n  else if (percent > 99) formattedPercent = '>99%'\n  else if (percent < 0.01) formattedPercent = '<0.01%'\n  else if (percent < 1) formattedPercent = `${percent.toFixed(2)}%`\n  else if (percent < 10) formattedPercent = `${percent.toFixed(1)}%`\n  return formattedPercent\n}\n\nexport function fract(x: number) {\n  return x - Math.floor(x)\n}\n\nexport function triangle(x: number) {\n  return 2.0 * Math.abs(fract(x) - 0.5) - 1.0\n}\n\nexport function findValueBisect(\n  lo: number,\n  hi: number,\n  f: (val: number) => number,\n  target: number,\n  targetRangeSize = 1,\n): [number, number] {\n  console.assert(!isNaN(targetRangeSize) && !isNaN(target))\n  while (true) {\n    if (hi - lo <= targetRangeSize) return [lo, hi]\n    const mid = (hi + lo) / 2\n    const val = f(mid)\n    if (val < target) lo = mid\n    else hi = mid\n  }\n}\n\n// Similar to Array.prototype.findIndex, except uses a binary search.\n//\n// This assumes that the condition transitions exactly once from false to true\n// in the list, e.g. the following is a valid input:\n//\n//  ls        = [a, b, c, d]\n//  ls.map(f) = [false, false, true, true]\n//\n// The following is an invalid input:\n//\n//  ls        = [a, b, c, d]\n//  ls.map(f) = [false, true, false, true]\nexport function findIndexBisect<T>(ls: T[], f: (val: T) => boolean): number {\n  if (ls.length === 0) return -1\n\n  let lo = 0\n  let hi = ls.length - 1\n\n  while (hi !== lo) {\n    const mid = Math.floor((lo + hi) / 2)\n\n    if (f(ls[mid])) {\n      // The desired index is <= mid\n      hi = mid\n    } else {\n      // The desired index is > mid\n      lo = mid + 1\n    }\n  }\n\n  return f(ls[hi]) ? hi : -1\n}\n\nexport function noop(...args: any[]) {}\n\nexport function objectsHaveShallowEquality<T extends object>(a: T, b: T): boolean {\n  for (let key in a) {\n    if (a[key] !== b[key]) return false\n  }\n  for (let key in b) {\n    if (a[key] !== b[key]) return false\n  }\n  return true\n}\n\nexport function memoizeByShallowEquality<T extends object, U>(cb: (t: T) => U): (t: T) => U {\n  let last: {args: T; result: U} | null = null\n  return (args: T) => {\n    let result: U\n    if (last == null) {\n      result = cb(args)\n      last = {args, result}\n      return result\n    } else if (objectsHaveShallowEquality(last.args, args)) {\n      return last.result\n    } else {\n      last.args = args\n      last.result = cb(args)\n      return last.result\n    }\n  }\n}\n\nexport function memoizeByReference<T, U>(cb: (t: T) => U): (t: T) => U {\n  let last: {args: T; result: U} | null = null\n  return (args: T) => {\n    let result: U\n    if (last == null) {\n      result = cb(args)\n      last = {args, result}\n      return result\n    } else if (last.args === args) {\n      return last.result\n    } else {\n      last.args = args\n      last.result = cb(args)\n      return last.result\n    }\n  }\n}\n\nexport function lazyStatic<T>(cb: () => T): () => T {\n  let last: {result: T} | null = null\n  return () => {\n    if (last == null) {\n      last = {result: cb()}\n    }\n    return last.result\n  }\n}\n\nconst base64lookupTable = lazyStatic(\n  (): Map<string, number> => {\n    const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n    const ret = new Map<string, number>()\n    for (let i = 0; i < alphabet.length; i++) {\n      ret.set(alphabet.charAt(i), i)\n    }\n    ret.set('=', -1)\n    return ret\n  },\n)\n\n// NOTE: There are probably simpler solutions to this problem, but I have this written already, so\n// until we run into problems with this, let's just use this.\n//\n// See: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#The_Unicode_Problem#The_Unicode_Problem\nexport function decodeBase64(encoded: string): Uint8Array {\n  // Reference: https://www.rfc-editor.org/rfc/rfc4648.txt\n\n  const lookupTable = base64lookupTable()\n\n  // 3 byte groups are represented as sequneces of 4 characters.\n  //\n  // \"The encoding process represents 24-bit groups of input bits as output\n  //  strings of 4 encoded characters.\"\n  //\n  // \"Special processing is performed if fewer than 24 bits are available\n  //  at the end of the data being encoded.  A full encoding quantum is\n  //  always completed at the end of a quantity.  When fewer than 24 input\n  //  bits are available in an input group bits with value zero are added\n  //  (on the right) to form an integral number of 6-bit groups.\"\n\n  if (encoded.length % 4 !== 0) {\n    throw new Error(\n      `Invalid length for base64 encoded string. Expected length % 4 = 0, got length = ${encoded.length}`,\n    )\n  }\n\n  const quartetCount = encoded.length / 4\n  let byteCount: number\n\n  // Special processing is performed if fewer than 24 bits are available\n  // at the end of the data being encoded.  A full encoding quantum is\n  // always completed at the end of a quantity.  When fewer than 24 input\n  // bits are available in an input group, bits with value zero are added\n  // (on the right) to form an integral number of 6-bit groups.  Padding\n  // at the end of the data is performed using the '=' character.  Since\n  // all base 64 input is an integral number of octets, only the following\n  // cases can arise:\n  //\n  // (1) The final quantum of encoding input is an integral multiple of 24\n  //     bits; here, the final unit of encoded output will be an integral\n  //     multiple of 4 characters with no \"=\" padding.\n  //\n  // (2) The final quantum of encoding input is exactly 8 bits; here, the\n  //     final unit of encoded output will be two characters followed by\n  //     two \"=\" padding characters.\n  //\n  // (3) The final quantum of encoding input is exactly 16 bits; here, the\n  //     final unit of encoded output will be three characters followed by\n  //     one \"=\" padding character.\n  if (encoded.length >= 4) {\n    if (encoded.charAt(encoded.length - 1) === '=') {\n      if (encoded.charAt(encoded.length - 2) === '=') {\n        // Case (2)\n        byteCount = quartetCount * 3 - 2\n      } else {\n        // Case (3)\n        byteCount = quartetCount * 3 - 1\n      }\n    } else {\n      // Case (1)\n      byteCount = quartetCount * 3\n    }\n  } else {\n    // Case (1)\n    byteCount = quartetCount * 3\n  }\n\n  const bytes = new Uint8Array(byteCount)\n  let offset = 0\n\n  for (let i = 0; i < quartetCount; i++) {\n    const enc1 = encoded.charAt(i * 4 + 0)\n    const enc2 = encoded.charAt(i * 4 + 1)\n    const enc3 = encoded.charAt(i * 4 + 2)\n    const enc4 = encoded.charAt(i * 4 + 3)\n\n    const sextet1 = lookupTable.get(enc1)\n    const sextet2 = lookupTable.get(enc2)\n    const sextet3 = lookupTable.get(enc3)\n    const sextet4 = lookupTable.get(enc4)\n\n    if (sextet1 == null || sextet2 == null || sextet3 == null || sextet4 == null) {\n      throw new Error(\n        `Invalid quartet at indices ${i * 4} .. ${i * 4 + 3}: ${encoded.substring(\n          i * 4,\n          i * 4 + 3,\n        )}`,\n      )\n    }\n\n    bytes[offset++] = (sextet1 << 2) | (sextet2 >> 4)\n    if (enc3 !== '=') {\n      bytes[offset++] = ((sextet2 & 15) << 4) | (sextet3 >> 2)\n    }\n    if (enc4 !== '=') {\n      bytes[offset++] = ((sextet3 & 7) << 6) | sextet4\n    }\n  }\n\n  if (offset !== byteCount) {\n    throw new Error(`Expected to decode ${byteCount} bytes, but only decoded ${offset})`)\n  }\n\n  return bytes\n}\n","import { enqueueRender } from '../component';\n\n/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, hasCaught;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tif (\n\t\t\t\t\tcomponent.constructor &&\n\t\t\t\t\tcomponent.constructor.getDerivedStateFromError != null\n\t\t\t\t) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.setState(\n\t\t\t\t\t\tcomponent.constructor.getDerivedStateFromError(error)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t}\n\n\t\t\t\tif (hasCaught)\n\t\t\t\t\treturn enqueueRender((component._pendingError = component));\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n","class ListNode<V> {\n  prev: ListNode<V> | null = null\n  next: ListNode<V> | null = null\n  constructor(readonly data: V) {}\n}\n\nexport class List<V> {\n  private head: ListNode<V> | null = null\n  private tail: ListNode<V> | null = null\n  private size: number = 0\n  constructor() {}\n\n  getHead(): ListNode<V> | null {\n    return this.head\n  }\n  getTail(): ListNode<V> | null {\n    return this.tail\n  }\n  getSize(): number {\n    return this.size\n  }\n\n  append(node: ListNode<V>): void {\n    if (!this.tail) {\n      this.head = this.tail = node\n    } else {\n      this.tail.next = node\n      node.prev = this.tail\n      this.tail = node\n    }\n    this.size++\n  }\n\n  prepend(node: ListNode<V>): ListNode<V> {\n    if (!this.head) {\n      this.head = this.tail = node\n    } else {\n      this.head.prev = node\n      node.next = this.head\n      this.head = node\n    }\n    this.size++\n    return node\n  }\n\n  pop(): ListNode<V> | null {\n    if (!this.tail) {\n      return null\n    } else {\n      const ret = this.tail\n      if (ret.prev) {\n        this.tail = ret.prev\n        this.tail.next = null\n      } else {\n        this.head = this.tail = null\n      }\n      this.size--\n      ret.prev = null\n      return ret\n    }\n  }\n\n  dequeue(): ListNode<V> | null {\n    if (!this.head) {\n      return null\n    } else {\n      const ret = this.head\n      if (ret.next) {\n        this.head = ret.next\n        this.head.prev = null\n      } else {\n        this.head = this.tail = null\n      }\n      this.size--\n      ret.next = null\n      return ret\n    }\n  }\n\n  remove(node: ListNode<V>): void {\n    if (node.prev == null) {\n      this.dequeue()\n    } else if (node.next == null) {\n      this.pop()\n    } else {\n      // Neither first nor last, should be safe to just link\n      // neighbours.\n      node.next.prev = node.prev\n      node.prev.next = node.next\n      node.next = null\n      node.prev = null\n      this.size--\n    }\n  }\n}\n\ninterface LRUCacheNode<K, V> {\n  value: V\n  listNode: ListNode<K>\n}\n\nexport class LRUCache<K, V> {\n  private list = new List<K>()\n  private map = new Map<K, LRUCacheNode<K, V>>()\n\n  constructor(private capacity: number) {}\n\n  has(key: K): boolean {\n    return this.map.has(key)\n  }\n\n  get(key: K): V | null {\n    const node = this.map.get(key)\n    if (!node) {\n      return null\n    }\n    // Bring node to the front of the list\n    this.list.remove(node.listNode)\n    this.list.prepend(node.listNode)\n\n    return node ? node.value : null\n  }\n\n  getSize() {\n    return this.list.getSize()\n  }\n\n  getCapacity() {\n    return this.capacity\n  }\n\n  insert(key: K, value: V) {\n    const node = this.map.get(key)\n    if (node) {\n      this.list.remove(node.listNode)\n    }\n    // Evict old entries when out of capacity\n    while (this.list.getSize() >= this.capacity) {\n      this.map.delete(this.list.pop()!.data)\n    }\n    const listNode = this.list.prepend(new ListNode(key))\n    this.map.set(key, {value, listNode})\n  }\n\n  getOrInsert(key: K, f: (key: K) => V): V {\n    let value = this.get(key)\n    if (value == null) {\n      value = f(key)\n      this.insert(key, value)\n    }\n    return value\n  }\n\n  removeLRU(): [K, V] | null {\n    const oldest = this.list.pop()\n    if (!oldest) return null\n    const key = oldest.data\n    const value = this.map.get(key)!.value\n    this.map.delete(key)\n    return [key, value]\n  }\n\n  clear() {\n    this.list = new List<K>()\n    this.map = new Map<K, LRUCacheNode<K, V>>()\n  }\n}\n","export function clamp(x: number, minVal: number, maxVal: number) {\n  if (x < minVal) return minVal\n  if (x > maxVal) return maxVal\n  return x\n}\n\nexport class Vec2 {\n  constructor(readonly x: number, readonly y: number) {}\n  withX(x: number) {\n    return new Vec2(x, this.y)\n  }\n  withY(y: number) {\n    return new Vec2(this.x, y)\n  }\n\n  plus(other: Vec2) {\n    return new Vec2(this.x + other.x, this.y + other.y)\n  }\n  minus(other: Vec2) {\n    return new Vec2(this.x - other.x, this.y - other.y)\n  }\n  times(scalar: number) {\n    return new Vec2(this.x * scalar, this.y * scalar)\n  }\n  timesPointwise(other: Vec2) {\n    return new Vec2(this.x * other.x, this.y * other.y)\n  }\n  dividedByPointwise(other: Vec2) {\n    return new Vec2(this.x / other.x, this.y / other.y)\n  }\n  dot(other: Vec2) {\n    return this.x * other.x + this.y * other.y\n  }\n  equals(other: Vec2) {\n    return this.x === other.x && this.y === other.y\n  }\n  approxEquals(other: Vec2, epsilon = 1e-9) {\n    return Math.abs(this.x - other.x) < epsilon && Math.abs(this.y - other.y) < epsilon\n  }\n\n  length2() {\n    return this.dot(this)\n  }\n  length() {\n    return Math.sqrt(this.length2())\n  }\n  abs() {\n    return new Vec2(Math.abs(this.x), Math.abs(this.y))\n  }\n\n  static min(a: Vec2, b: Vec2) {\n    return new Vec2(Math.min(a.x, b.x), Math.min(a.y, b.y))\n  }\n\n  static max(a: Vec2, b: Vec2) {\n    return new Vec2(Math.max(a.x, b.x), Math.max(a.y, b.y))\n  }\n\n  static clamp(v: Vec2, min: Vec2, max: Vec2) {\n    return new Vec2(clamp(v.x, min.x, max.x), clamp(v.y, min.y, max.y))\n  }\n\n  static zero = new Vec2(0, 0)\n  static unit = new Vec2(1, 1)\n\n  flatten(): [number, number] {\n    return [this.x, this.y]\n  }\n}\n\nexport class AffineTransform {\n  constructor(\n    readonly m00 = 1,\n    readonly m01 = 0,\n    readonly m02 = 0,\n    readonly m10 = 0,\n    readonly m11 = 1,\n    readonly m12 = 0,\n  ) {}\n\n  withScale(s: Vec2) {\n    let {m00, m01, m02, m10, m11, m12} = this\n    m00 = s.x\n    m11 = s.y\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n  static withScale(s: Vec2) {\n    return new AffineTransform().withScale(s)\n  }\n  scaledBy(s: Vec2) {\n    return AffineTransform.withScale(s).times(this)\n  }\n  getScale() {\n    return new Vec2(this.m00, this.m11)\n  }\n\n  withTranslation(t: Vec2) {\n    let {m00, m01, m02, m10, m11, m12} = this\n    m02 = t.x\n    m12 = t.y\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n  static withTranslation(t: Vec2) {\n    return new AffineTransform().withTranslation(t)\n  }\n  getTranslation() {\n    return new Vec2(this.m02, this.m12)\n  }\n  translatedBy(t: Vec2) {\n    return AffineTransform.withTranslation(t).times(this)\n  }\n\n  static betweenRects(from: Rect, to: Rect) {\n    return AffineTransform.withTranslation(from.origin.times(-1))\n      .scaledBy(new Vec2(to.size.x / from.size.x, to.size.y / from.size.y))\n      .translatedBy(to.origin)\n  }\n\n  times(other: AffineTransform) {\n    const m00 = this.m00 * other.m00 + this.m01 * other.m10\n    const m01 = this.m00 * other.m01 + this.m01 * other.m11\n    const m02 = this.m00 * other.m02 + this.m01 * other.m12 + this.m02\n\n    const m10 = this.m10 * other.m00 + this.m11 * other.m10\n    const m11 = this.m10 * other.m01 + this.m11 * other.m11\n    const m12 = this.m10 * other.m02 + this.m11 * other.m12 + this.m12\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n\n  equals(other: AffineTransform) {\n    return (\n      this.m00 == other.m00 &&\n      this.m01 == other.m01 &&\n      this.m02 == other.m02 &&\n      this.m10 == other.m10 &&\n      this.m11 == other.m11 &&\n      this.m12 == other.m12\n    )\n  }\n\n  approxEquals(other: AffineTransform, epsilon = 1e-9) {\n    return (\n      Math.abs(this.m00 - other.m00) < epsilon &&\n      Math.abs(this.m01 - other.m01) < epsilon &&\n      Math.abs(this.m02 - other.m02) < epsilon &&\n      Math.abs(this.m10 - other.m10) < epsilon &&\n      Math.abs(this.m11 - other.m11) < epsilon &&\n      Math.abs(this.m12 - other.m12) < epsilon\n    )\n  }\n\n  timesScalar(s: number) {\n    const {m00, m01, m02, m10, m11, m12} = this\n    return new AffineTransform(s * m00, s * m01, s * m02, s * m10, s * m11, s * m12)\n  }\n\n  det() {\n    const {m00, m01, m02, m10, m11, m12} = this\n    const m20 = 0\n    const m21 = 0\n    const m22 = 1\n\n    return (\n      m00 * (m11 * m22 - m12 * m21) - m01 * (m10 * m22 - m12 * m20) + m02 * (m10 * m21 - m11 * m20)\n    )\n  }\n\n  adj() {\n    const {m00, m01, m02, m10, m11, m12} = this\n    const m20 = 0\n    const m21 = 0\n    const m22 = 1\n\n    // Adjugate matrix (a) is the transpose of the\n    // cofactor matrix (c).\n    //\n    // 00 01 02\n    // 10 11 12\n    // 20 21 22\n\n    const a00 = /* c00 = */ +(m11 * m22 - m12 * m21)\n    const a01 = /* c10 = */ -(m01 * m22 - m02 * m21)\n    const a02 = /* c20 = */ +(m01 * m12 - m02 * m11)\n    const a10 = /* c01 = */ -(m10 * m22 - m12 * m20)\n    const a11 = /* c11 = */ +(m00 * m22 - m02 * m20)\n    const a12 = /* c21 = */ -(m00 * m12 - m02 * m10)\n\n    return new AffineTransform(a00, a01, a02, a10, a11, a12)\n  }\n\n  inverted(): AffineTransform | null {\n    const det = this.det()\n    if (det === 0) return null\n    const adj = this.adj()\n    return adj.timesScalar(1 / det)\n  }\n\n  transformVector(v: Vec2) {\n    return new Vec2(v.x * this.m00 + v.y * this.m01, v.x * this.m10 + v.y * this.m11)\n  }\n\n  inverseTransformVector(v: Vec2): Vec2 | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformVector(v)\n  }\n\n  transformPosition(v: Vec2) {\n    return new Vec2(\n      v.x * this.m00 + v.y * this.m01 + this.m02,\n      v.x * this.m10 + v.y * this.m11 + this.m12,\n    )\n  }\n\n  inverseTransformPosition(v: Vec2): Vec2 | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformPosition(v)\n  }\n\n  transformRect(r: Rect) {\n    const size = this.transformVector(r.size)\n    const origin = this.transformPosition(r.origin)\n\n    if (size.x < 0 && size.y < 0) {\n      return new Rect(origin.plus(size), size.abs())\n    } else if (size.x < 0) {\n      return new Rect(origin.withX(origin.x + size.x), size.abs())\n    } else if (size.y < 0) {\n      return new Rect(origin.withY(origin.y + size.y), size.abs())\n    }\n\n    return new Rect(origin, size)\n  }\n\n  inverseTransformRect(r: Rect): Rect | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformRect(r)\n  }\n\n  flatten(): [number, number, number, number, number, number, number, number, number] {\n    // Flatten into GLSL format\n    // prettier-ignore\n    return [\n      this.m00, this.m10, 0,\n      this.m01, this.m11, 0,\n      this.m02, this.m12, 1,\n    ]\n  }\n}\n\nexport class Rect {\n  constructor(readonly origin: Vec2, readonly size: Vec2) {}\n\n  isEmpty() {\n    return this.width() == 0 || this.height() == 0\n  }\n\n  width() {\n    return this.size.x\n  }\n  height() {\n    return this.size.y\n  }\n\n  left() {\n    return this.origin.x\n  }\n  right() {\n    return this.left() + this.width()\n  }\n  top() {\n    return this.origin.y\n  }\n  bottom() {\n    return this.top() + this.height()\n  }\n\n  topLeft() {\n    return this.origin\n  }\n  topRight() {\n    return this.origin.plus(new Vec2(this.width(), 0))\n  }\n\n  bottomRight() {\n    return this.origin.plus(this.size)\n  }\n  bottomLeft() {\n    return this.origin.plus(new Vec2(0, this.height()))\n  }\n\n  withOrigin(origin: Vec2) {\n    return new Rect(origin, this.size)\n  }\n  withSize(size: Vec2) {\n    return new Rect(this.origin, size)\n  }\n\n  closestPointTo(p: Vec2) {\n    return new Vec2(clamp(p.x, this.left(), this.right()), clamp(p.y, this.top(), this.bottom()))\n  }\n\n  distanceFrom(p: Vec2) {\n    return p.minus(this.closestPointTo(p)).length()\n  }\n\n  contains(p: Vec2) {\n    return this.distanceFrom(p) === 0\n  }\n\n  hasIntersectionWith(other: Rect) {\n    const top = Math.max(this.top(), other.top())\n    const bottom = Math.max(top, Math.min(this.bottom(), other.bottom()))\n    if (bottom - top === 0) return false\n\n    const left = Math.max(this.left(), other.left())\n    const right = Math.max(left, Math.min(this.right(), other.right()))\n    if (right - left === 0) return false\n    return true\n  }\n\n  intersectWith(other: Rect): Rect {\n    const topLeft = Vec2.max(this.topLeft(), other.topLeft())\n    const bottomRight = Vec2.max(topLeft, Vec2.min(this.bottomRight(), other.bottomRight()))\n\n    return new Rect(topLeft, bottomRight.minus(topLeft))\n  }\n\n  equals(other: Rect) {\n    return this.origin.equals(other.origin) && this.size.equals(other.size)\n  }\n\n  approxEquals(other: Rect) {\n    return this.origin.approxEquals(other.origin) && this.size.approxEquals(other.size)\n  }\n\n  area() {\n    return this.size.x * this.size.y\n  }\n\n  static empty = new Rect(Vec2.zero, Vec2.zero)\n  static unit = new Rect(Vec2.zero, Vec2.unit)\n  static NDC = new Rect(new Vec2(-1, -1), new Vec2(2, 2))\n}\n","// This is a port of the GPU APIs from https://github.com/evanw/sky from Skew to\n// TypeScript.\n//\n// The MIT License (MIT)\n// Original work Copyright (c) 2016 Evan Wallace\n// Modified work Copyright (c) 2018 Jamie Wong\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\n// NOTE: This file intentionally has no dependencies.\n\n// Dependencies & polyfills for import from skew\nconst RELEASE = process.env.NODE_ENV === 'production'\n\nfunction assert(condition: boolean) {\n  if (!RELEASE) {\n    if (!condition) throw new Error('Assertion failed.')\n  }\n}\n\nfunction appendOne<T>(ts: T[], t: T): void {\n  if (ts.indexOf(t) === -1) ts.push(t)\n}\n\nfunction removeOne<T>(ts: T[], t: T): void {\n  const index = ts.indexOf(t)\n  if (index !== -1) ts.splice(index, 1)\n}\n\nfunction TEXTURE_N(gl: WebGLRenderingContext, index: number) {\n  assert(index >= 0 && index <= 31)\n  return (gl.TEXTURE0 + index) as GLenum\n}\n\nexport namespace Graphics {\n  export class Rect {\n    constructor(\n      public x: number = 0,\n      public y: number = 0,\n      public width: number = 0,\n      public height: number = 0,\n    ) {}\n\n    set(x: number, y: number, width: number, height: number) {\n      this.x = x\n      this.y = y\n      this.width = width\n      this.height = height\n    }\n\n    equals(other: Rect) {\n      return (\n        this.x === other.x &&\n        this.y === other.y &&\n        this.width === other.width &&\n        this.height === other.height\n      )\n    }\n  }\n\n  export class Color {\n    constructor(\n      public redF: number,\n      public greenF: number,\n      public blueF: number,\n      public alphaF: number,\n    ) {}\n\n    equals(other: Color): boolean {\n      return (\n        this.redF === other.redF &&\n        this.greenF === other.greenF &&\n        this.blueF === other.blueF &&\n        this.alphaF === other.alphaF\n      )\n    }\n\n    static TRANSPARENT = new Color(0, 0, 0, 0)\n  }\n\n  // Converted from https://github.com/evanw/sky/blob/c72de77/src/graphics/context.sk\n  export enum BlendOperation {\n    ZERO = 0,\n    ONE = 1,\n\n    SOURCE_COLOR = 2,\n    TARGET_COLOR = 3,\n    INVERSE_SOURCE_COLOR = 4,\n    INVERSE_TARGET_COLOR = 5,\n\n    SOURCE_ALPHA = 6,\n    TARGET_ALPHA = 7,\n    INVERSE_SOURCE_ALPHA = 8,\n    INVERSE_TARGET_ALPHA = 9,\n\n    CONSTANT = 10,\n    INVERSE_CONSTANT = 11,\n  }\n\n  export enum Primitive {\n    TRIANGLES,\n    TRIANGLE_STRIP,\n  }\n\n  export abstract class Context {\n    abstract addContextResetHandler(callback: () => void): void\n    abstract beginFrame(): void\n    abstract clear(color: Color): void\n\n    abstract createMaterial(\n      format: VertexFormat,\n      vertexSource: string,\n      fragmentSource: string,\n    ): Material\n    abstract createTexture(\n      format: TextureFormat,\n      width: number,\n      height: number,\n      pixels?: Uint8Array,\n    ): Texture\n    abstract createRenderTarget(texture: Texture): RenderTarget\n    abstract createVertexBuffer(byteCount: number): VertexBuffer\n    abstract currentRenderTarget: RenderTarget | null\n    abstract draw(primitive: Primitive, material: Material, vertices: VertexBuffer): void\n    abstract endFrame(): void\n    abstract removeContextResetHandler(callback: () => void): void\n    abstract resize(\n      widthInPixels: number,\n      heightInPixels: number,\n      widthInAppUnits: number,\n      heightInAppUnits: number,\n    ): void\n    abstract setRenderTarget(renderTarget: RenderTarget | null): void\n    abstract setViewport(x: number, y: number, width: number, height: number): void\n    abstract viewport: Rect\n    abstract widthInPixels: number\n    abstract heightInPixels: number\n\n    abstract renderTargetHeightInPixels: number\n    abstract renderTargetWidthInPixels: number\n\n    abstract setBlendState(source: BlendOperation, target: BlendOperation): void\n    setCopyBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.ZERO)\n    }\n    setAddBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.ONE)\n    }\n    setPremultipliedBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.INVERSE_SOURCE_ALPHA)\n    }\n    setUnpremultipliedBlendState() {\n      this.setBlendState(BlendOperation.SOURCE_ALPHA, BlendOperation.INVERSE_SOURCE_ALPHA)\n    }\n\n    protected resizeEventHandlers = new Set<() => void>()\n    addAfterResizeEventHandler(callback: () => void): void {\n      this.resizeEventHandlers.add(callback)\n    }\n    removeAfterResizeEventHandler(callback: () => void): void {\n      this.resizeEventHandlers.delete(callback)\n    }\n  }\n\n  export interface Material {\n    context: Context\n    format: VertexFormat\n    fragmentSource: string\n    vertexSource: string\n    setUniformFloat(name: string, x: number): void\n    setUniformInt(name: string, x: number): void\n    setUniformVec2(name: string, x: number, y: number): void\n    setUniformVec3(name: string, x: number, y: number, z: number): void\n    setUniformVec4(name: string, x: number, y: number, z: number, w: number): void\n    setUniformMat3(\n      name: string,\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ): void\n    setUniformSampler(name: string, texture: Texture, index: number): void\n  }\n\n  export enum AttributeType {\n    FLOAT,\n    BYTE,\n  }\n\n  export function attributeByteLength(type: AttributeType) {\n    return type == AttributeType.FLOAT ? 4 : 1\n  }\n\n  export class Attribute {\n    constructor(\n      readonly name: string,\n      readonly type: AttributeType,\n      readonly count: number,\n      readonly byteOffset: number,\n    ) {}\n  }\n\n  export class VertexFormat {\n    private _attributes: Attribute[] = []\n    private _stride = 0\n\n    get attributes() {\n      return this._attributes\n    }\n    get stride() {\n      return this._stride\n    }\n\n    add(name: string, type: AttributeType, count: number): VertexFormat {\n      this.attributes.push(new Attribute(name, type, count, this.stride))\n      this._stride += count * attributeByteLength(type)\n      return this\n    }\n  }\n\n  export abstract class VertexBuffer {\n    abstract byteCount: number\n    abstract context: Context\n    abstract move(sourceByteOffset: number, targetByteOffset: number, byteCount: number): void\n    abstract upload(bytes: Uint8Array, byteOffset?: number): void\n    uploadFloat32Array(floats: Float32Array) {\n      this.upload(new Uint8Array(floats.buffer), 0)\n    }\n    uploadFloats(floats: number[]) {\n      this.uploadFloat32Array(new Float32Array(floats))\n    }\n    abstract free(): void\n  }\n\n  export enum PixelFilter {\n    NEAREST,\n    LINEAR,\n  }\n\n  export enum PixelWrap {\n    REPEAT,\n    CLAMP,\n  }\n\n  export class TextureFormat {\n    constructor(\n      readonly minFilter: PixelFilter,\n      readonly magFilter: PixelFilter,\n      readonly wrap: PixelWrap,\n    ) {}\n\n    static LINEAR_CLAMP = new TextureFormat(PixelFilter.LINEAR, PixelFilter.LINEAR, PixelWrap.CLAMP)\n    static LINEAR_MIN_NEAREST_MAG_CLAMP = new TextureFormat(\n      PixelFilter.LINEAR,\n      PixelFilter.NEAREST,\n      PixelWrap.CLAMP,\n    )\n    static NEAREST_CLAMP = new TextureFormat(\n      PixelFilter.NEAREST,\n      PixelFilter.NEAREST,\n      PixelWrap.CLAMP,\n    )\n  }\n\n  export interface Texture {\n    context: Context\n    format: TextureFormat\n    width: number\n    height: number\n    resize(width: number, height: number, pixels?: Uint8Array): void\n    setFormat(format: TextureFormat): void\n    free(): void\n  }\n\n  export interface RenderTarget {\n    context: Context\n    texture: Texture\n    setColor(texture: Texture): void\n    free(): void\n  }\n}\n\n// Converted from https://github.com/evanw/sky/blob/c72de77/src/browser/context.sk\nexport namespace WebGL {\n  export class Context extends Graphics.Context {\n    private _attributeCount = 0\n    private _blendOperationMap: {[key: number]: GLenum}\n    private _blendOperations = 0\n    private _contextResetHandlers: (() => void)[] = []\n    private _currentClearColor = Graphics.Color.TRANSPARENT\n    private _currentRenderTarget: RenderTarget | null = null\n    private _defaultViewport = new Graphics.Rect()\n    private _forceStateUpdate = true\n    private _generation = 1\n    private _gl: WebGLRenderingContext\n    private _height = 0\n    private _oldBlendOperations = 0\n    private _oldRenderTarget: RenderTarget | null = null\n    private _oldViewport = new Graphics.Rect()\n    private _width = 0\n\n    get widthInPixels() {\n      return this._width\n    }\n    get heightInPixels() {\n      return this._height\n    }\n\n    constructor(canvas: HTMLCanvasElement = document.createElement('canvas')) {\n      super()\n      let gl = canvas.getContext('webgl', {\n        alpha: false,\n        antialias: false,\n        depth: false,\n        preserveDrawingBuffer: false,\n        stencil: false,\n      })\n\n      if (gl == null) {\n        throw new Error('Setup failure')\n      }\n\n      this._gl = gl\n      let style = canvas.style\n      canvas.width = 0\n      canvas.height = 0\n      style.width = style.height = '0'\n\n      canvas.addEventListener('webglcontextlost', (e: Event) => {\n        e.preventDefault()\n      })\n\n      canvas.addEventListener('webglcontextrestored', this.handleWebglContextRestored)\n\n      // Using maps makes these compact in release\n      this._blendOperationMap = {\n        [Graphics.BlendOperation.ZERO]: this._gl.ZERO,\n        [Graphics.BlendOperation.ONE]: this._gl.ONE,\n\n        [Graphics.BlendOperation.SOURCE_COLOR]: this._gl.SRC_COLOR,\n        [Graphics.BlendOperation.TARGET_COLOR]: this._gl.DST_COLOR,\n        [Graphics.BlendOperation.INVERSE_SOURCE_COLOR]: this._gl.ONE_MINUS_SRC_COLOR,\n        [Graphics.BlendOperation.INVERSE_TARGET_COLOR]: this._gl.ONE_MINUS_DST_COLOR,\n\n        [Graphics.BlendOperation.SOURCE_ALPHA]: this._gl.SRC_ALPHA,\n        [Graphics.BlendOperation.TARGET_ALPHA]: this._gl.DST_ALPHA,\n        [Graphics.BlendOperation.INVERSE_SOURCE_ALPHA]: this._gl.ONE_MINUS_SRC_ALPHA,\n        [Graphics.BlendOperation.INVERSE_TARGET_ALPHA]: this._gl.ONE_MINUS_DST_ALPHA,\n\n        [Graphics.BlendOperation.CONSTANT]: this._gl.CONSTANT_COLOR,\n        [Graphics.BlendOperation.INVERSE_CONSTANT]: this._gl.ONE_MINUS_CONSTANT_COLOR,\n      }\n    }\n\n    private handleWebglContextRestored = () => {\n      this._attributeCount = 0\n      this._currentClearColor = Graphics.Color.TRANSPARENT\n      this._forceStateUpdate = true\n      this._generation++\n      for (let handler of this._contextResetHandlers) {\n        handler()\n      }\n    }\n\n    public testContextLoss() {\n      this.handleWebglContextRestored()\n    }\n\n    get gl() {\n      return this._gl\n    }\n    get generation() {\n      return this._generation\n    }\n    addContextResetHandler(callback: () => void) {\n      appendOne(this._contextResetHandlers, callback)\n    }\n    removeContextResetHandler(callback: () => void) {\n      removeOne(this._contextResetHandlers, callback)\n    }\n\n    get currentRenderTarget() {\n      return this._currentRenderTarget\n    }\n\n    beginFrame() {\n      this.setRenderTarget(null)\n    }\n\n    endFrame() {}\n\n    setBlendState(source: Graphics.BlendOperation, target: Graphics.BlendOperation) {\n      this._blendOperations = Context._packBlendModes(source, target)\n    }\n\n    setViewport(x: number, y: number, width: number, height: number) {\n      ;(this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport\n        : this._defaultViewport\n      ).set(x, y, width, height)\n    }\n\n    get viewport() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport\n        : this._defaultViewport\n    }\n\n    get renderTargetWidthInPixels() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport.width\n        : this._width\n    }\n\n    get renderTargetHeightInPixels() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport.height\n        : this._height\n    }\n\n    draw(\n      primitive: Graphics.Primitive,\n      material: Graphics.Material,\n      vertices: Graphics.VertexBuffer,\n    ) {\n      // Update the texture set before preparing the material so uniform samplers can check for that they use different textures\n      this._updateRenderTargetAndViewport()\n      Material.from(material).prepare()\n\n      // Update the vertex buffer before updating the format so attributes can bind correctly\n      VertexBuffer.from(vertices).prepare()\n      this._updateFormat(material.format)\n\n      // Draw now that everything is ready\n      this._updateBlendState()\n\n      this._gl.drawArrays(\n        primitive == Graphics.Primitive.TRIANGLES ? this._gl.TRIANGLES : this._gl.TRIANGLE_STRIP,\n        0,\n        Math.floor(vertices.byteCount / material.format.stride),\n      )\n\n      // Forced state updates are done once after a context loss\n      this._forceStateUpdate = false\n    }\n\n    resize(\n      widthInPixels: number,\n      heightInPixels: number,\n      widthInAppUnits: number,\n      heightInAppUnits: number,\n    ) {\n      let canvas = this._gl.canvas as HTMLCanvasElement\n      const bounds = canvas.getBoundingClientRect()\n\n      if (\n        this._width === widthInPixels &&\n        this._height === heightInPixels &&\n        bounds.width === widthInAppUnits &&\n        bounds.height === heightInAppUnits\n      ) {\n        // Nothing to do here!\n        return\n      }\n\n      let style = canvas.style\n      canvas.width = widthInPixels\n      canvas.height = heightInPixels\n      style.width = `${widthInAppUnits}px`\n      style.height = `${heightInAppUnits}px`\n      this.setViewport(0, 0, widthInPixels, heightInPixels)\n      this._width = widthInPixels\n      this._height = heightInPixels\n\n      this.resizeEventHandlers.forEach(cb => cb())\n    }\n\n    clear(color: Graphics.Color) {\n      this._updateRenderTargetAndViewport()\n      this._updateBlendState()\n\n      if (!color.equals(this._currentClearColor)) {\n        this._gl.clearColor(color.redF, color.greenF, color.blueF, color.alphaF)\n        this._currentClearColor = color\n      }\n\n      this._gl.clear(this._gl.COLOR_BUFFER_BIT)\n    }\n\n    setRenderTarget(renderTarget: Graphics.RenderTarget | null) {\n      this._currentRenderTarget = RenderTarget.from(renderTarget)\n    }\n\n    createMaterial(\n      format: Graphics.VertexFormat,\n      vertexSource: string,\n      fragmentSource: string,\n    ): Graphics.Material {\n      let material = new Material(this, format, vertexSource, fragmentSource)\n\n      // Compiling shaders is really expensive so we want to get that started\n      // as early as possible. In Chrome and possibly other browsers, shader\n      // compilation can happen asynchronously as long as you don't call\n      // useProgram().\n      //\n      //   https://plus.google.com/+BrandonJonesToji/posts/4ERHkicC5Ny\n      //\n      material.program\n\n      return material\n    }\n\n    createVertexBuffer(byteCount: number): Graphics.VertexBuffer {\n      assert(byteCount > 0 && byteCount % 4 == 0)\n      return new VertexBuffer(this, byteCount)\n    }\n\n    createTexture(\n      format: Graphics.TextureFormat,\n      width: number,\n      height: number,\n      pixels?: Uint8Array,\n    ): Graphics.Texture {\n      return new Texture(this, format, width, height, pixels)\n    }\n\n    createRenderTarget(texture: Graphics.Texture): Graphics.RenderTarget {\n      return new RenderTarget(this, Texture.from(texture))\n    }\n\n    private ANGLE_instanced_arrays: ANGLE_instanced_arrays | null = null\n    private ANGLE_instanced_arrays_generation: number = -1\n    getANGLE_instanced_arrays(): ANGLE_instanced_arrays {\n      if (this.ANGLE_instanced_arrays_generation !== this._generation) {\n        this.ANGLE_instanced_arrays = null\n      }\n      if (!this.ANGLE_instanced_arrays) {\n        this.ANGLE_instanced_arrays = this.gl.getExtension('ANGLE_instanced_arrays')\n        if (!this.ANGLE_instanced_arrays) {\n          throw new Error('Failed to get extension ANGLE_instanced_arrays')\n        }\n      }\n      return this.ANGLE_instanced_arrays!\n    }\n\n    _updateRenderTargetAndViewport() {\n      let renderTarget = this._currentRenderTarget\n      let viewport = renderTarget != null ? renderTarget.viewport : this._defaultViewport\n      let gl = this._gl\n\n      if (this._forceStateUpdate || this._oldRenderTarget != renderTarget) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, renderTarget ? renderTarget.framebuffer : null)\n        this._oldRenderTarget = renderTarget\n      }\n\n      if (this._forceStateUpdate || !this._oldViewport.equals(viewport)) {\n        gl.viewport(\n          viewport.x,\n          this.renderTargetHeightInPixels - viewport.y - viewport.height,\n          viewport.width,\n          viewport.height,\n        )\n        this._oldViewport.set(viewport.x, viewport.y, viewport.width, viewport.height)\n      }\n    }\n\n    _updateBlendState() {\n      if (this._forceStateUpdate || this._oldBlendOperations != this._blendOperations) {\n        let gl = this._gl\n        let operations = this._blendOperations\n        let oldOperations = this._oldBlendOperations\n        let source = (operations & 0xf) as Graphics.BlendOperation\n        let target = (operations >> 4) as Graphics.BlendOperation\n\n        assert(source in this._blendOperationMap)\n        assert(target in this._blendOperationMap)\n\n        // Special-case the blend mode that just writes over the target buffer\n        if (operations == Context.COPY_BLEND_OPERATIONS) {\n          gl.disable(gl.BLEND)\n        } else {\n          if (this._forceStateUpdate || oldOperations == Context.COPY_BLEND_OPERATIONS) {\n            gl.enable(gl.BLEND)\n          }\n\n          // Otherwise, use actual blending\n          gl.blendFunc(this._blendOperationMap[source], this._blendOperationMap[target])\n        }\n\n        this._oldBlendOperations = operations\n      }\n    }\n\n    _updateFormat(format: Graphics.VertexFormat) {\n      // Update the attributes\n      let gl = this._gl\n      let attributes = format.attributes\n      let count = attributes.length\n      for (let i = 0; i < count; i++) {\n        let attribute = attributes[i]\n        let isByte = attribute.type == Graphics.AttributeType.BYTE\n        gl.vertexAttribPointer(\n          i,\n          attribute.count,\n          isByte ? gl.UNSIGNED_BYTE : gl.FLOAT,\n          isByte,\n          format.stride,\n          attribute.byteOffset,\n        )\n      }\n\n      // Update the attribute count\n      while (this._attributeCount < count) {\n        gl.enableVertexAttribArray(this._attributeCount)\n        this._attributeCount++\n      }\n      while (this._attributeCount > count) {\n        this._attributeCount--\n        gl.disableVertexAttribArray(this._attributeCount)\n      }\n      this._attributeCount = count\n    }\n\n    getWebGLInfo(): {renderer: string | null; vendor: string | null; version: string | null} {\n      const ext = this.gl.getExtension('WEBGL_debug_renderer_info')\n      const renderer = ext ? this.gl.getParameter(ext.UNMASKED_RENDERER_WEBGL) : null\n      const vendor = ext ? this.gl.getParameter(ext.UNMASKED_VENDOR_WEBGL) : null\n      const version = this.gl.getParameter(this.gl.VERSION)\n      return {renderer, vendor, version}\n    }\n\n    static from(context: Graphics.Context): Context {\n      assert(context == null || context instanceof Context)\n      return context as Context\n    }\n\n    static _packBlendModes(\n      source: Graphics.BlendOperation,\n      target: Graphics.BlendOperation,\n    ): number {\n      return source | (target << 4)\n    }\n\n    static COPY_BLEND_OPERATIONS = Context._packBlendModes(\n      Graphics.BlendOperation.ONE,\n      Graphics.BlendOperation.ZERO,\n    )\n  }\n\n  abstract class Uniform {\n    constructor(\n      protected readonly _material: Material,\n      protected readonly _name: string,\n      protected _generation = 0,\n      protected _location: WebGLUniformLocation | null = null,\n      protected _isDirty = true,\n    ) {}\n\n    // Upload this uniform if it's dirty\n    abstract prepare(): void\n\n    get location(): WebGLUniformLocation {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation) {\n        this._location = context.gl.getUniformLocation(this._material.program, this._name)\n        this._generation = context.generation\n\n        // Validate the shader against this uniform\n        if (!RELEASE) {\n          let program = this._material.program\n          let gl = context.gl\n          for (let i = 0, ii = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS); i < ii; i++) {\n            let info = gl.getActiveUniform(program, i)\n            if (info && info.name == this._name) {\n              assert(info.size == 1)\n              switch (info.type) {\n                case gl.FLOAT: {\n                  assert(this instanceof UniformFloat)\n                  break\n                }\n                case gl.FLOAT_MAT3: {\n                  assert(this instanceof UniformMat3)\n                  break\n                }\n                case gl.FLOAT_VEC2: {\n                  assert(this instanceof UniformVec2)\n                  break\n                }\n                case gl.FLOAT_VEC3: {\n                  assert(this instanceof UniformVec3)\n                  break\n                }\n                case gl.FLOAT_VEC4: {\n                  assert(this instanceof UniformVec4)\n                  break\n                }\n                case gl.INT: {\n                  assert(this instanceof UniformInt)\n                  break\n                }\n                case gl.SAMPLER_2D: {\n                  assert(this instanceof UniformSampler)\n                  break\n                }\n                default:\n                  assert(false)\n              }\n            }\n          }\n        }\n      }\n      if (!this._location) {\n        throw new Error('Failed to get uniform location')\n      }\n      return this._location\n    }\n  }\n\n  class UniformFloat extends Uniform {\n    private _x = 0.0\n\n    set(x: number) {\n      if (x != this._x) {\n        this._x = x\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform1f(this.location, this._x)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformInt extends Uniform {\n    private _x = 0\n\n    set(x: number) {\n      if (x != this._x) {\n        this._x = x\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform1i(this.location, this._x)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec2 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n\n    set(x: number, y: number) {\n      if (x != this._x || y != this._y) {\n        this._x = x\n        this._y = y\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform2f(this.location, this._x, this._y)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec3 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n    private _z = 0.0\n\n    set(x: number, y: number, z: number) {\n      if (x != this._x || y != this._y || z != this._z) {\n        this._x = x\n        this._y = y\n        this._z = z\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform3f(this.location, this._x, this._y, this._z)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec4 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n    private _z = 0.0\n    private _w = 0.0\n\n    set(x: number, y: number, z: number, w: number) {\n      if (x != this._x || y != this._y || z != this._z || w != this._w) {\n        this._x = x\n        this._y = y\n        this._z = z\n        this._w = w\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform4f(this.location, this._x, this._y, this._z, this._w)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformMat3 extends Uniform {\n    private _values = [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]\n\n    set(\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ) {\n      // These values are deliberately transposed because WebGL requires the \"transpose\" argument of uniformMatrix() to be false\n      UniformMat3._cachedValues[0] = m00\n      UniformMat3._cachedValues[1] = m10\n      UniformMat3._cachedValues[2] = m20\n      UniformMat3._cachedValues[3] = m01\n      UniformMat3._cachedValues[4] = m11\n      UniformMat3._cachedValues[5] = m21\n      UniformMat3._cachedValues[6] = m02\n      UniformMat3._cachedValues[7] = m12\n      UniformMat3._cachedValues[8] = m22\n\n      for (let i = 0; i < 9; i++) {\n        if (UniformMat3._cachedValues[i] != this._values[i]) {\n          let swap = this._values\n          this._values = UniformMat3._cachedValues\n          UniformMat3._cachedValues = swap\n          this._isDirty = true\n          break\n        }\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniformMatrix3fv(this.location, false, this._values)\n        this._isDirty = false\n      }\n    }\n\n    // Statically allocate this to avoid allocations\n    static _cachedValues = [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]\n  }\n\n  class UniformSampler extends Uniform {\n    private _texture: Texture | null = null\n    private _index = -1\n\n    set(texture: Graphics.Texture, index: number) {\n      if (this._texture != texture || this._index != index) {\n        this._texture = Texture.from(texture)\n        this._index = index\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      let gl = context.gl\n      assert(\n        this._texture == null ||\n          context.currentRenderTarget == null ||\n          this._texture != context.currentRenderTarget.texture,\n      )\n      if (this._generation != context.generation || this._isDirty) {\n        gl.uniform1i(this.location, this._index)\n        this._isDirty = false\n      }\n      gl.activeTexture(TEXTURE_N(gl, this._index))\n      gl.bindTexture(\n        gl.TEXTURE_2D,\n        this._texture != null && this._texture.width > 0 && this._texture.height > 0\n          ? this._texture.texture\n          : null,\n      )\n    }\n  }\n\n  class Material implements Graphics.Material {\n    constructor(\n      private readonly _context: Context,\n      private readonly _format: Graphics.VertexFormat,\n      private readonly _vertexSource: string,\n      private readonly _fragmentSource: string,\n      private readonly _uniformsMap: {[key: string]: Uniform} = {},\n      private readonly _uniformsList: Uniform[] = [],\n      private _generation = 0,\n      private _program: WebGLProgram | null = null,\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get format() {\n      return this._format\n    }\n    get vertexSource() {\n      return this._vertexSource\n    }\n    get fragmentSource() {\n      return this._fragmentSource\n    }\n\n    setUniformFloat(name: string, x: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformFloat(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformFloat)\n      ;(uniform as UniformFloat).set(x)\n    }\n\n    setUniformInt(name: string, x: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformInt(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformInt)\n      ;(uniform as UniformInt).set(x)\n    }\n\n    setUniformVec2(name: string, x: number, y: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec2(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec2)\n      ;(uniform as UniformVec2).set(x, y)\n    }\n\n    setUniformVec3(name: string, x: number, y: number, z: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec3(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec3)\n      ;(uniform as UniformVec3).set(x, y, z)\n    }\n\n    setUniformVec4(name: string, x: number, y: number, z: number, w: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec4(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec4)\n      ;(uniform as UniformVec4).set(x, y, z, w)\n    }\n\n    setUniformMat3(\n      name: string,\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformMat3(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformMat3)\n      ;(uniform as UniformMat3).set(m00, m01, m02, m10, m11, m12, m20, m21, m22)\n    }\n\n    setUniformSampler(name: string, texture: Graphics.Texture, index: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformSampler(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformSampler)\n      ;(uniform as UniformSampler).set(texture, index)\n    }\n\n    get program(): WebGLProgram {\n      let gl = this._context.gl\n      if (this._generation != this._context.generation) {\n        this._program = gl.createProgram()!\n        this._compileShader(gl, gl.VERTEX_SHADER, this.vertexSource)\n        this._compileShader(gl, gl.FRAGMENT_SHADER, this.fragmentSource)\n        let attributes = this.format.attributes\n        for (let i = 0; i < attributes.length; i++) {\n          gl.bindAttribLocation(this._program, i, attributes[i].name)\n        }\n        gl.linkProgram(this._program)\n        if (!gl.getProgramParameter(this._program, gl.LINK_STATUS)) {\n          throw new Error(`${gl.getProgramInfoLog(this._program)}`)\n        }\n        this._generation = this._context.generation\n\n        // Validate this shader against the format\n        if (!RELEASE) {\n          for (let attribute of attributes) {\n            for (\n              let i = 0, ii = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\n              i < ii;\n              i++\n            ) {\n              let info = gl.getActiveAttrib(this.program, i)\n              if (info && info.name == attribute.name) {\n                assert(info.size == 1)\n                switch (attribute.count) {\n                  case 1: {\n                    assert(info.type == gl.FLOAT)\n                    break\n                  }\n                  case 2: {\n                    assert(info.type == gl.FLOAT_VEC2)\n                    break\n                  }\n                  case 3: {\n                    assert(info.type == gl.FLOAT_VEC3)\n                    break\n                  }\n                  case 4: {\n                    assert(info.type == gl.FLOAT_VEC4)\n                    break\n                  }\n                  default: {\n                    assert(false)\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      return this._program!\n    }\n\n    prepare(): void {\n      this._context.gl.useProgram(this.program)\n      for (let uniform of this._uniformsList) {\n        uniform.prepare()\n      }\n    }\n\n    _compileShader(gl: WebGLRenderingContext, type: GLenum, source: string) {\n      let shader = gl.createShader(type)\n      if (!shader) {\n        throw new Error('Failed to create shader')\n      }\n      gl.shaderSource(shader, source)\n      gl.compileShader(shader)\n      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        throw new Error(`${gl.getShaderInfoLog(shader)}`)\n      }\n      if (!this._program) {\n        throw new Error('Tried to attach shader before program was created')\n      }\n      gl.attachShader(this._program, shader)\n    }\n\n    static from(material: Graphics.Material): Material {\n      assert(material == null || material instanceof Material)\n      return material as Material\n    }\n  }\n\n  class VertexBuffer extends Graphics.VertexBuffer {\n    private readonly _context: Context\n    private _generation = 0\n    private _buffer: WebGLBuffer | null = null\n    private _bytes: Uint8Array | null = null\n    private _isDirty = true\n    private _dirtyMin = VertexBuffer.INT_MAX\n    private _dirtyMax = 0\n    private _totalMin = VertexBuffer.INT_MAX\n    private _totalMax = 0\n    private _byteCount = 0\n\n    constructor(context: Context, byteCount: number) {\n      super()\n      this._context = context\n      this._byteCount = byteCount\n      this._bytes = new Uint8Array(byteCount)\n    }\n\n    get context() {\n      return this._context\n    }\n    get byteCount() {\n      return this._byteCount\n    }\n\n    move(sourceByteOffset: number, targetByteOffset: number, byteCount: number) {\n      assert(byteCount >= 0)\n      assert(0 <= sourceByteOffset && sourceByteOffset + byteCount <= this._byteCount)\n      assert(0 <= targetByteOffset && targetByteOffset + byteCount <= this._byteCount)\n\n      if (this._bytes && sourceByteOffset != targetByteOffset && byteCount != 0) {\n        this._bytes.set(this._bytes.subarray(sourceByteOffset, this._byteCount), targetByteOffset)\n        this._growDirtyRegion(\n          Math.min(sourceByteOffset, targetByteOffset),\n          Math.max(sourceByteOffset, targetByteOffset) + byteCount,\n        )\n      }\n    }\n\n    upload(bytes: Uint8Array, byteOffset: number = 0) {\n      assert(0 <= byteOffset && byteOffset + bytes.length <= this._byteCount)\n      assert(this._bytes != null)\n      this._bytes!.set(bytes, byteOffset)\n      this._growDirtyRegion(byteOffset, byteOffset + bytes.length)\n    }\n\n    free() {\n      if (this._buffer) {\n        this._context.gl.deleteBuffer(this._buffer)\n      }\n\n      // Reset the generation to force this to be re-uploaded if it's used again\n      // in the future.\n      this._generation = 0\n    }\n\n    prepare(): void {\n      let gl = this._context.gl\n\n      if (this._generation !== this._context.generation) {\n        this._buffer = gl.createBuffer()\n        this._generation = this._context.generation\n        this._isDirty = true\n      }\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._buffer)\n\n      if (this._isDirty) {\n        gl.bufferData(gl.ARRAY_BUFFER, this._byteCount, gl.DYNAMIC_DRAW)\n        this._dirtyMin = this._totalMin\n        this._dirtyMax = this._totalMax\n        this._isDirty = false\n      }\n\n      if (this._dirtyMin < this._dirtyMax) {\n        gl.bufferSubData(\n          gl.ARRAY_BUFFER,\n          this._dirtyMin,\n          this._bytes!.subarray(this._dirtyMin, this._dirtyMax),\n        )\n        this._dirtyMin = VertexBuffer.INT_MAX\n        this._dirtyMax = 0\n      }\n    }\n\n    _growDirtyRegion(min: number, max: number) {\n      this._dirtyMin = Math.min(this._dirtyMin, min)\n      this._dirtyMax = Math.max(this._dirtyMax, max)\n      this._totalMin = Math.min(this._totalMin, min)\n      this._totalMax = Math.max(this._totalMax, max)\n    }\n\n    static INT_MAX = 0x7fffffff\n\n    static from(buffer: Graphics.VertexBuffer): VertexBuffer {\n      assert(buffer == null || buffer instanceof VertexBuffer)\n      return buffer as VertexBuffer\n    }\n  }\n\n  class Texture implements Graphics.Texture {\n    constructor(\n      private readonly _context: Context,\n      private _format: Graphics.TextureFormat,\n      private _width: number,\n      private _height: number,\n      private _pixels: Uint8Array | null = null,\n      private _texture: WebGLTexture | null = null,\n      private _generation = 0,\n      private _isFormatDirty = true,\n      private _isContentDirty = true,\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get format() {\n      return this._format\n    }\n    get width() {\n      return this._width\n    }\n    get height() {\n      return this._height\n    }\n\n    resize(width: number, height: number, pixels: Uint8Array | null = null) {\n      this._width = width\n      this._height = height\n      this._pixels = pixels\n      this._isContentDirty = true\n    }\n\n    setFormat(format: Graphics.TextureFormat) {\n      if (this._format != format) {\n        this._format = format\n        this._isFormatDirty = true\n      }\n    }\n\n    get texture(): WebGLTexture {\n      let gl = this._context.gl\n\n      // Create\n      if (this._generation != this._context.generation) {\n        this._texture = gl.createTexture()\n        this._generation = this._context.generation\n        this._isFormatDirty = true\n        this._isContentDirty = true\n      }\n\n      // Format\n      if (this._isFormatDirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this._texture)\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_MAG_FILTER,\n          this.format.magFilter == Graphics.PixelFilter.NEAREST ? gl.NEAREST : gl.LINEAR,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_MIN_FILTER,\n          this.format.minFilter == Graphics.PixelFilter.NEAREST ? gl.NEAREST : gl.LINEAR,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_WRAP_S,\n          this.format.wrap == Graphics.PixelWrap.REPEAT ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_WRAP_T,\n          this.format.wrap == Graphics.PixelWrap.REPEAT ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n        )\n        this._isFormatDirty = false\n      }\n\n      if (this._isContentDirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this._texture)\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          this._width,\n          this._height,\n          0,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          this._pixels,\n        )\n        this._isContentDirty = false\n      }\n\n      return this._texture!\n    }\n\n    free() {\n      if (this.texture) {\n        this._context.gl.deleteTexture(this.texture)\n        this._generation = 0\n      }\n    }\n\n    static from(texture: Graphics.Texture): Texture {\n      assert(texture == null || texture instanceof Texture)\n      return texture as Texture\n    }\n  }\n\n  class RenderTarget implements Graphics.RenderTarget {\n    constructor(\n      private _context: Context,\n      private _texture: Texture,\n      private _framebuffer: WebGLFramebuffer | null = null,\n      private _generation = 0,\n      private _isDirty = true,\n      private _viewport = new Graphics.Rect(),\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get texture() {\n      return this._texture\n    }\n    get viewport() {\n      return this._viewport\n    }\n    setColor(texture: Graphics.Texture) {\n      if (this._texture != texture) {\n        this._texture = Texture.from(texture)\n        this._isDirty = true\n      }\n    }\n\n    get framebuffer(): WebGLFramebuffer {\n      let gl = this._context.gl\n      let texture = this._texture.texture\n\n      // Create\n      if (this._generation != this._context.generation) {\n        this._framebuffer = gl.createFramebuffer()\n        this._generation = this._context.generation\n        this._isDirty = true\n      }\n\n      // Update\n      if (this._isDirty) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer)\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0)\n        assert(gl.checkFramebufferStatus(gl.FRAMEBUFFER) == gl.FRAMEBUFFER_COMPLETE)\n        this._isDirty = false\n      }\n\n      return this._framebuffer!\n    }\n\n    free() {\n      if (this._framebuffer) {\n        this._context.gl.deleteFramebuffer(this._framebuffer)\n        this._generation = 0\n      }\n    }\n\n    static from(renderTarget: Graphics.RenderTarget | null): RenderTarget | null {\n      assert(renderTarget == null || renderTarget instanceof RenderTarget)\n      return renderTarget as RenderTarget | null\n    }\n  }\n}\n","import {Graphics} from './graphics'\nimport {AffineTransform, Vec2} from '../lib/math'\n\nexport function setUniformAffineTransform(\n  material: Graphics.Material,\n  name: string,\n  transform: AffineTransform,\n) {\n  let {m00, m01, m02, m10, m11, m12} = transform\n  material.setUniformMat3(name, m00, m01, m02, m10, m11, m12, 0, 0, 1)\n}\nexport function setUniformVec2(material: Graphics.Material, name: string, vec: Vec2) {\n  material.setUniformVec2(name, vec.x, vec.y)\n}\n\nexport function renderInto(gl: Graphics.Context, target: Graphics.RenderTarget, cb: () => void) {\n  gl.setRenderTarget(target)\n  gl.setViewport(0, 0, target.texture.width, target.texture.height)\n  cb()\n  gl.setRenderTarget(null)\n}\n","import {Rect, Vec2, AffineTransform} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('configSpacePos', Graphics.AttributeType.FLOAT, 2)\nvertexFormat.add('color', Graphics.AttributeType.FLOAT, 3)\n\nconst vert = `\n  uniform mat3 configSpaceToNDC;\n\n  attribute vec2 configSpacePos;\n  attribute vec3 color;\n  varying vec3 vColor;\n\n  void main() {\n    vColor = color;\n    vec2 position = (configSpaceToNDC * vec3(configSpacePos, 1)).xy;\n    gl_Position = vec4(position, 1, 1);\n  }\n`\n\nconst frag = `\n  precision mediump float;\n  varying vec3 vColor;\n\n  void main() {\n    gl_FragColor = vec4(vColor.rgb, 1);\n  }\n`\n\nexport class RectangleBatch {\n  private rects: Rect[] = []\n  private colors: Color[] = []\n  constructor(private gl: Graphics.Context) {}\n\n  getRectCount() {\n    return this.rects.length\n  }\n\n  private buffer: Graphics.VertexBuffer | null = null\n  getBuffer(): Graphics.VertexBuffer {\n    if (this.buffer) {\n      return this.buffer\n    }\n\n    const corners = [\n      [0, 0],\n      [1, 0],\n      [0, 1],\n      [1, 0],\n      [0, 1],\n      [1, 1],\n    ]\n\n    const bytes = new Uint8Array(vertexFormat.stride * corners.length * this.rects.length)\n    const floats = new Float32Array(bytes.buffer)\n    let idx = 0\n\n    for (let i = 0; i < this.rects.length; i++) {\n      const rect = this.rects[i]\n      const color = this.colors[i]\n\n      // TODO(jlfwong): In the conversion from regl to graphics.ts, I lost the\n      // ability to do instanced drawing. This is a pretty significant hit to\n      // the performance here since I need 6x the memory to allocate these\n      // things. Adding instanced drawing to graphics.ts is non-trivial, so I'm\n      // just going to try this for now.\n      for (let corner of corners) {\n        floats[idx++] = rect.origin.x + corner[0] * rect.size.x\n        floats[idx++] = rect.origin.y + corner[1] * rect.size.y\n\n        floats[idx++] = color.r\n        floats[idx++] = color.g\n        floats[idx++] = color.b\n      }\n    }\n\n    if (idx !== floats.length) {\n      throw new Error(\"Buffer expected to be full but wasn't\")\n    }\n\n    this.buffer = this.gl.createVertexBuffer(bytes.length)\n    this.buffer.upload(bytes)\n    return this.buffer\n  }\n\n  addRect(rect: Rect, color: Color) {\n    this.rects.push(rect)\n    this.colors.push(color)\n\n    if (this.buffer) {\n      this.buffer.free()\n      this.buffer = null\n    }\n  }\n\n  free() {\n    if (this.buffer) {\n      this.buffer.free()\n      this.buffer = null\n    }\n  }\n}\n\nexport interface RectangleBatchRendererProps {\n  batch: RectangleBatch\n  configSpaceSrcRect: Rect\n  physicalSpaceDstRect: Rect\n}\n\nexport class RectangleBatchRenderer {\n  material: Graphics.Material\n  constructor(private gl: Graphics.Context) {\n    this.material = gl.createMaterial(vertexFormat, vert, frag)\n  }\n\n  render(props: RectangleBatchRendererProps) {\n    setUniformAffineTransform(\n      this.material,\n      'configSpaceToNDC',\n      (() => {\n        const configToPhysical = AffineTransform.betweenRects(\n          props.configSpaceSrcRect,\n          props.physicalSpaceDstRect,\n        )\n\n        const viewportSize = new Vec2(this.gl.viewport.width, this.gl.viewport.height)\n\n        const physicalToNDC = AffineTransform.withTranslation(new Vec2(-1, 1)).times(\n          AffineTransform.withScale(new Vec2(2, -2).dividedByPointwise(viewportSize)),\n        )\n\n        return physicalToNDC.times(configToPhysical)\n      })(),\n    )\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLES, this.material, props.batch.getBuffer())\n  }\n}\n","import {clamp} from './math'\n\nexport class Color {\n  constructor(\n    readonly r: number = 0,\n    readonly g: number = 0,\n    readonly b: number = 0,\n    readonly a: number = 1,\n  ) {}\n\n  static fromLumaChromaHue(L: number, C: number, H: number) {\n    // 0 <= L <= 1\n    // 0 <= C <= 1\n    // 0 <= H <= 360\n    // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue\n\n    const hPrime = H / 60\n    const X = C * (1 - Math.abs((hPrime % 2) - 1))\n    const [R1, G1, B1] =\n      hPrime < 1\n        ? [C, X, 0]\n        : hPrime < 2\n        ? [X, C, 0]\n        : hPrime < 3\n        ? [0, C, X]\n        : hPrime < 4\n        ? [0, X, C]\n        : hPrime < 5\n        ? [X, 0, C]\n        : [C, 0, X]\n\n    const m = L - (0.3 * R1 + 0.59 * G1 + 0.11 * B1)\n\n    return new Color(clamp(R1 + m, 0, 1), clamp(G1 + m, 0, 1), clamp(B1 + m, 0, 1), 1.0)\n  }\n\n  static fromCSSHex(hex: string) {\n    if (hex.length !== 7 || hex[0] !== '#') {\n      throw new Error(`Invalid color input ${hex}`)\n    }\n    const r = parseInt(hex.substr(1, 2), 16) / 255\n    const g = parseInt(hex.substr(3, 2), 16) / 255\n    const b = parseInt(hex.substr(5, 2), 16) / 255\n    if (r < 0 || r > 1 || g < 0 || g > 1 || b < 0 || b > 1) {\n      throw new Error(`Invalid color input ${hex}`)\n    }\n    return new Color(r, g, b)\n  }\n\n  withAlpha(a: number): Color {\n    return new Color(this.r, this.g, this.b, a)\n  }\n\n  toCSS(): string {\n    return `rgba(${(255 * this.r).toFixed()}, ${(255 * this.g).toFixed()}, ${(\n      255 * this.b\n    ).toFixed()}, ${this.a.toFixed(2)})`\n  }\n}\n","import {LRUCache} from '../lib/lru-cache'\nimport {RectangleBatch, RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {Rect, Vec2} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {Graphics} from './graphics'\nimport {TextureRenderer} from './texture-renderer'\nimport {renderInto} from './utils'\n\nexport class RowAtlas<K> {\n  private texture: Graphics.Texture\n  private renderTarget: Graphics.RenderTarget\n  private rowCache: LRUCache<K, number>\n  private clearLineBatch: RectangleBatch\n\n  constructor(\n    private gl: Graphics.Context,\n    private rectangleBatchRenderer: RectangleBatchRenderer,\n    private textureRenderer: TextureRenderer,\n  ) {\n    this.texture = gl.createTexture(Graphics.TextureFormat.NEAREST_CLAMP, 4096, 4096)\n    this.renderTarget = gl.createRenderTarget(this.texture)\n    this.rowCache = new LRUCache(this.texture.height)\n    this.clearLineBatch = new RectangleBatch(gl)\n    this.clearLineBatch.addRect(Rect.unit, new Color(0, 0, 0, 0))\n\n    // All of the cached data is stored GPU-side, and we don't retain a copy of\n    // it client-side. This means when we get a context loss event, the data is\n    // totally gone. So let's clear our CPU-side cache to reflect that fact.\n    gl.addContextResetHandler(() => {\n      this.rowCache.clear()\n    })\n  }\n\n  has(key: K) {\n    return this.rowCache.has(key)\n  }\n  getResolution() {\n    return this.texture.width\n  }\n  getCapacity() {\n    return this.texture.height\n  }\n\n  private allocateLine(key: K): number {\n    if (this.rowCache.getSize() < this.rowCache.getCapacity()) {\n      // Not in cache, but cache isn't full\n      const row = this.rowCache.getSize()\n      this.rowCache.insert(key, row)\n      return row\n    } else {\n      // Not in cache, and cache is full. Evict something.\n      const [, row] = this.rowCache.removeLRU()!\n      this.rowCache.insert(key, row)\n      return row\n    }\n  }\n\n  writeToAtlasIfNeeded(keys: K[], render: (textureDstRect: Rect, key: K) => void) {\n    renderInto(this.gl, this.renderTarget, () => {\n      for (let key of keys) {\n        let row = this.rowCache.get(key)\n        if (row != null) {\n          // Already cached!\n          continue\n        }\n        // Not cached -- we'll have to actually render\n        row = this.allocateLine(key)\n\n        const textureRect = new Rect(new Vec2(0, row), new Vec2(this.texture.width, 1))\n        this.rectangleBatchRenderer.render({\n          batch: this.clearLineBatch,\n          configSpaceSrcRect: Rect.unit,\n          physicalSpaceDstRect: textureRect,\n        })\n        render(textureRect, key)\n      }\n    })\n  }\n\n  renderViaAtlas(key: K, dstRect: Rect): boolean {\n    let row = this.rowCache.get(key)\n    if (row == null) {\n      return false\n    }\n\n    const textureRect = new Rect(new Vec2(0, row), new Vec2(this.texture.width, 1))\n\n    // At this point, we have the row in cache, and we can\n    // paint directly from it into the framebuffer.\n    this.textureRenderer.render({\n      texture: this.texture,\n      srcRect: textureRect,\n      dstRect: dstRect,\n    })\n    return true\n  }\n}\n","import {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nexport interface TextureRendererProps {\n  texture: Graphics.Texture\n  srcRect: Rect\n  dstRect: Rect\n}\n\nconst vert = `\n  uniform mat3 uvTransform;\n  uniform mat3 positionTransform;\n\n  attribute vec2 position;\n  attribute vec2 uv;\n  varying vec2 vUv;\n\n  void main() {\n    vUv = (uvTransform * vec3(uv, 1)).xy;\n    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);\n  }\n`\n\nconst frag = `\n  precision mediump float;\n\n  varying vec2 vUv;\n  uniform sampler2D texture;\n\n  void main() {\n   gl_FragColor = texture2D(texture, vUv);\n  }\n`\n\nexport interface TextureRendererProps {\n  texture: Graphics.Texture\n  srcRect: Rect\n  dstRect: Rect\n}\n\nexport class TextureRenderer {\n  private buffer: Graphics.VertexBuffer\n  private material: Graphics.Material\n\n  constructor(private gl: Graphics.Context) {\n    const vertexFormat = new Graphics.VertexFormat()\n    vertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\n    vertexFormat.add('uv', Graphics.AttributeType.FLOAT, 2)\n\n    const vertices = [\n      {pos: [-1, 1], uv: [0, 1]},\n      {pos: [1, 1], uv: [1, 1]},\n      {pos: [-1, -1], uv: [0, 0]},\n      {pos: [1, -1], uv: [1, 0]},\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v.pos[0])\n      floats.push(v.pos[1])\n      floats.push(v.uv[0])\n      floats.push(v.uv[1])\n    }\n\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.upload(new Uint8Array(new Float32Array(floats).buffer))\n    this.material = gl.createMaterial(vertexFormat, vert, frag)\n  }\n\n  render(props: TextureRendererProps) {\n    this.material.setUniformSampler('texture', props.texture, 0)\n    setUniformAffineTransform(\n      this.material,\n      'uvTransform',\n      (() => {\n        const {srcRect, texture} = props\n        const physicalToUV = AffineTransform.withTranslation(new Vec2(0, 1))\n          .times(AffineTransform.withScale(new Vec2(1, -1)))\n          .times(\n            AffineTransform.betweenRects(\n              new Rect(Vec2.zero, new Vec2(texture.width, texture.height)),\n              Rect.unit,\n            ),\n          )\n        const uvRect = physicalToUV.transformRect(srcRect)\n        return AffineTransform.betweenRects(Rect.unit, uvRect)\n      })(),\n    )\n    setUniformAffineTransform(\n      this.material,\n      'positionTransform',\n      (() => {\n        const {dstRect} = props\n\n        const {viewport} = this.gl\n        const viewportSize = new Vec2(viewport.width, viewport.height)\n\n        const physicalToNDC = AffineTransform.withScale(new Vec2(1, -1)).times(\n          AffineTransform.betweenRects(new Rect(Vec2.zero, viewportSize), Rect.NDC),\n        )\n        const ndcRect = physicalToNDC.transformRect(dstRect)\n        return AffineTransform.betweenRects(Rect.NDC, ndcRect)\n      })(),\n    )\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n","import {Color} from '../lib/color'\nimport {AffineTransform, Rect} from '../lib/math'\nimport {Theme} from '../views/themes/theme'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform, setUniformVec2} from './utils'\n\nexport interface ViewportRectangleRendererProps {\n  configSpaceToPhysicalViewSpace: AffineTransform\n  configSpaceViewportRect: Rect\n}\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\n\nconst vert = `\n  attribute vec2 position;\n\n  void main() {\n    gl_Position = vec4(position, 0, 1);\n  }\n`\n\nconst frag = (theme: Theme) => {\n  const {r, g, b} = Color.fromCSSHex(theme.fgSecondaryColor)\n  const rgb = `${r.toFixed(1)}, ${g.toFixed(1)}, ${b.toFixed(1)}`\n  return `\n    precision mediump float;\n\n    uniform mat3 configSpaceToPhysicalViewSpace;\n    uniform vec2 physicalSize;\n    uniform vec2 physicalOrigin;\n    uniform vec2 configSpaceViewportOrigin;\n    uniform vec2 configSpaceViewportSize;\n    uniform float framebufferHeight;\n\n    void main() {\n      vec2 origin = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportOrigin, 1.0)).xy;\n      vec2 size = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportSize, 0.0)).xy;\n\n      vec2 halfSize = physicalSize / 2.0;\n\n      float borderWidth = 2.0;\n\n      origin = floor(origin * halfSize) / halfSize + borderWidth * vec2(1.0, 1.0);\n      size = floor(size * halfSize) / halfSize - 2.0 * borderWidth * vec2(1.0, 1.0);\n\n      vec2 coord = gl_FragCoord.xy;\n      coord.x = coord.x - physicalOrigin.x;\n      coord.y = framebufferHeight - coord.y - physicalOrigin.y;\n      vec2 clamped = clamp(coord, origin, origin + size);\n      vec2 gap = clamped - coord;\n      float maxdist = max(abs(gap.x), abs(gap.y));\n\n      // TOOD(jlfwong): Could probably optimize this to use mix somehow.\n      if (maxdist == 0.0) {\n        // Inside viewport rectangle\n        gl_FragColor = vec4(0, 0, 0, 0);\n      } else if (maxdist < borderWidth) {\n        // Inside viewport rectangle at border\n        gl_FragColor = vec4(${rgb}, 0.8);\n      } else {\n        // Outside viewport rectangle\n        gl_FragColor = vec4(${rgb}, 0.5);\n      }\n    }\n  `\n}\n\nexport class ViewportRectangleRenderer {\n  private material: Graphics.Material\n  private buffer: Graphics.VertexBuffer\n\n  constructor(private gl: Graphics.Context, theme: Theme) {\n    const vertices = [\n      [-1, 1],\n      [1, 1],\n      [-1, -1],\n      [1, -1],\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v[0])\n      floats.push(v[1])\n    }\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.upload(new Uint8Array(new Float32Array(floats).buffer))\n    this.material = gl.createMaterial(vertexFormat, vert, frag(theme))\n  }\n\n  render(props: ViewportRectangleRendererProps) {\n    setUniformAffineTransform(\n      this.material,\n      'configSpaceToPhysicalViewSpace',\n      props.configSpaceToPhysicalViewSpace,\n    )\n\n    // TODO(jlfwong): Pack these into a Vec4 instead\n    setUniformVec2(this.material, 'configSpaceViewportOrigin', props.configSpaceViewportRect.origin)\n    setUniformVec2(this.material, 'configSpaceViewportSize', props.configSpaceViewportRect.size)\n    // TODO(jlfwong): Pack these into a Vec4 instead\n\n    const viewport = this.gl.viewport\n    this.material.setUniformVec2('physicalOrigin', viewport.x, viewport.y)\n    this.material.setUniformVec2('physicalSize', viewport.width, viewport.height)\n\n    this.material.setUniformFloat('framebufferHeight', this.gl.renderTargetHeightInPixels)\n\n    this.gl.setBlendState(\n      Graphics.BlendOperation.SOURCE_ALPHA,\n      Graphics.BlendOperation.INVERSE_SOURCE_ALPHA,\n    )\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n","import {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Theme} from '../views/themes/theme'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\nvertexFormat.add('uv', Graphics.AttributeType.FLOAT, 2)\n\nconst vert = `\n  uniform mat3 uvTransform;\n  uniform mat3 positionTransform;\n\n  attribute vec2 position;\n  attribute vec2 uv;\n  varying vec2 vUv;\n\n  void main() {\n    vUv = (uvTransform * vec3(uv, 1)).xy;\n    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);\n  }\n`\n\nconst frag = (colorForBucket: string) => `\n  precision mediump float;\n\n  uniform vec2 uvSpacePixelSize;\n  uniform float renderOutlines;\n\n  varying vec2 vUv;\n  uniform sampler2D colorTexture;\n\n  // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue\n  vec3 hcl2rgb(float H, float C, float L) {\n    float hPrime = H / 60.0;\n    float X = C * (1.0 - abs(mod(hPrime, 2.0) - 1.0));\n    vec3 RGB =\n      hPrime < 1.0 ? vec3(C, X, 0) :\n      hPrime < 2.0 ? vec3(X, C, 0) :\n      hPrime < 3.0 ? vec3(0, C, X) :\n      hPrime < 4.0 ? vec3(0, X, C) :\n      hPrime < 5.0 ? vec3(X, 0, C) :\n      vec3(C, 0, X);\n\n    float m = L - dot(RGB, vec3(0.30, 0.59, 0.11));\n    return RGB + vec3(m, m, m);\n  }\n\n  float triangle(float x) {\n    return 2.0 * abs(fract(x) - 0.5) - 1.0;\n  }\n\n  ${colorForBucket}\n\n  void main() {\n    vec4 here = texture2D(colorTexture, vUv);\n\n    if (here.z == 0.0) {\n      // Background color\n      gl_FragColor = vec4(0, 0, 0, 0);\n      return;\n    }\n\n    // Sample the 4 surrounding pixels in the depth texture to determine\n    // if we should draw a boundary here or not.\n    vec4 N = texture2D(colorTexture, vUv + vec2(0, uvSpacePixelSize.y));\n    vec4 E = texture2D(colorTexture, vUv + vec2(uvSpacePixelSize.x, 0));\n    vec4 S = texture2D(colorTexture, vUv + vec2(0, -uvSpacePixelSize.y));\n    vec4 W = texture2D(colorTexture, vUv + vec2(-uvSpacePixelSize.x, 0));\n\n    // NOTE: For outline checks, we intentionally check both the right\n    // and the left to determine if we're an edge. If a rectangle is a single\n    // pixel wide, we don't want to render it as an outline, so this method\n    // of checking ensures that we don't outline single physical-space\n    // pixel width rectangles.\n    if (\n      renderOutlines > 0.0 &&\n      (\n        here.y == N.y && here.y != S.y || // Top edge\n        here.y == S.y && here.y != N.y || // Bottom edge\n        here.x == E.x && here.x != W.x || // Left edge\n        here.x == W.x && here.x != E.x\n      )\n    ) {\n      // We're on an edge! Draw transparent.\n      gl_FragColor = vec4(0, 0, 0, 0);\n    } else {\n      // Not on an edge. Draw the appropriate color.\n      gl_FragColor = vec4(colorForBucket(here.z), here.a);\n    }\n  }\n`\n\nexport interface FlamechartColorPassRenderProps {\n  rectInfoTexture: Graphics.Texture\n  renderOutlines: boolean\n  srcRect: Rect\n  dstRect: Rect\n}\n\nexport class FlamechartColorPassRenderer {\n  private material: Graphics.Material\n  private buffer: Graphics.VertexBuffer\n\n  constructor(private gl: Graphics.Context, theme: Theme) {\n    const vertices = [\n      {pos: [-1, 1], uv: [0, 1]},\n      {pos: [1, 1], uv: [1, 1]},\n      {pos: [-1, -1], uv: [0, 0]},\n      {pos: [1, -1], uv: [1, 0]},\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v.pos[0])\n      floats.push(v.pos[1])\n      floats.push(v.uv[0])\n      floats.push(v.uv[1])\n    }\n\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.uploadFloats(floats)\n    this.material = gl.createMaterial(vertexFormat, vert, frag(theme.colorForBucketGLSL))\n  }\n\n  render(props: FlamechartColorPassRenderProps) {\n    const {srcRect, rectInfoTexture} = props\n    const physicalToUV = AffineTransform.withTranslation(new Vec2(0, 1))\n      .times(AffineTransform.withScale(new Vec2(1, -1)))\n      .times(\n        AffineTransform.betweenRects(\n          new Rect(Vec2.zero, new Vec2(rectInfoTexture.width, rectInfoTexture.height)),\n          Rect.unit,\n        ),\n      )\n    const uvRect = physicalToUV.transformRect(srcRect)\n    const uvTransform = AffineTransform.betweenRects(Rect.unit, uvRect)\n\n    const {dstRect} = props\n    const viewportSize = new Vec2(this.gl.viewport.width, this.gl.viewport.height)\n\n    const physicalToNDC = AffineTransform.withScale(new Vec2(1, -1)).times(\n      AffineTransform.betweenRects(new Rect(Vec2.zero, viewportSize), Rect.NDC),\n    )\n    const ndcRect = physicalToNDC.transformRect(dstRect)\n    const positionTransform = AffineTransform.betweenRects(Rect.NDC, ndcRect)\n\n    const uvSpacePixelSize = Vec2.unit.dividedByPointwise(\n      new Vec2(props.rectInfoTexture.width, props.rectInfoTexture.height),\n    )\n\n    this.material.setUniformSampler('colorTexture', props.rectInfoTexture, 0)\n    setUniformAffineTransform(this.material, 'uvTransform', uvTransform)\n    this.material.setUniformFloat('renderOutlines', props.renderOutlines ? 1.0 : 0.0)\n    this.material.setUniformVec2('uvSpacePixelSize', uvSpacePixelSize.x, uvSpacePixelSize.y)\n    setUniformAffineTransform(this.material, 'positionTransform', positionTransform)\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n","import {Graphics, WebGL} from './graphics'\nimport {RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {TextureRenderer} from './texture-renderer'\nimport {Rect, Vec2} from '../lib/math'\nimport {ViewportRectangleRenderer} from './overlay-rectangle-renderer'\nimport {FlamechartColorPassRenderer} from './flamechart-color-pass-renderer'\nimport {Color} from '../lib/color'\nimport {Theme} from '../views/themes/theme'\n\ntype FrameCallback = () => void\n\nexport class CanvasContext {\n  public readonly gl: WebGL.Context\n  public readonly rectangleBatchRenderer: RectangleBatchRenderer\n  public readonly textureRenderer: TextureRenderer\n  public readonly viewportRectangleRenderer: ViewportRectangleRenderer\n  public readonly flamechartColorPassRenderer: FlamechartColorPassRenderer\n  public readonly theme: Theme\n\n  constructor(canvas: HTMLCanvasElement, theme: Theme) {\n    this.gl = new WebGL.Context(canvas)\n    this.rectangleBatchRenderer = new RectangleBatchRenderer(this.gl)\n    this.textureRenderer = new TextureRenderer(this.gl)\n    this.viewportRectangleRenderer = new ViewportRectangleRenderer(this.gl, theme)\n    this.flamechartColorPassRenderer = new FlamechartColorPassRenderer(this.gl, theme)\n    this.theme = theme\n\n    // Whenever the canvas is resized, draw immediately. This prevents\n    // flickering during resizing.\n    this.gl.addAfterResizeEventHandler(this.onBeforeFrame)\n\n    const webGLInfo = this.gl.getWebGLInfo()\n    if (webGLInfo) {\n      console.log(\n        `WebGL initialized. renderer: ${webGLInfo.renderer}, vendor: ${webGLInfo.vendor}, version: ${webGLInfo.version}`,\n      )\n    }\n    ;(window as any)['testContextLoss'] = () => {\n      this.gl.testContextLoss()\n    }\n  }\n\n  private animationFrameRequest: number | null = null\n  private beforeFrameHandlers = new Set<FrameCallback>()\n  addBeforeFrameHandler(callback: FrameCallback) {\n    this.beforeFrameHandlers.add(callback)\n  }\n  removeBeforeFrameHandler(callback: FrameCallback) {\n    this.beforeFrameHandlers.delete(callback)\n  }\n  requestFrame() {\n    if (!this.animationFrameRequest) {\n      this.animationFrameRequest = requestAnimationFrame(this.onBeforeFrame)\n    }\n  }\n  private onBeforeFrame = () => {\n    this.animationFrameRequest = null\n    this.gl.setViewport(0, 0, this.gl.renderTargetWidthInPixels, this.gl.renderTargetHeightInPixels)\n    const color = Color.fromCSSHex(this.theme.bgPrimaryColor)\n    this.gl.clear(new Graphics.Color(color.r, color.g, color.b, color.a))\n\n    for (const handler of this.beforeFrameHandlers) {\n      handler()\n    }\n  }\n\n  setViewport(physicalBounds: Rect, cb: () => void): void {\n    const {origin, size} = physicalBounds\n    let viewportBefore = this.gl.viewport\n    this.gl.setViewport(origin.x, origin.y, size.x, size.y)\n\n    cb()\n\n    let {x, y, width, height} = viewportBefore\n    this.gl.setViewport(x, y, width, height)\n  }\n\n  renderBehind(el: Element, cb: () => void) {\n    const bounds = el.getBoundingClientRect()\n    const physicalBounds = new Rect(\n      new Vec2(bounds.left * window.devicePixelRatio, bounds.top * window.devicePixelRatio),\n      new Vec2(bounds.width * window.devicePixelRatio, bounds.height * window.devicePixelRatio),\n    )\n\n    this.setViewport(physicalBounds, cb)\n  }\n}\n","export interface ICallTree<T> {\n    item: T,\n    total_samples: number,\n    self_samples: number,\n    children: ICallTree<T>[] | null,\n}\n\nexport enum CodeType {\n    Native = \"Native\",\n    Python = \"Python\",\n    Kernel = \"Kernel\",\n}\n\nexport interface IResolvedFrame {\n    name: string,\n    code_type: CodeType,\n}\n\nexport type CallTree = ICallTree<IResolvedFrame | null>\n","import {Frame, Profile} from '../lib/profile'\nimport {memoizeByReference, memoizeByShallowEquality} from '../lib/utils'\nimport {RowAtlas} from '../gl/row-atlas'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {FlamechartRowAtlasKey} from '../gl/flamechart-renderer'\nimport {Theme} from '../views/themes/theme'\nimport {CodeType} from \"../views/app_types\"\n\nexport const createGetColorBucketForFrame = memoizeByReference(\n  (frameToColorBucket: Map<number | string, number>) => {\n    return (frame: Frame): number => {\n      return frameToColorBucket.get(frame.color_key) || 0\n    }\n  },\n)\n\nexport const createGetCSSColorForFrame = memoizeByShallowEquality(\n  ({\n    theme,\n    frameToColorBucket,\n  }: {\n    theme: Theme\n    frameToColorBucket: Map<number | string, number>\n  }) => {\n    const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n    return (frame: Frame): string => {\n      const t = getColorBucketForFrame(frame) / 255\n      return theme.colorForBucket(t).toCSS()\n    }\n  },\n)\n\nexport const getCanvasContext = memoizeByShallowEquality(\n  ({theme, canvas}: {theme: Theme; canvas: HTMLCanvasElement}) => {\n    return new CanvasContext(canvas, theme)\n  },\n)\n\nexport const getRowAtlas = memoizeByReference((canvasContext: CanvasContext) => {\n  return new RowAtlas<FlamechartRowAtlasKey>(\n    canvasContext.gl,\n    canvasContext.rectangleBatchRenderer,\n    canvasContext.textureRenderer,\n  )\n})\n\nexport const getProfileToView = memoizeByShallowEquality(\n  ({profile, flattenRecursion}: {profile: Profile; flattenRecursion: boolean}): Profile => {\n    return flattenRecursion ? profile.getProfileWithRecursionFlattened() : profile\n  },\n)\nexport const getFrameToColorBucket = memoizeByReference(\n  (profile: Profile): Map<string | number, number> => {\n    // const frames: Frame[] = []\n    // profile.forEachFrame(f => frames.push(f))\n    // function key(f: Frame) {\n    //   return (f.file || '') + f.name\n    // }\n    // function compare(a: Frame, b: Frame) {\n    //   return key(a) > key(b) ? 1 : -1\n    // }\n    // frames.sort(compare)\n    const frameToColorBucket = new Map<string | number, number>()\n    // for (let i = 0; i < frames.length; i++) {\n    //   frameToColorBucket.set(frames[i].color_key, Math.floor((255 * i) / frames.length))\n    // }\n    frameToColorBucket.set(CodeType.Native, 100)\n    frameToColorBucket.set(CodeType.Python, 255)\n    console.log(frameToColorBucket);\n\n    return frameToColorBucket\n  },\n)\n","import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tif (currentComponent.__hooks) {\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\tcurrentComponent.__hooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\tif (hooks._pendingEffects.length) {\n\t\t\tafterPaint(afterPaintEffects.push(c));\n\t\t}\n\t}\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\ttry {\n\t\t\thooks._list.forEach(hook => hook._cleanup && hook._cleanup());\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {import('./internal').HookState}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} initialState\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\tif (!hookState._component) {\n\t\thookState._component = currentComponent;\n\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value[0] = nextValue;\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t\treturn (state._value = factory());\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\nexport function useErrorBoundary(cb) {\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tafterPaintEffects.some(component => {\n\t\tif (component._parentDom) {\n\t\t\ttry {\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t} catch (e) {\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t\toptions._catchError(e, component._vnode);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t});\n\tafterPaintEffects = [];\n}\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tcancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (typeof window != 'undefined') {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\tif (hook._cleanup) hook._cleanup();\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\tconst result = hook._value();\n\tif (typeof result == 'function') hook._cleanup = result;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn !oldArgs || newArgs.some((arg, index) => arg !== oldArgs[index]);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Check if two objects have a different shape\n * @param {object} a\n * @param {object} b\n * @returns {boolean}\n */\nexport function shallowDiffers(a, b) {\n\tfor (let i in a) if (i !== '__source' && !(i in b)) return true;\n\tfor (let i in b) if (i !== '__source' && a[i] !== b[i]) return true;\n\treturn false;\n}\n","import { Component } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Component class with a predefined `shouldComponentUpdate` implementation\n */\nexport class PureComponent extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t// Some third-party libraries check if this property is present\n\t\tthis.isPureReactComponent = true;\n\t}\n\n\tshouldComponentUpdate(props, state) {\n\t\treturn (\n\t\t\tshallowDiffers(this.props, props) || shallowDiffers(this.state, state)\n\t\t);\n\t}\n}\n","import { createElement } from 'preact';\nimport { shallowDiffers, assign } from './util';\n\n/**\n * Memoize a component, so that it only updates when the props actually have\n * changed. This was previously known as `React.pure`.\n * @param {import('./internal').FunctionalComponent} c functional component\n * @param {(prev: object, next: object) => boolean} [comparer] Custom equality function\n * @returns {import('./internal').FunctionalComponent}\n */\nexport function memo(c, comparer) {\n\tfunction shouldUpdate(nextProps) {\n\t\tlet ref = this.props.ref;\n\t\tlet updateRef = ref == nextProps.ref;\n\t\tif (!updateRef && ref) {\n\t\t\tref.call ? ref(null) : (ref.current = null);\n\t\t}\n\n\t\tif (!comparer) {\n\t\t\treturn shallowDiffers(this.props, nextProps);\n\t\t}\n\n\t\treturn !comparer(this.props, nextProps) || !updateRef;\n\t}\n\n\tfunction Memoed(props) {\n\t\tthis.shouldComponentUpdate = shouldUpdate;\n\t\treturn createElement(c, assign({}, props));\n\t}\n\tMemoed.prototype.isReactComponent = true;\n\tMemoed.displayName = 'Memo(' + (c.displayName || c.name) + ')';\n\tMemoed._forwarded = true;\n\treturn Memoed;\n}\n","import { options } from 'preact';\nimport { assign } from './util';\n\nlet oldDiffHook = options._diff;\noptions._diff = vnode => {\n\tif (vnode.type && vnode.type._forwarded && vnode.ref) {\n\t\tvnode.props.ref = vnode.ref;\n\t\tvnode.ref = null;\n\t}\n\tif (oldDiffHook) oldDiffHook(vnode);\n};\n\n/**\n * Pass ref down to a child. This is mainly used in libraries with HOCs that\n * wrap components. Using `forwardRef` there is an easy way to get a reference\n * of the wrapped component instead of one of the wrapper itself.\n * @param {import('./index').ForwardFn} fn\n * @returns {import('./internal').FunctionalComponent}\n */\nexport function forwardRef(fn) {\n\tfunction Forwarded(props) {\n\t\tlet clone = assign({}, props);\n\t\tdelete clone.ref;\n\t\treturn fn(clone, props.ref);\n\t}\n\tForwarded.prototype.isReactComponent = Forwarded._forwarded = true;\n\tForwarded.displayName = 'ForwardRef(' + (fn.displayName || fn.name) + ')';\n\treturn Forwarded;\n}\n","import { Component, createElement, options } from 'preact';\nimport { assign } from './util';\n\nconst oldCatchError = options._catchError;\noptions._catchError = function(error, newVNode, oldVNode) {\n\tif (error.then) {\n\t\t/** @type {import('./internal').Component} */\n\t\tlet component;\n\t\tlet vnode = newVNode;\n\n\t\tfor (; (vnode = vnode._parent); ) {\n\t\t\tif ((component = vnode._component) && component._childDidSuspend) {\n\t\t\t\t// Don't call oldCatchError if we found a Suspense\n\t\t\t\treturn component._childDidSuspend(error, newVNode._component);\n\t\t\t}\n\t\t}\n\t}\n\toldCatchError(error, newVNode, oldVNode);\n};\n\nfunction detachedClone(vnode) {\n\tif (vnode) {\n\t\tvnode = assign({}, vnode);\n\t\tvnode._component = null;\n\t\tvnode._children = vnode._children && vnode._children.map(detachedClone);\n\t}\n\treturn vnode;\n}\n\n// having custom inheritance instead of a class here saves a lot of bytes\nexport function Suspense() {\n\t// we do not call super here to golf some bytes...\n\tthis._pendingSuspensionCount = 0;\n\tthis._suspenders = null;\n\tthis._detachOnNextRender = null;\n}\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspense.prototype = new Component();\n\n/**\n * @param {Promise} promise The thrown promise\n * @param {Component<any, any>} suspendingComponent The suspending component\n */\nSuspense.prototype._childDidSuspend = function(promise, suspendingComponent) {\n\t/** @type {import('./internal').SuspenseComponent} */\n\tconst c = this;\n\n\tif (c._suspenders == null) {\n\t\tc._suspenders = [];\n\t}\n\tc._suspenders.push(suspendingComponent);\n\n\tconst resolve = suspended(c._vnode);\n\n\tlet resolved = false;\n\tconst onResolved = () => {\n\t\tif (resolved) return;\n\n\t\tresolved = true;\n\n\t\tif (resolve) {\n\t\t\tresolve(onSuspensionComplete);\n\t\t} else {\n\t\t\tonSuspensionComplete();\n\t\t}\n\t};\n\n\tsuspendingComponent._suspendedComponentWillUnmount =\n\t\tsuspendingComponent.componentWillUnmount;\n\tsuspendingComponent.componentWillUnmount = () => {\n\t\tonResolved();\n\n\t\tif (suspendingComponent._suspendedComponentWillUnmount) {\n\t\t\tsuspendingComponent._suspendedComponentWillUnmount();\n\t\t}\n\t};\n\n\tconst onSuspensionComplete = () => {\n\t\tif (!--c._pendingSuspensionCount) {\n\t\t\tc._vnode._children[0] = c.state._suspended;\n\t\t\tc.setState({ _suspended: (c._detachOnNextRender = null) });\n\n\t\t\tlet suspended;\n\t\t\twhile ((suspended = c._suspenders.pop())) {\n\t\t\t\tsuspended.forceUpdate();\n\t\t\t}\n\t\t}\n\t};\n\n\tif (!c._pendingSuspensionCount++) {\n\t\tc.setState({ _suspended: (c._detachOnNextRender = c._vnode._children[0]) });\n\t}\n\tpromise.then(onResolved, onResolved);\n};\n\nSuspense.prototype.render = function(props, state) {\n\tif (this._detachOnNextRender) {\n\t\tthis._vnode._children[0] = detachedClone(this._detachOnNextRender);\n\t\tthis._detachOnNextRender = null;\n\t}\n\n\treturn [\n\t\tcreateElement(Component, null, state._suspended ? null : props.children),\n\t\tstate._suspended && props.fallback\n\t];\n};\n\n/**\n * Checks and calls the parent component's _suspended method, passing in the\n * suspended vnode. This is a way for a parent (e.g. SuspenseList) to get notified\n * that one of its children/descendants suspended.\n *\n * The parent MAY return a callback. The callback will get called when the\n * suspension resolves, notifying the parent of the fact.\n * Moreover, the callback gets function `unsuspend` as a parameter. The resolved\n * child descendant will not actually get unsuspended until `unsuspend` gets called.\n * This is a way for the parent to delay unsuspending.\n *\n * If the parent does not return a callback then the resolved vnode\n * gets unsuspended immediately when it resolves.\n *\n * @param {import('../src/internal').VNode} vnode\n * @returns {((unsuspend: () => void) => void)?}\n */\nexport function suspended(vnode) {\n\tlet component = vnode._parent._component;\n\treturn component && component._suspended && component._suspended(vnode);\n}\n\nexport function lazy(loader) {\n\tlet prom;\n\tlet component;\n\tlet error;\n\n\tfunction Lazy(props) {\n\t\tif (!prom) {\n\t\t\tprom = loader();\n\t\t\tprom.then(\n\t\t\t\texports => {\n\t\t\t\t\tcomponent = exports.default || exports;\n\t\t\t\t},\n\t\t\t\te => {\n\t\t\t\t\terror = e;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\n\t\tif (!component) {\n\t\t\tthrow prom;\n\t\t}\n\n\t\treturn createElement(component, props);\n\t}\n\n\tLazy.displayName = 'Lazy';\n\tLazy._forwarded = true;\n\treturn Lazy;\n}\n","import { Component, toChildArray } from 'preact';\nimport { suspended } from './suspense.js';\n\n// Indexes to linked list nodes (nodes are stored as arrays to save bytes).\nconst SUSPENDED_COUNT = 0;\nconst RESOLVED_COUNT = 1;\nconst NEXT_NODE = 2;\n\n// Having custom inheritance instead of a class here saves a lot of bytes.\nexport function SuspenseList() {\n\tthis._next = null;\n\tthis._map = null;\n}\n\n// Mark one of child's earlier suspensions as resolved.\n// Some pending callbacks may become callable due to this\n// (e.g. the last suspended descendant gets resolved when\n// revealOrder === 'together'). Process those callbacks as well.\nconst resolve = (list, child, node) => {\n\tif (++node[RESOLVED_COUNT] === node[SUSPENDED_COUNT]) {\n\t\t// The number a child (or any of its descendants) has been suspended\n\t\t// matches the number of times it's been resolved. Therefore we\n\t\t// mark the child as completely resolved by deleting it from ._map.\n\t\t// This is used to figure out when *all* children have been completely\n\t\t// resolved when revealOrder is 'together'.\n\t\tlist._map.delete(child);\n\t}\n\n\t// If revealOrder is falsy then we can do an early exit, as the\n\t// callbacks won't get queued in the node anyway.\n\t// If revealOrder is 'together' then also do an early exit\n\t// if all suspended descendants have not yet been resolved.\n\tif (\n\t\t!list.props.revealOrder ||\n\t\t(list.props.revealOrder[0] === 't' && list._map.size)\n\t) {\n\t\treturn;\n\t}\n\n\t// Walk the currently suspended children in order, calling their\n\t// stored callbacks on the way. Stop if we encounter a child that\n\t// has not been completely resolved yet.\n\tnode = list._next;\n\twhile (node) {\n\t\twhile (node.length > 3) {\n\t\t\tnode.pop()();\n\t\t}\n\t\tif (node[RESOLVED_COUNT] < node[SUSPENDED_COUNT]) {\n\t\t\tbreak;\n\t\t}\n\t\tlist._next = node = node[NEXT_NODE];\n\t}\n};\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspenseList.prototype = new Component();\n\nSuspenseList.prototype._suspended = function(child) {\n\tconst list = this;\n\tconst delegated = suspended(list._vnode);\n\n\tlet node = list._map.get(child);\n\tnode[SUSPENDED_COUNT]++;\n\n\treturn unsuspend => {\n\t\tconst wrappedUnsuspend = () => {\n\t\t\tif (!list.props.revealOrder) {\n\t\t\t\t// Special case the undefined (falsy) revealOrder, as there\n\t\t\t\t// is no need to coordinate a specific order or unsuspends.\n\t\t\t\tunsuspend();\n\t\t\t} else {\n\t\t\t\tnode.push(unsuspend);\n\t\t\t\tresolve(list, child, node);\n\t\t\t}\n\t\t};\n\t\tif (delegated) {\n\t\t\tdelegated(wrappedUnsuspend);\n\t\t} else {\n\t\t\twrappedUnsuspend();\n\t\t}\n\t};\n};\n\nSuspenseList.prototype.render = function(props) {\n\tthis._next = null;\n\tthis._map = new Map();\n\n\tconst children = toChildArray(props.children);\n\tif (props.revealOrder && props.revealOrder[0] === 'b') {\n\t\t// If order === 'backwards' (or, well, anything starting with a 'b')\n\t\t// then flip the child list around so that the last child will be\n\t\t// the first in the linked list.\n\t\tchildren.reverse();\n\t}\n\t// Build the linked list. Iterate through the children in reverse order\n\t// so that `_next` points to the first linked list node to be resolved.\n\tfor (let i = children.length; i--; ) {\n\t\t// Create a new linked list node as an array of form:\n\t\t// \t[suspended_count, resolved_count, next_node]\n\t\t// where suspended_count and resolved_count are numeric counters for\n\t\t// keeping track how many times a node has been suspended and resolved.\n\t\t//\n\t\t// Note that suspended_count starts from 1 instead of 0, so we can block\n\t\t// processing callbacks until componentDidMount has been called. In a sense\n\t\t// node is suspended at least until componentDidMount gets called!\n\t\t//\n\t\t// Pending callbacks are added to the end of the node:\n\t\t// \t[suspended_count, resolved_count, next_node, callback_0, callback_1, ...]\n\t\tthis._map.set(children[i], (this._next = [1, 0, this._next]));\n\t}\n\treturn props.children;\n};\n\nSuspenseList.prototype.componentDidUpdate = SuspenseList.prototype.componentDidMount = function() {\n\t// Iterate through all children after mounting for two reasons:\n\t// 1. As each node[SUSPENDED_COUNT] starts from 1, this iteration increases\n\t//    each node[RELEASED_COUNT] by 1, therefore balancing the counters.\n\t//    The nodes can now be completely consumed from the linked list.\n\t// 2. Handle nodes that might have gotten resolved between render and\n\t//    componentDidMount.\n\tconst list = this;\n\tlist._map.forEach((node, child) => {\n\t\tresolve(list, child, node);\n\t});\n};\n","import { createElement, hydrate, render, _unmount } from 'preact';\n\nclass ContextProvider {\n\tgetChildContext() {\n\t\treturn this.props.context;\n\t}\n\trender(props) {\n\t\treturn props.children;\n\t}\n}\n\n/**\n * Portal component\n * @param {object | null | undefined} props\n */\nfunction Portal(props) {\n\tlet _this = this;\n\tlet container = props.container;\n\tlet wrap = createElement(\n\t\tContextProvider,\n\t\t{ context: _this.context },\n\t\tprops.vnode\n\t);\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif (_this._container && _this._container !== container) {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t\t_this._hasMounted = false;\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif (props.vnode) {\n\t\tif (!_this._hasMounted) {\n\t\t\t// Create a placeholder that we can use to insert into.\n\t\t\t_this._temp = document.createTextNode('');\n\t\t\t// Hydrate existing nodes to keep the dom intact, when rendering\n\t\t\t// wrap into the container.\n\t\t\thydrate('', container);\n\t\t\t// Append to the container (this matches React's behavior)\n\t\t\tcontainer.appendChild(_this._temp);\n\t\t\t// At this point we have mounted and should set our container.\n\t\t\t_this._hasMounted = true;\n\t\t\t_this._container = container;\n\t\t\t// Render our wrapping element into temp.\n\t\t\trender(wrap, container, _this._temp);\n\t\t\t_this._children = _this._temp._children;\n\t\t} else {\n\t\t\t// When we have mounted and the vnode is present it means the\n\t\t\t// props have changed or a parent is triggering a rerender.\n\t\t\t// This implies we only need to call render. But we need to keep\n\t\t\t// the old tree around, otherwise will treat the vnodes as new and\n\t\t\t// will wrongly call `componentDidMount` on them\n\t\t\tcontainer._children = _this._children;\n\t\t\trender(wrap, container);\n\t\t\t_this._children = container._children;\n\t\t}\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if (_this._hasMounted) {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t}\n\t// Set the wrapping element for future unmounting.\n\t_this._wrap = wrap;\n\n\t_this.componentWillUnmount = () => {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t};\n\n\treturn null;\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n * @param {import('./internal').VNode} vnode The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal(vnode, container) {\n\treturn createElement(Portal, { vnode, container });\n}\n","import {\n\trender as preactRender,\n\thydrate as preactHydrate,\n\toptions,\n\ttoChildArray,\n\tComponent\n} from 'preact';\nimport { applyEventNormalization } from './events';\n\nconst CAMEL_PROPS = /^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;\n\n// Some libraries like `react-virtualized` explicitly check for this.\nComponent.prototype.isReactComponent = {};\n\nexport const REACT_ELEMENT_TYPE =\n\t(typeof Symbol != 'undefined' && Symbol.for && Symbol.for('react.element')) ||\n\t0xeac7;\n\n/**\n * Proxy render() since React returns a Component reference.\n * @param {import('./internal').VNode} vnode VNode tree to render\n * @param {import('./internal').PreactElement} parent DOM node to render vnode tree into\n * @param {() => void} [callback] Optional callback that will be called after rendering\n * @returns {import('./internal').Component | null} The root component reference or null\n */\nexport function render(vnode, parent, callback) {\n\t// React destroys any existing DOM nodes, see #1727\n\t// ...but only on the first render, see #1828\n\tif (parent._children == null) {\n\t\twhile (parent.firstChild) {\n\t\t\tparent.removeChild(parent.firstChild);\n\t\t}\n\t}\n\n\tpreactRender(vnode, parent);\n\tif (typeof callback == 'function') callback();\n\n\treturn vnode ? vnode._component : null;\n}\n\nexport function hydrate(vnode, parent, callback) {\n\tpreactHydrate(vnode, parent);\n\tif (typeof callback == 'function') callback();\n\n\treturn vnode ? vnode._component : null;\n}\n\nlet oldEventHook = options.event;\noptions.event = e => {\n\tif (oldEventHook) e = oldEventHook(e);\n\te.persist = () => {};\n\tlet stoppedPropagating = false,\n\t\tdefaultPrevented = false;\n\n\tconst origStopPropagation = e.stopPropagation;\n\te.stopPropagation = () => {\n\t\torigStopPropagation.call(e);\n\t\tstoppedPropagating = true;\n\t};\n\n\tconst origPreventDefault = e.preventDefault;\n\te.preventDefault = () => {\n\t\torigPreventDefault.call(e);\n\t\tdefaultPrevented = true;\n\t};\n\n\te.isPropagationStopped = () => stoppedPropagating;\n\te.isDefaultPrevented = () => defaultPrevented;\n\treturn (e.nativeEvent = e);\n};\n\n// Patch in `UNSAFE_*` lifecycle hooks\nfunction setSafeDescriptor(proto, key) {\n\tif (proto['UNSAFE_' + key] && !proto[key]) {\n\t\tObject.defineProperty(proto, key, {\n\t\t\tconfigurable: false,\n\t\t\tget() {\n\t\t\t\treturn this['UNSAFE_' + key];\n\t\t\t},\n\t\t\t// This `set` is only used if a user sets a lifecycle like cWU\n\t\t\t// after setting a lifecycle like UNSAFE_cWU. I doubt anyone\n\t\t\t// actually does this in practice so not testing it\n\t\t\t/* istanbul ignore next */\n\t\t\tset(v) {\n\t\t\t\tthis['UNSAFE_' + key] = v;\n\t\t\t}\n\t\t});\n\t}\n}\n\nlet classNameDescriptor = {\n\tconfigurable: true,\n\tget() {\n\t\treturn this.class;\n\t}\n};\n\nlet oldVNodeHook = options.vnode;\noptions.vnode = vnode => {\n\tvnode.$$typeof = REACT_ELEMENT_TYPE;\n\n\tlet type = vnode.type;\n\tlet props = vnode.props;\n\n\tif (type) {\n\t\t// Alias `class` prop to `className` if available\n\t\tif (props.class != props.className) {\n\t\t\tclassNameDescriptor.enumerable = 'className' in props;\n\t\t\tif (props.className != null) props.class = props.className;\n\t\t\tObject.defineProperty(props, 'className', classNameDescriptor);\n\t\t}\n\n\t\t// Apply DOM VNode compat\n\t\tif (typeof type != 'function') {\n\t\t\t// Apply defaultValue to value\n\t\t\tif (props.defaultValue && props.value !== undefined) {\n\t\t\t\tif (!props.value && props.value !== 0) {\n\t\t\t\t\tprops.value = props.defaultValue;\n\t\t\t\t}\n\t\t\t\tdelete props.defaultValue;\n\t\t\t}\n\n\t\t\t// Add support for array select values: <select value={[]} />\n\t\t\tif (Array.isArray(props.value) && props.multiple && type === 'select') {\n\t\t\t\ttoChildArray(props.children).forEach(child => {\n\t\t\t\t\tif (props.value.indexOf(child.props.value) != -1) {\n\t\t\t\t\t\tchild.props.selected = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdelete props.value;\n\t\t\t}\n\n\t\t\t// Normalize DOM vnode properties.\n\t\t\tlet shouldSanitize, attrs, i;\n\t\t\tfor (i in props) if ((shouldSanitize = CAMEL_PROPS.test(i))) break;\n\t\t\tif (shouldSanitize) {\n\t\t\t\tattrs = vnode.props = {};\n\t\t\t\tfor (i in props) {\n\t\t\t\t\tattrs[\n\t\t\t\t\t\tCAMEL_PROPS.test(i) ? i.replace(/[A-Z0-9]/, '-$&').toLowerCase() : i\n\t\t\t\t\t] = props[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Events\n\t\tapplyEventNormalization(vnode);\n\n\t\t// Component base class compat\n\t\t// We can't just patch the base component class, because components that use\n\t\t// inheritance and are transpiled down to ES5 will overwrite our patched\n\t\t// getters and setters. See #1941\n\t\tif (\n\t\t\ttypeof type == 'function' &&\n\t\t\t!type._patchedLifecycles &&\n\t\t\ttype.prototype\n\t\t) {\n\t\t\tsetSafeDescriptor(type.prototype, 'componentWillMount');\n\t\t\tsetSafeDescriptor(type.prototype, 'componentWillReceiveProps');\n\t\t\tsetSafeDescriptor(type.prototype, 'componentWillUpdate');\n\t\t\ttype._patchedLifecycles = true;\n\t\t}\n\t}\n\n\tif (oldVNodeHook) oldVNodeHook(vnode);\n};\n","/**\n * Normalize event handlers like react does. Most famously it uses `onChange` for any input element.\n * @param {import('./internal').VNode} vnode The vnode to normalize events on\n */\nexport function applyEventNormalization({ type, props }) {\n\tif (!props || typeof type != 'string') return;\n\tlet newProps = {};\n\n\tfor (let i in props) {\n\t\tif (/^on(Ani|Tra|Tou)/.test(i)) {\n\t\t\tprops[i.toLowerCase()] = props[i];\n\t\t\tdelete props[i];\n\t\t}\n\t\tnewProps[i.toLowerCase()] = i;\n\t}\n\tif (newProps.ondoubleclick) {\n\t\tprops.ondblclick = props[newProps.ondoubleclick];\n\t\tdelete props[newProps.ondoubleclick];\n\t}\n\tif (newProps.onbeforeinput) {\n\t\tprops.onbeforeinput = props[newProps.onbeforeinput];\n\t\tdelete props[newProps.onbeforeinput];\n\t}\n\t// for *textual inputs* (incl textarea), normalize `onChange` -> `onInput`:\n\tif (\n\t\tnewProps.onchange &&\n\t\t(type === 'textarea' ||\n\t\t\t(type.toLowerCase() === 'input' && !/^fil|che|ra/i.test(props.type)))\n\t) {\n\t\tlet normalized = newProps.oninput || 'oninput';\n\t\tif (!props[normalized]) {\n\t\t\tprops[normalized] = props[newProps.onchange];\n\t\t\tdelete props[newProps.onchange];\n\t\t}\n\t}\n}\n","// This is a very small application state management library.\n//\n// All it provides is a way of specifying state \"atoms\" (basically a value with\n// a setter and a way to be notified when the value updates), and a single\n// preact hook to manage the subscribe/unsubscribe process for you.\n//\n// At the moment, atoms are intended to be globally defined, but the system\n// could easily be adapted to pass down the atoms via context rather than being\n// globally available.\n//\n// To support complex data-types, you can either have simple functions that call\n// the public setter, or subclass Atom. So, for example, here are a few\n// different ways of making a list atom with convenient helpers:\n//\n// # Simple functions being passed atom\n//\n//     const myListAtom = new Atom<number[]>([], \"myList\")\n//     function push<T>(atom: Atom<T[]>, t: T) {\n//       const next = [...atom.get(), t]\n//       atom.set(next)\n//     }\n//     function removeLast<T>(atom: Atom<T[]>, t: T) {\n//       const next = [...atom.get()]\n//       next.pop()\n//       atom.set(next)\n//     }\n//\n//\n// # Simple functions operating on global atoms\n//\n//     const myListAtom = new Atom<number[]>([], \"myLisT\")\n//     function push(t: number) {\n//       myListAtom.set([...myListAtom.get(), t])\n//     }\n//     function removeLast() {\n//       const next = [...myListAtom.get()]\n//       myListAtom.set(next)\n//     }\n//\n//\n// # Subclassing\n//\n//     class ListAtom<T> extends Atom<T[]> {\n//        push(t: T) {\n//          const next = [...this.state, t]\n//          this.set(next)\n//        }\n//        removeLast() {\n//          const next = [...this.state]\n//          next.pop()\n//          this.set(next)\n//        }\n//     }\n//     const myListAtom = new ListAtom<number>([], \"myList\")\n//\n// This library is inspired by https://recoiljs.org/\n\nimport {useLayoutEffect, useState} from 'preact/hooks'\n\ntype AtomListener = () => void\n\nlet AtomDev: {[key: string]: Atom<any>} | null = null\nlet hotReloadStash: Map<string, any> | null = null\n\ndeclare const module: any\nif (process.env.NODE_ENV === 'development') {\n  ;(window as any)['Atom'] = AtomDev = {}\n\n  module.hot.dispose(() => {\n    if (AtomDev) {\n      hotReloadStash = new Map()\n      for (let key in AtomDev) {\n        hotReloadStash.set(key, AtomDev[key].get())\n      }\n    }\n\n    ;(window as any)['Atom_hotReloadStash'] = hotReloadStash\n  })\n\n  hotReloadStash = (window as any)['Atom_hotReloadStash'] || null\n}\n\nexport class Atom<T> {\n  private observers: AtomListener[] = []\n  constructor(protected state: T, debugKey: string) {\n    if (process.env.NODE_ENV === 'development') {\n      if (hotReloadStash?.has(debugKey)) {\n        // If we have a stored value from a previous hot reload, use that\n        // instead of whatever was passed to the constructor.\n        this.state = hotReloadStash.get(debugKey)\n      }\n\n      if (AtomDev) {\n        if (debugKey in AtomDev) {\n          console.warn(`[Atom] Multiple atoms tried to register with the key ${debugKey}`)\n        }\n        AtomDev[debugKey] = this\n      }\n    }\n\n    // We do the bind here rather than in the definition to facilitate\n    // inheritance (we want the value defined on both the prototype and the\n    // instance).\n    this.set = this.set.bind(this)\n    this.get = this.get.bind(this)\n  }\n\n  set(t: T) {\n    if (this.state === t) {\n      // No-op if the value didn't actually change\n      return\n    }\n    this.state = t\n    this.observers.forEach(fn => fn())\n  }\n\n  get(): T {\n    return this.state\n  }\n\n  subscribe(listener: AtomListener) {\n    this.observers.push(listener)\n  }\n\n  unsubscribe(listener: AtomListener) {\n    const index = this.observers.indexOf(listener)\n    if (index !== -1) {\n      this.observers.splice(index, 1)\n    }\n  }\n}\n\nexport function useAtom<T>(atom: Atom<T>): T {\n  const [value, setValue] = useState(atom.get())\n\n  useLayoutEffect(() => {\n    // We need to setValue here because it's possible something has changed the\n    // value in the store between the atom.get() call above and layout. In most\n    // cases this should no-op.\n    setValue(atom.get())\n\n    function listener() {\n      setValue(atom.get())\n    }\n\n    atom.subscribe(listener)\n    return () => {\n      atom.unsubscribe(listener)\n    }\n  }, [atom])\n\n  return value\n}\n","export const enum ViewMode {\n  CHRONO_FLAME_CHART,\n  LEFT_HEAVY_FLAME_GRAPH,\n  SANDWICH_VIEW,\n}\n","import {ViewMode} from '../lib/view-mode'\n\nexport interface HashParams {\n  profileURL?: string\n  title?: string\n  localProfilePath?: string\n  viewMode?: ViewMode\n}\n\nfunction getViewMode(value: string): ViewMode | null {\n  switch (value) {\n    case 'time-ordered':\n      return ViewMode.CHRONO_FLAME_CHART\n    case 'left-heavy':\n      return ViewMode.LEFT_HEAVY_FLAME_GRAPH\n    case 'sandwich':\n      return ViewMode.SANDWICH_VIEW\n    default:\n      return null\n  }\n}\n\nexport function getHashParams(hashContents = window.location.hash): HashParams {\n  try {\n    if (!hashContents.startsWith('#')) {\n      return {}\n    }\n    const components = hashContents.substr(1).split('&')\n    const result: HashParams = {}\n    for (const component of components) {\n      let [key, value] = component.split('=')\n      value = decodeURIComponent(value)\n      if (key === 'profileURL') {\n        result.profileURL = value\n      } else if (key === 'title') {\n        result.title = value\n      } else if (key === 'localProfilePath') {\n        result.localProfilePath = value\n      } else if (key === 'view') {\n        const mode = getViewMode(value)\n        if (mode !== null) {\n          result.viewMode = mode\n        } else {\n          console.error(`Ignoring invalid view specifier: ${value}`)\n        }\n      }\n    }\n    return result\n  } catch (e) {\n    console.error(`Error when loading hash fragment.`)\n    console.error(e)\n    return {}\n  }\n}\n","import {Atom} from '../lib/atom'\nimport {Rect, Vec2} from '../lib/math'\nimport {CallTreeNode, Frame, Profile, ProfileGroup} from '../lib/profile'\nimport {objectsHaveShallowEquality} from '../lib/utils'\n\nexport interface FlamechartViewState {\n  hover: {\n    node: CallTreeNode\n    event: MouseEvent\n  } | null\n  selectedNode: CallTreeNode | null\n  logicalSpaceViewportSize: Vec2\n  configSpaceViewportRect: Rect\n}\n\nexport interface CallerCalleeState {\n  selectedFrame: Frame\n  invertedCallerFlamegraph: FlamechartViewState\n  calleeFlamegraph: FlamechartViewState\n}\n\nexport interface SandwichViewState {\n  callerCallee: CallerCalleeState | null\n}\n\nexport interface ProfileState {\n  profile: Profile\n  chronoViewState: FlamechartViewState\n  leftHeavyViewState: FlamechartViewState\n  sandwichViewState: SandwichViewState\n}\n\nexport type ProfileGroupState = {\n  name: string\n\n  profile: ProfileState\n} | null\n\nexport enum FlamechartID {\n  LEFT_HEAVY = 'LEFT_HEAVY',\n  CHRONO = 'CHRONO',\n  SANDWICH_INVERTED_CALLERS = 'SANDWICH_INVERTED_CALLERS',\n  SANDWICH_CALLEES = 'SANDWICH_CALLEES',\n}\n\nlet initialFlameChartViewState: FlamechartViewState = {\n  hover: null,\n  selectedNode: null,\n  configSpaceViewportRect: Rect.empty,\n  logicalSpaceViewportSize: Vec2.zero,\n}\n\nexport class ProfileGroupAtom extends Atom<ProfileGroupState> {\n  set(newState: ProfileGroupState) {\n    const oldState = this.state\n    if (oldState != null && newState != null && objectsHaveShallowEquality(oldState, newState)) {\n      return\n    }\n    super.set(newState)\n  }\n\n  getActiveProfile(): ProfileState | null {\n    if (this.state == null) return null\n    return this.state.profile;\n  }\n\n  setProfileGroup = (group: ProfileGroup) => {\n    const p = group.profile;\n    console.log(this.state?.profile.chronoViewState);\n    this.set({\n      name: group.name,\n      profile: {\n        profile: p,\n        chronoViewState: this.state?.profile.chronoViewState || initialFlameChartViewState,\n        leftHeavyViewState: this.state?.profile.leftHeavyViewState || initialFlameChartViewState,\n        sandwichViewState: {callerCallee: null},\n      },\n    })\n  }\n\n  private updateActiveProfileState(fn: (profileState: ProfileState) => ProfileState) {\n    if (this.state == null) return\n    this.set({\n      ...this.state,\n      profile: fn(this.state.profile),\n    })\n  }\n\n  private updateActiveSandwichViewState(\n    fn: (sandwichViewState: SandwichViewState) => SandwichViewState,\n  ) {\n    this.updateActiveProfileState(p => ({\n      ...p,\n      sandwichViewState: fn(p.sandwichViewState),\n    }))\n  }\n\n  setSelectedFrame = (frame: Frame | null) => {\n    if (this.state == null) return\n\n    const profile = this.getActiveProfile()\n    if (profile == null) {\n      return\n    }\n\n    this.updateActiveSandwichViewState(sandwichViewState => {\n      if (frame == null) {\n        return {callerCallee: null}\n      }\n      return {\n        callerCallee: {\n          invertedCallerFlamegraph: initialFlameChartViewState,\n          calleeFlamegraph: initialFlameChartViewState,\n          selectedFrame: frame,\n        },\n      }\n    })\n  }\n\n  private updateFlamechartState(\n    id: FlamechartID,\n    fn: (flamechartViewState: FlamechartViewState) => FlamechartViewState,\n  ) {\n    switch (id) {\n      case FlamechartID.CHRONO: {\n        this.updateActiveProfileState(p => ({\n          ...p,\n          chronoViewState: fn(p.chronoViewState),\n        }))\n        break\n      }\n\n      case FlamechartID.LEFT_HEAVY: {\n        this.updateActiveProfileState(p => ({\n          ...p,\n          leftHeavyViewState: fn(p.leftHeavyViewState),\n        }))\n        break\n      }\n\n      case FlamechartID.SANDWICH_CALLEES: {\n        this.updateActiveSandwichViewState(s => ({\n          ...s,\n          callerCallee:\n            s.callerCallee == null\n              ? null\n              : {\n                  ...s.callerCallee,\n                  calleeFlamegraph: fn(s.callerCallee.calleeFlamegraph),\n                },\n        }))\n        break\n      }\n\n      case FlamechartID.SANDWICH_INVERTED_CALLERS: {\n        this.updateActiveSandwichViewState(s => ({\n          ...s,\n          callerCallee:\n            s.callerCallee == null\n              ? null\n              : {\n                  ...s.callerCallee,\n                  invertedCallerFlamegraph: fn(s.callerCallee.invertedCallerFlamegraph),\n                },\n        }))\n        break\n      }\n    }\n  }\n\n  setFlamechartHoveredNode(\n    id: FlamechartID,\n    hover: {node: CallTreeNode; event: MouseEvent} | null,\n  ) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      hover,\n    }))\n  }\n\n  setSelectedNode(id: FlamechartID, selectedNode: CallTreeNode | null) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      selectedNode,\n    }))\n  }\n\n  setConfigSpaceViewportRect(id: FlamechartID, configSpaceViewportRect: Rect) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      configSpaceViewportRect,\n    }))\n  }\n\n  setLogicalSpaceViewportSize(id: FlamechartID, logicalSpaceViewportSize: Vec2) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      logicalSpaceViewportSize,\n    }))\n  }\n\n  clearHoverNode() {\n    // TODO(jlfwong): This causes 4 separate observer events. This is probably\n    // fine, since I hope that Preact/React are smart about batching re-renders?\n    this.setFlamechartHoveredNode(FlamechartID.CHRONO, null)\n    this.setFlamechartHoveredNode(FlamechartID.LEFT_HEAVY, null)\n    this.setFlamechartHoveredNode(FlamechartID.SANDWICH_CALLEES, null)\n    this.setFlamechartHoveredNode(FlamechartID.SANDWICH_INVERTED_CALLERS, null)\n  }\n}\n","import {Atom} from '../lib/atom'\nimport {ViewMode} from '../lib/view-mode'\nimport {getHashParams, HashParams} from '../lib/hash-params'\nimport {ProfileGroupAtom} from './profile-group'\n\n// True if recursion should be flattened when viewing flamegraphs\nexport const flattenRecursionAtom = new Atom<boolean>(false, 'flattenRecursion')\n\n// The query used in top-level views\n//\n// An empty string indicates that the search is open by no filter is applied.\n// searchIsActive is stored separately, because we may choose to persist the\n// query even when the search input is closed.\nexport const searchIsActiveAtom = new Atom<boolean>(false, 'searchIsActive')\nexport const searchQueryAtom = new Atom<string>('', 'searchQueryAtom')\n\n// Which top-level view should be displayed\nexport const viewModeAtom = new Atom<ViewMode>(ViewMode.CHRONO_FLAME_CHART, 'viewMode')\n\n// The top-level profile group from which most other data will be derived\nexport const profileGroupAtom = new ProfileGroupAtom(null, 'profileGroup')\n\nviewModeAtom.subscribe(() => {\n  // If we switch views, the hover information is no longer relevant\n  profileGroupAtom.clearHoverNode()\n})\n\n// Parameters defined by the URL encoded k=v pairs after the # in the URL\nconst hashParams = getHashParams()\nexport const hashParamsAtom = new Atom<HashParams>(hashParams, 'hashParams')\n\n// The <canvas> element used for WebGL\nexport const glCanvasAtom = new Atom<HTMLCanvasElement | null>(null, 'glCanvas')\n\n// True when a file drag is currently active. Used to indicate that the\n// application is a valid drop target.\nexport const dragActiveAtom = new Atom<boolean>(false, 'dragActive')\n\n// True when the application is currently in a loading state. Used to\n// display a loading progress bar.\n\n// Speedscope is usable both from a local HTML file being served\n// from a file:// URL, and via websites. In the case of file:// URLs,\n// however, XHR will be unavailable to fetching files in adjacent directories.\nconst protocol = window.location.protocol\nexport const canUseXHR = protocol === 'http:' || protocol === 'https:'\nconst isImmediatelyLoading = canUseXHR && hashParams.profileURL != null\nexport const loadingAtom = new Atom<boolean>(isImmediatelyLoading, 'loading')\n\n// True when the application is an error state, e.g. because the profile\n// imported was invalid.\nexport const errorAtom = new Atom<boolean>(false, 'error')\n\nexport enum SortField {\n  SYMBOL_NAME,\n  SELF,\n  TOTAL,\n}\n\nexport enum SortDirection {\n  ASCENDING,\n  DESCENDING,\n}\n\nexport interface SortMethod {\n  field: SortField\n  direction: SortDirection\n}\n\n// The table sorting method using for the sandwich view, specifying the column\n// to sort by, and the direction to sort that clumn.\nexport const tableSortMethodAtom = new Atom<SortMethod>(\n  {\n    field: SortField.SELF,\n    direction: SortDirection.DESCENDING,\n  },\n  'tableSortMethod',\n)\n","import {Profile} from '../lib/profile'\nimport {getProfileToView} from './getters'\nimport {flattenRecursionAtom, profileGroupAtom} from '.'\nimport {FlamechartViewState, SandwichViewState} from './profile-group'\nimport {useAtom} from '../lib/atom'\n\nexport interface ApplicationState {}\n\nexport interface ActiveProfileState {\n  profile: Profile\n  chronoViewState: FlamechartViewState\n  leftHeavyViewState: FlamechartViewState\n  sandwichViewState: SandwichViewState\n}\n\nexport function useActiveProfileState(): ActiveProfileState | null {\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const profileGroupState = useAtom(profileGroupAtom)\n\n  if (!profileGroupState) return null\n  const profileState = profileGroupState.profile;\n  return {\n    ...profileGroupState.profile,\n    profile: getProfileToView({\n      profile: profileState.profile,\n      flattenRecursion,\n    }),\n  }\n}\n","import {Atom} from '../lib/atom'\n\nexport const enum ColorScheme {\n  // Default: respect prefers-color-schema\n  SYSTEM,\n\n  // Use dark theme\n  DARK,\n\n  // use light theme\n  LIGHT,\n}\n\nconst localStorageKey = 'speedscope-color-scheme'\n\nfunction getStoredPreference(): ColorScheme {\n  const storedPreference = window.localStorage && window.localStorage[localStorageKey]\n  if (storedPreference === 'DARK') {\n    return ColorScheme.DARK\n  } else if (storedPreference === 'LIGHT') {\n    return ColorScheme.LIGHT\n  } else {\n    return ColorScheme.SYSTEM\n  }\n}\n\nfunction matchMediaDarkColorScheme(): MediaQueryList {\n  return matchMedia('(prefers-color-scheme: dark)')\n}\n\nfunction nextColorScheme(scheme: ColorScheme): ColorScheme {\n  const systemPrefersDarkMode = matchMediaDarkColorScheme().matches\n\n  // We'll use a different cycling order for changing the color scheme depending\n  // on what the *current* system preference is. This should guarantee that when\n  // a user interacts with the color scheme toggle for the first time, it always\n  // changes the color scheme.\n  if (systemPrefersDarkMode) {\n    switch (scheme) {\n      case ColorScheme.SYSTEM: {\n        return ColorScheme.LIGHT\n      }\n      case ColorScheme.LIGHT: {\n        return ColorScheme.DARK\n      }\n      case ColorScheme.DARK: {\n        return ColorScheme.SYSTEM\n      }\n    }\n  } else {\n    switch (scheme) {\n      case ColorScheme.SYSTEM: {\n        return ColorScheme.DARK\n      }\n      case ColorScheme.DARK: {\n        return ColorScheme.LIGHT\n      }\n      case ColorScheme.LIGHT: {\n        return ColorScheme.SYSTEM\n      }\n    }\n  }\n}\n\nclass ColorSchemeAtom extends Atom<ColorScheme> {\n  cycleToNextColorScheme = () => {\n    this.set(nextColorScheme(this.get()))\n  }\n}\n\nexport const colorSchemeAtom = new ColorSchemeAtom(getStoredPreference(), 'colorScheme')\n\ncolorSchemeAtom.subscribe(() => {\n  const value = colorSchemeAtom.get()\n\n  switch (value) {\n    case ColorScheme.DARK: {\n      window.localStorage[localStorageKey] = 'DARK'\n      break\n    }\n    case ColorScheme.LIGHT: {\n      window.localStorage[localStorageKey] = 'LIGHT'\n      break\n    }\n    case ColorScheme.SYSTEM: {\n      delete window.localStorage[localStorageKey]\n      break\n    }\n    default: {\n      const _exhaustiveCheck: never = value\n      return _exhaustiveCheck\n    }\n  }\n  return value\n})\n","import {Color} from '../../lib/color'\nimport {triangle} from '../../lib/utils'\nimport {Theme} from './theme'\n\n// These colors are intentionally not exported from this file, because these\n// colors are theme specific, and we want all color values to come from the\n// active theme.\nenum Colors {\n  LIGHTER_GRAY = '#D0D0D0',\n  LIGHT_GRAY = '#BDBDBD',\n  GRAY = '#666666',\n  DARK_GRAY = '#222222',\n  DARKER_GRAY = '#0C0C0C',\n  OFF_BLACK = '#060606',\n  BLACK = '#000000',\n  BLUE = '#00769B',\n  PALE_BLUE = '#004E75',\n  GREEN = '#0F8A42',\n  LIGHT_BROWN = '#D6AE24',\n  BROWN = '#A66F1C',\n}\n\nconst C_0 = 0.2\nconst C_d = 0.1\nconst L_0 = 0.2\nconst L_d = 0.1\n\nconst colorForBucket = (t: number) => {\n  const x = triangle(30.0 * t)\n  const H = 360.0 * (0.9 * t)\n  const C = C_0 + C_d * x\n  const L = L_0 - L_d * x\n  return Color.fromLumaChromaHue(L, C, H)\n}\nconst colorForBucketGLSL = `\n  vec3 colorForBucket(float t) {\n    float x = triangle(30.0 * t);\n    float H = 360.0 * (0.9 * t);\n    float C = ${C_0.toFixed(1)} + ${C_d.toFixed(1)} * x;\n    float L = ${L_0.toFixed(1)} - ${L_d.toFixed(1)} * x;\n    return hcl2rgb(H, C, L);\n  }\n`\n\nexport const darkTheme: Theme = {\n  fgPrimaryColor: Colors.LIGHTER_GRAY,\n  fgSecondaryColor: Colors.GRAY,\n\n  bgPrimaryColor: Colors.OFF_BLACK,\n  bgSecondaryColor: Colors.DARKER_GRAY,\n\n  altFgPrimaryColor: Colors.LIGHTER_GRAY,\n  altFgSecondaryColor: Colors.GRAY,\n\n  altBgPrimaryColor: Colors.BLACK,\n  altBgSecondaryColor: Colors.DARKER_GRAY,\n\n  selectionPrimaryColor: Colors.BLUE,\n  selectionSecondaryColor: Colors.PALE_BLUE,\n\n  weightColor: Colors.GREEN,\n\n  searchMatchTextColor: Colors.DARKER_GRAY,\n  searchMatchPrimaryColor: Colors.BROWN,\n  searchMatchSecondaryColor: Colors.LIGHT_BROWN,\n\n  colorForBucket,\n  colorForBucketGLSL,\n}\n","import {Color} from '../../lib/color'\nimport {triangle} from '../../lib/utils'\nimport {Theme} from './theme'\n\n// These colors are intentionally not exported from this file, because these\n// colors are theme specific, and we want all color values to come from the\n// active theme.\nenum Colors {\n  WHITE = '#FFFFFF',\n  OFF_WHITE = '#F6F6F6',\n  LIGHT_GRAY = '#BDBDBD',\n  GRAY = '#666666',\n  DARK_GRAY = '#222222',\n  OFF_BLACK = '#111111',\n  BLACK = '#000000',\n  DARK_BLUE = '#2F80ED',\n  PALE_DARK_BLUE = '#8EB7ED',\n  GREEN = '#6FCF97',\n  YELLOW = '#FEDC62',\n  ORANGE = '#FFAC02',\n}\n\nconst C_0 = 0.25\nconst C_d = 0.2\nconst L_0 = 0.8\nconst L_d = 0.15\n\nconst colorForBucket = (t: number) => {\n  const x = triangle(30.0 * t)\n  const H = 360.0 * (0.9 * t)\n  const C = C_0 + C_d * x\n  const L = L_0 - L_d * x\n  return Color.fromLumaChromaHue(L, C, H)\n}\nconst colorForBucketGLSL = `\n  vec3 colorForBucket(float t) {\n    float x = triangle(30.0 * t);\n    float H = 360.0 * (0.9 * t);\n    float C = ${C_0.toFixed(1)} + ${C_d.toFixed(1)} * x;\n    float L = ${L_0.toFixed(1)} - ${L_d.toFixed(1)} * x;\n    return hcl2rgb(H, C, L);\n  }\n`\n\nexport const lightTheme: Theme = {\n  fgPrimaryColor: Colors.BLACK,\n  fgSecondaryColor: Colors.LIGHT_GRAY,\n\n  bgPrimaryColor: Colors.WHITE,\n  bgSecondaryColor: Colors.OFF_WHITE,\n\n  altFgPrimaryColor: Colors.WHITE,\n  altFgSecondaryColor: Colors.LIGHT_GRAY,\n\n  altBgPrimaryColor: Colors.BLACK,\n  altBgSecondaryColor: Colors.DARK_GRAY,\n\n  selectionPrimaryColor: Colors.DARK_BLUE,\n  selectionSecondaryColor: Colors.PALE_DARK_BLUE,\n\n  weightColor: Colors.GREEN,\n\n  searchMatchTextColor: Colors.BLACK,\n  searchMatchPrimaryColor: Colors.ORANGE,\n  searchMatchSecondaryColor: Colors.YELLOW,\n\n  colorForBucket,\n  colorForBucketGLSL,\n}\n","import {h, ComponentChildren, createContext} from 'preact'\nimport {useCallback, useContext, useEffect, useState} from 'preact/hooks'\nimport {ColorScheme, colorSchemeAtom} from '../../app-state/color-scheme'\nimport {useAtom} from '../../lib/atom'\nimport {Color} from '../../lib/color'\nimport {memoizeByReference} from '../../lib/utils'\nimport {darkTheme} from './dark-theme'\nimport {lightTheme} from './light-theme'\n\nexport interface Theme {\n  fgPrimaryColor: string\n  fgSecondaryColor: string\n  bgPrimaryColor: string\n  bgSecondaryColor: string\n\n  altFgPrimaryColor: string\n  altFgSecondaryColor: string\n  altBgPrimaryColor: string\n  altBgSecondaryColor: string\n\n  selectionPrimaryColor: string\n  selectionSecondaryColor: string\n\n  weightColor: string\n\n  searchMatchTextColor: string\n  searchMatchPrimaryColor: string\n  searchMatchSecondaryColor: string\n\n  colorForBucket: (t: number) => Color\n  colorForBucketGLSL: string\n}\n\nexport const ThemeContext = createContext<Theme>(lightTheme)\n\nexport function useTheme(): Theme {\n  return useContext(ThemeContext)\n}\n\nexport function withTheme<T>(cb: (theme: Theme) => T) {\n  return memoizeByReference(cb)\n}\n\nfunction matchMediaDarkColorScheme(): MediaQueryList {\n  return matchMedia('(prefers-color-scheme: dark)')\n}\n\nexport function colorSchemeToString(scheme: ColorScheme): string {\n  switch (scheme) {\n    case ColorScheme.SYSTEM: {\n      return 'System'\n    }\n    case ColorScheme.DARK: {\n      return 'Dark'\n    }\n    case ColorScheme.LIGHT: {\n      return 'Light'\n    }\n  }\n}\n\nfunction getTheme(colorScheme: ColorScheme, systemPrefersDarkMode: boolean) {\n  switch (colorScheme) {\n    case ColorScheme.SYSTEM: {\n      return systemPrefersDarkMode ? darkTheme : lightTheme\n    }\n    case ColorScheme.DARK: {\n      return darkTheme\n    }\n    case ColorScheme.LIGHT: {\n      return lightTheme\n    }\n  }\n}\n\nexport function ThemeProvider(props: {children: ComponentChildren}) {\n  const [systemPrefersDarkMode, setSystemPrefersDarkMode] = useState(\n    () => matchMediaDarkColorScheme().matches,\n  )\n\n  const matchMediaListener = useCallback(\n    (event: MediaQueryListEvent) => {\n      setSystemPrefersDarkMode(event.matches)\n    },\n    [setSystemPrefersDarkMode],\n  )\n\n  useEffect(() => {\n    const media = matchMediaDarkColorScheme()\n    media.addEventListener('change', matchMediaListener)\n    return () => {\n      media.removeEventListener('change', matchMediaListener)\n    }\n  }, [matchMediaListener])\n\n  const colorScheme = useAtom(colorSchemeAtom)\n  const theme = getTheme(colorScheme, systemPrefersDarkMode)\n  return <ThemeContext.Provider value={theme} children={props.children} />\n}\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = calc;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\nfunction calc(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"calc(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/calc\\(/g, prefix + \"calc(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isPrefixedValue;\nvar regex = /-webkit-|-moz-|-ms-/;\n\nfunction isPrefixedValue(value) {\n  return typeof value === 'string' && regex.test(value);\n}\nmodule.exports = exports['default'];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = crossFade;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#search=cross-fade\nvar prefixes = [\"-webkit-\", \"\"];\nfunction crossFade(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"cross-fade(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/cross-fade\\(/g, prefix + \"cross-fade(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = cursor;\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar values = {\n  \"zoom-in\": true,\n  \"zoom-out\": true,\n  grab: true,\n  grabbing: true\n};\n\nfunction cursor(property, value) {\n  if (property === \"cursor\" && values.hasOwnProperty(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = filter;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#feat=css-filter-function\nvar prefixes = [\"-webkit-\", \"\"];\nfunction filter(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"filter(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/filter\\(/g, prefix + \"filter(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flex;\nvar values = {\n  flex: [\"-webkit-box\", \"-moz-box\", \"-ms-flexbox\", \"-webkit-flex\", \"flex\"],\n  \"inline-flex\": [\"-webkit-inline-box\", \"-moz-inline-box\", \"-ms-inline-flexbox\", \"-webkit-inline-flex\", \"inline-flex\"]\n};\n\nfunction flex(property, value) {\n  if (property === \"display\" && values.hasOwnProperty(value)) {\n    return values[value];\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flexboxIE;\nvar alternativeValues = {\n  \"space-around\": \"distribute\",\n  \"space-between\": \"justify\",\n  \"flex-start\": \"start\",\n  \"flex-end\": \"end\"\n};\nvar alternativeProps = {\n  alignContent: \"msFlexLinePack\",\n  alignSelf: \"msFlexItemAlign\",\n  alignItems: \"msFlexAlign\",\n  justifyContent: \"msFlexPack\",\n  order: \"msFlexOrder\",\n  flexGrow: \"msFlexPositive\",\n  flexShrink: \"msFlexNegative\",\n  flexBasis: \"msFlexPreferredSize\"\n};\n\nfunction flexboxIE(property, value, style) {\n  if (alternativeProps.hasOwnProperty(property)) {\n    style[alternativeProps[property]] = alternativeValues[value] || value;\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flexboxOld;\nvar alternativeValues = {\n  \"space-around\": \"justify\",\n  \"space-between\": \"justify\",\n  \"flex-start\": \"start\",\n  \"flex-end\": \"end\",\n  \"wrap-reverse\": \"multiple\",\n  wrap: \"multiple\"\n};\n\nvar alternativeProps = {\n  alignItems: \"WebkitBoxAlign\",\n  justifyContent: \"WebkitBoxPack\",\n  flexWrap: \"WebkitBoxLines\"\n};\n\nfunction flexboxOld(property, value, style) {\n  if (property === \"flexDirection\" && typeof value === \"string\") {\n    if (value.indexOf(\"column\") > -1) {\n      style.WebkitBoxOrient = \"vertical\";\n    } else {\n      style.WebkitBoxOrient = \"horizontal\";\n    }\n    if (value.indexOf(\"reverse\") > -1) {\n      style.WebkitBoxDirection = \"reverse\";\n    } else {\n      style.WebkitBoxDirection = \"normal\";\n    }\n  }\n  if (alternativeProps.hasOwnProperty(property)) {\n    style[alternativeProps[property]] = alternativeValues[value] || value;\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = gradient;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar values = /linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;\n\nfunction gradient(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && values.test(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = imageSet;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#feat=css-image-set\nvar prefixes = [\"-webkit-\", \"\"];\nfunction imageSet(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"image-set(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/image-set\\(/g, prefix + \"image-set(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = position;\nfunction position(property, value) {\n  if (property === \"position\" && value === \"sticky\") {\n    return [\"-webkit-sticky\", \"sticky\"];\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = sizing;\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar properties = {\n  maxHeight: true,\n  maxWidth: true,\n  width: true,\n  height: true,\n  columnWidth: true,\n  minWidth: true,\n  minHeight: true\n};\nvar values = {\n  \"min-content\": true,\n  \"max-content\": true,\n  \"fill-available\": true,\n  \"fit-content\": true,\n  \"contain-floats\": true\n};\n\nfunction sizing(property, value) {\n  if (properties.hasOwnProperty(property) && values.hasOwnProperty(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = transition;\n\nvar _hyphenateProperty = require(\"css-in-js-utils/lib/hyphenateProperty\");\n\nvar _hyphenateProperty2 = _interopRequireDefault(_hyphenateProperty);\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nvar _capitalizeString = require(\"../../utils/capitalizeString\");\n\nvar _capitalizeString2 = _interopRequireDefault(_capitalizeString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar properties = {\n  transition: true,\n  transitionProperty: true,\n  WebkitTransition: true,\n  WebkitTransitionProperty: true,\n  MozTransition: true,\n  MozTransitionProperty: true\n};\n\n\nvar prefixMapping = {\n  Webkit: \"-webkit-\",\n  Moz: \"-moz-\",\n  ms: \"-ms-\"\n};\n\nfunction prefixValue(value, propertyPrefixMap) {\n  if ((0, _isPrefixedValue2.default)(value)) {\n    return value;\n  }\n\n  // only split multi values, not cubic beziers\n  var multipleValues = value.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g);\n\n  for (var i = 0, len = multipleValues.length; i < len; ++i) {\n    var singleValue = multipleValues[i];\n    var values = [singleValue];\n    for (var property in propertyPrefixMap) {\n      var dashCaseProperty = (0, _hyphenateProperty2.default)(property);\n\n      if (singleValue.indexOf(dashCaseProperty) > -1 && dashCaseProperty !== \"order\") {\n        var prefixes = propertyPrefixMap[property];\n        for (var j = 0, pLen = prefixes.length; j < pLen; ++j) {\n          // join all prefixes and create a new value\n          values.unshift(singleValue.replace(dashCaseProperty, prefixMapping[prefixes[j]] + dashCaseProperty));\n        }\n      }\n    }\n\n    multipleValues[i] = values.join(\",\");\n  }\n\n  return multipleValues.join(\",\");\n}\n\nfunction transition(property, value, style, propertyPrefixMap) {\n  // also check for already prefixed transitions\n  if (typeof value === \"string\" && properties.hasOwnProperty(property)) {\n    var outputValue = prefixValue(value, propertyPrefixMap);\n    // if the property is already prefixed\n    var webkitOutput = outputValue.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g).filter(function (val) {\n      return !/-moz-|-ms-/.test(val);\n    }).join(\",\");\n\n    if (property.indexOf(\"Webkit\") > -1) {\n      return webkitOutput;\n    }\n\n    var mozOutput = outputValue.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g).filter(function (val) {\n      return !/-webkit-|-ms-/.test(val);\n    }).join(\",\");\n\n    if (property.indexOf(\"Moz\") > -1) {\n      return mozOutput;\n    }\n\n    style[\"Webkit\" + (0, _capitalizeString2.default)(property)] = webkitOutput;\n    style[\"Moz\" + (0, _capitalizeString2.default)(property)] = mozOutput;\n    return outputValue;\n  }\n}\nmodule.exports = exports[\"default\"];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = hyphenateProperty;\n\nvar _hyphenateStyleName = require('hyphenate-style-name');\n\nvar _hyphenateStyleName2 = _interopRequireDefault(_hyphenateStyleName);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction hyphenateProperty(property) {\n  return (0, _hyphenateStyleName2.default)(property);\n}\nmodule.exports = exports['default'];","'use strict';\n\nvar uppercasePattern = /[A-Z]/g;\nvar msPattern = /^ms-/;\nvar cache = {};\n\nfunction hyphenateStyleName(string) {\n    return string in cache\n    ? cache[string]\n    : cache[string] = string\n      .replace(uppercasePattern, '-$&')\n      .toLowerCase()\n      .replace(msPattern, '-ms-');\n}\n\nmodule.exports = hyphenateStyleName;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = capitalizeString;\nfunction capitalizeString(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nfunction hash(str) {\n  var hash = 5381,\n      i    = str.length;\n\n  while(i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */\n  return hash >>> 0;\n}\n\nmodule.exports = hash;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = createPrefixer;\n\nvar _prefixProperty = require(\"../utils/prefixProperty\");\n\nvar _prefixProperty2 = _interopRequireDefault(_prefixProperty);\n\nvar _prefixValue = require(\"../utils/prefixValue\");\n\nvar _prefixValue2 = _interopRequireDefault(_prefixValue);\n\nvar _addNewValuesOnly = require(\"../utils/addNewValuesOnly\");\n\nvar _addNewValuesOnly2 = _interopRequireDefault(_addNewValuesOnly);\n\nvar _isObject = require(\"../utils/isObject\");\n\nvar _isObject2 = _interopRequireDefault(_isObject);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction createPrefixer(_ref) {\n  var prefixMap = _ref.prefixMap,\n      plugins = _ref.plugins;\n\n  function prefixAll(style) {\n    for (var property in style) {\n      var value = style[property];\n\n      // handle nested objects\n      if ((0, _isObject2.default)(value)) {\n        style[property] = prefixAll(value);\n        // handle array values\n      } else if (Array.isArray(value)) {\n        var combinedValue = [];\n\n        for (var i = 0, len = value.length; i < len; ++i) {\n          var processedValue = (0, _prefixValue2.default)(plugins, property, value[i], style, prefixMap);\n          (0, _addNewValuesOnly2.default)(combinedValue, processedValue || value[i]);\n        }\n\n        // only modify the value if it was touched\n        // by any plugin to prevent unnecessary mutations\n        if (combinedValue.length > 0) {\n          style[property] = combinedValue;\n        }\n      } else {\n        var _processedValue = (0, _prefixValue2.default)(plugins, property, value, style, prefixMap);\n\n        // only modify the value if it was touched\n        // by any plugin to prevent unnecessary mutations\n        if (_processedValue) {\n          style[property] = _processedValue;\n        }\n\n        style = (0, _prefixProperty2.default)(prefixMap, property, style);\n      }\n    }\n\n    return style;\n  }\n\n  return prefixAll;\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = prefixProperty;\n\nvar _capitalizeString = require(\"./capitalizeString\");\n\nvar _capitalizeString2 = _interopRequireDefault(_capitalizeString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction prefixProperty(prefixProperties, property, style) {\n  if (prefixProperties.hasOwnProperty(property)) {\n    var newStyle = {};\n    var requiredPrefixes = prefixProperties[property];\n    var capitalizedProperty = (0, _capitalizeString2.default)(property);\n    var keys = Object.keys(style);\n    for (var i = 0; i < keys.length; i++) {\n      var styleProperty = keys[i];\n      if (styleProperty === property) {\n        for (var j = 0; j < requiredPrefixes.length; j++) {\n          newStyle[requiredPrefixes[j] + capitalizedProperty] = style[property];\n        }\n      }\n      newStyle[styleProperty] = style[styleProperty];\n    }\n    return newStyle;\n  }\n  return style;\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = prefixValue;\nfunction prefixValue(plugins, property, value, style, metaData) {\n  for (var i = 0, len = plugins.length; i < len; ++i) {\n    var processedValue = plugins[i](property, value, style, metaData);\n\n    // we can stop processing if a value is returned\n    // as all plugin criteria are unique\n    if (processedValue) {\n      return processedValue;\n    }\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = addNewValuesOnly;\nfunction addIfNew(list, value) {\n  if (list.indexOf(value) === -1) {\n    list.push(value);\n  }\n}\n\nfunction addNewValuesOnly(list, values) {\n  if (Array.isArray(values)) {\n    for (var i = 0, len = values.length; i < len; ++i) {\n      addIfNew(list, values[i]);\n    }\n  } else {\n    addIfNew(list, values);\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isObject;\nfunction isObject(value) {\n  return value instanceof Object && !Array.isArray(value);\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\n// Use the fastest means possible to execute a task in its own turn, with\n// priority over other events including IO, animation, reflow, and redraw\n// events in browsers.\n//\n// An exception thrown by a task will permanently interrupt the processing of\n// subsequent tasks. The higher level `asap` function ensures that if an\n// exception is thrown by a task, that the task queue will continue flushing as\n// soon as possible, but if you use `rawAsap` directly, you are responsible to\n// either ensure that no exceptions are thrown from your task, or to manually\n// call `rawAsap.requestFlush` if an exception is thrown.\nmodule.exports = rawAsap;\nfunction rawAsap(task) {\n    if (!queue.length) {\n        requestFlush();\n        flushing = true;\n    }\n    // Equivalent to push, but avoids a function call.\n    queue[queue.length] = task;\n}\n\nvar queue = [];\n// Once a flush has been requested, no further calls to `requestFlush` are\n// necessary until the next `flush` completes.\nvar flushing = false;\n// `requestFlush` is an implementation-specific method that attempts to kick\n// off a `flush` event as quickly as possible. `flush` will attempt to exhaust\n// the event queue before yielding to the browser's own event loop.\nvar requestFlush;\n// The position of the next task to execute in the task queue. This is\n// preserved between calls to `flush` so that it can be resumed if\n// a task throws an exception.\nvar index = 0;\n// If a task schedules additional tasks recursively, the task queue can grow\n// unbounded. To prevent memory exhaustion, the task queue will periodically\n// truncate already-completed tasks.\nvar capacity = 1024;\n\n// The flush function processes all tasks that have been scheduled with\n// `rawAsap` unless and until one of those tasks throws an exception.\n// If a task throws an exception, `flush` ensures that its state will remain\n// consistent and will resume where it left off when called again.\n// However, `flush` does not make any arrangements to be called again if an\n// exception is thrown.\nfunction flush() {\n    while (index < queue.length) {\n        var currentIndex = index;\n        // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n        index = index + 1;\n        queue[currentIndex].call();\n        // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n        if (index > capacity) {\n            // Manually shift all values starting at the index back to the\n            // beginning of the queue.\n            for (var scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n                queue[scan] = queue[scan + index];\n            }\n            queue.length -= index;\n            index = 0;\n        }\n    }\n    queue.length = 0;\n    index = 0;\n    flushing = false;\n}\n\n// `requestFlush` is implemented using a strategy based on data collected from\n// every available SauceLabs Selenium web driver worker at time of writing.\n// https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\nvar scope = typeof global !== \"undefined\" ? global : self;\nvar BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\n\n// MutationObservers are desirable because they have high priority and work\n// reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nif (typeof BrowserMutationObserver === \"function\") {\n    requestFlush = makeRequestCallFromMutationObserver(flush);\n\n// MessageChannels are desirable because they give direct access to the HTML\n// task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\n} else {\n    requestFlush = makeRequestCallFromTimer(flush);\n}\n\n// `requestFlush` requests that the high priority event queue be flushed as\n// soon as possible.\n// This is useful to prevent an error thrown in a task from stalling the event\n// queue if the exception handled by Node.js’s\n// `process.on(\"uncaughtException\")` or by a domain.\nrawAsap.requestFlush = requestFlush;\n\n// To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\nfunction makeRequestCallFromMutationObserver(callback) {\n    var toggle = 1;\n    var observer = new BrowserMutationObserver(callback);\n    var node = document.createTextNode(\"\");\n    observer.observe(node, {characterData: true});\n    return function requestCall() {\n        toggle = -toggle;\n        node.data = toggle;\n    };\n}\n\n// The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n\nfunction makeRequestCallFromTimer(callback) {\n    return function requestCall() {\n        // We dispatch a timeout with a specified delay of 0 for engines that\n        // can reliably accommodate that request. This will usually be snapped\n        // to a 4 milisecond delay, but once we're flushing, there's no delay\n        // between events.\n        var timeoutHandle = setTimeout(handleTimer, 0);\n        // However, since this timer gets frequently dropped in Firefox\n        // workers, we enlist an interval handle that will try to fire\n        // an event 20 times per second until it succeeds.\n        var intervalHandle = setInterval(handleTimer, 50);\n\n        function handleTimer() {\n            // Whichever timer succeeds will cancel both timers and\n            // execute the callback.\n            clearTimeout(timeoutHandle);\n            clearInterval(intervalHandle);\n            callback();\n        }\n    };\n}\n\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// its existence.\nrawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer;\n\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n","\"use strict\";\n\n// rawAsap provides everything we need except exception management.\nvar rawAsap = require(\"./raw\");\n// RawTasks are recycled to reduce GC churn.\nvar freeTasks = [];\n// We queue errors to ensure they are thrown in right order (FIFO).\n// Array-as-queue is good enough here, since we are just dealing with exceptions.\nvar pendingErrors = [];\nvar requestErrorThrow = rawAsap.makeRequestCallFromTimer(throwFirstError);\n\nfunction throwFirstError() {\n    if (pendingErrors.length) {\n        throw pendingErrors.shift();\n    }\n}\n\n/**\n * Calls a task as soon as possible after returning, in its own event, with priority\n * over other events like animation, reflow, and repaint. An error thrown from an\n * event will not interrupt, nor even substantially slow down the processing of\n * other events, but will be rather postponed to a lower priority event.\n * @param {{call}} task A callable object, typically a function that takes no\n * arguments.\n */\nmodule.exports = asap;\nfunction asap(task) {\n    var rawTask;\n    if (freeTasks.length) {\n        rawTask = freeTasks.pop();\n    } else {\n        rawTask = new RawTask();\n    }\n    rawTask.task = task;\n    rawAsap(rawTask);\n}\n\n// We wrap tasks with recyclable task objects.  A task object implements\n// `call`, just like a function.\nfunction RawTask() {\n    this.task = null;\n}\n\n// The sole purpose of wrapping the task is to catch the exception and recycle\n// the task object after its single use.\nRawTask.prototype.call = function () {\n    try {\n        this.task.call();\n    } catch (error) {\n        if (asap.onerror) {\n            // This hook exists purely for testing purposes.\n            // Its name will be periodically randomized to break any code that\n            // depends on its existence.\n            asap.onerror(error);\n        } else {\n            // In a web browser, exceptions are not fatal. However, to avoid\n            // slowing down the queue of pending tasks, we rethrow the error in a\n            // lower priority turn.\n            pendingErrors.push(error);\n            requestErrorThrow();\n        }\n    } finally {\n        this.task = null;\n        freeTasks[freeTasks.length] = this;\n    }\n};\n","import calc from 'inline-style-prefixer/static/plugins/calc';\nimport crossFade from 'inline-style-prefixer/static/plugins/crossFade';\nimport cursor from 'inline-style-prefixer/static/plugins/cursor';\nimport filter from 'inline-style-prefixer/static/plugins/filter';\nimport flex from 'inline-style-prefixer/static/plugins/flex';\nimport flexboxIE from 'inline-style-prefixer/static/plugins/flexboxIE';\nimport flexboxOld from 'inline-style-prefixer/static/plugins/flexboxOld';\nimport gradient from 'inline-style-prefixer/static/plugins/gradient';\nimport imageSet from 'inline-style-prefixer/static/plugins/imageSet';\nimport position from 'inline-style-prefixer/static/plugins/position';\nimport sizing from 'inline-style-prefixer/static/plugins/sizing';\nimport transition from 'inline-style-prefixer/static/plugins/transition';\nimport stringHash from 'string-hash';\nimport createPrefixer from 'inline-style-prefixer/static/createPrefixer';\nimport asap from 'asap';\n\nvar w = [\"Webkit\"];\nvar m = [\"Moz\"];\nvar ms = [\"ms\"];\nvar wm = [\"Webkit\", \"Moz\"];\nvar wms = [\"Webkit\", \"ms\"];\nvar wmms = [\"Webkit\", \"Moz\", \"ms\"];\n\nvar staticPrefixData = {\n  plugins: [calc, crossFade, cursor, filter, flex, flexboxIE, flexboxOld, gradient, imageSet, position, sizing, transition],\n  prefixMap: { \"transform\": wms, \"transformOrigin\": wms, \"transformOriginX\": wms, \"transformOriginY\": wms, \"backfaceVisibility\": w, \"perspective\": w, \"perspectiveOrigin\": w, \"transformStyle\": w, \"transformOriginZ\": w, \"animation\": w, \"animationDelay\": w, \"animationDirection\": w, \"animationFillMode\": w, \"animationDuration\": w, \"animationIterationCount\": w, \"animationName\": w, \"animationPlayState\": w, \"animationTimingFunction\": w, \"appearance\": wm, \"userSelect\": wmms, \"fontKerning\": w, \"textEmphasisPosition\": w, \"textEmphasis\": w, \"textEmphasisStyle\": w, \"textEmphasisColor\": w, \"boxDecorationBreak\": w, \"clipPath\": w, \"maskImage\": w, \"maskMode\": w, \"maskRepeat\": w, \"maskPosition\": w, \"maskClip\": w, \"maskOrigin\": w, \"maskSize\": w, \"maskComposite\": w, \"mask\": w, \"maskBorderSource\": w, \"maskBorderMode\": w, \"maskBorderSlice\": w, \"maskBorderWidth\": w, \"maskBorderOutset\": w, \"maskBorderRepeat\": w, \"maskBorder\": w, \"maskType\": w, \"textDecorationStyle\": wm, \"textDecorationSkip\": wm, \"textDecorationLine\": wm, \"textDecorationColor\": wm, \"filter\": w, \"fontFeatureSettings\": wm, \"breakAfter\": wmms, \"breakBefore\": wmms, \"breakInside\": wmms, \"columnCount\": wm, \"columnFill\": wm, \"columnGap\": wm, \"columnRule\": wm, \"columnRuleColor\": wm, \"columnRuleStyle\": wm, \"columnRuleWidth\": wm, \"columns\": wm, \"columnSpan\": wm, \"columnWidth\": wm, \"writingMode\": wms, \"flex\": wms, \"flexBasis\": w, \"flexDirection\": wms, \"flexGrow\": w, \"flexFlow\": wms, \"flexShrink\": w, \"flexWrap\": wms, \"alignContent\": w, \"alignItems\": w, \"alignSelf\": w, \"justifyContent\": w, \"order\": w, \"transitionDelay\": w, \"transitionDuration\": w, \"transitionProperty\": w, \"transitionTimingFunction\": w, \"backdropFilter\": w, \"scrollSnapType\": wms, \"scrollSnapPointsX\": wms, \"scrollSnapPointsY\": wms, \"scrollSnapDestination\": wms, \"scrollSnapCoordinate\": wms, \"shapeImageThreshold\": w, \"shapeImageMargin\": w, \"shapeImageOutside\": w, \"hyphens\": wmms, \"flowInto\": wms, \"flowFrom\": wms, \"regionFragment\": wms, \"boxSizing\": m, \"textAlignLast\": m, \"tabSize\": m, \"wrapFlow\": ms, \"wrapThrough\": ms, \"wrapMargin\": ms, \"touchAction\": ms, \"gridTemplateColumns\": ms, \"gridTemplateRows\": ms, \"gridTemplateAreas\": ms, \"gridTemplate\": ms, \"gridAutoColumns\": ms, \"gridAutoRows\": ms, \"gridAutoFlow\": ms, \"grid\": ms, \"gridRowStart\": ms, \"gridColumnStart\": ms, \"gridRowEnd\": ms, \"gridRow\": ms, \"gridColumn\": ms, \"gridColumnEnd\": ms, \"gridColumnGap\": ms, \"gridRowGap\": ms, \"gridArea\": ms, \"gridGap\": ms, \"textSizeAdjust\": wms, \"borderImage\": w, \"borderImageOutset\": w, \"borderImageRepeat\": w, \"borderImageSlice\": w, \"borderImageSource\": w, \"borderImageWidth\": w }\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MAP_EXISTS = typeof Map !== 'undefined';\n\nvar OrderedElements = function () {\n    /* ::\n    elements: {[string]: any};\n    keyOrder: string[];\n    */\n\n    function OrderedElements() {\n        _classCallCheck(this, OrderedElements);\n\n        this.elements = {};\n        this.keyOrder = [];\n    }\n\n    _createClass(OrderedElements, [{\n        key: 'forEach',\n        value: function () {\n            function forEach(callback /* : (string, any) => void */) {\n                for (var i = 0; i < this.keyOrder.length; i++) {\n                    // (value, key) to match Map's API\n                    callback(this.elements[this.keyOrder[i]], this.keyOrder[i]);\n                }\n            }\n\n            return forEach;\n        }()\n    }, {\n        key: 'set',\n        value: function () {\n            function set(key /* : string */, value /* : any */, shouldReorder /* : ?boolean */) {\n                if (!this.elements.hasOwnProperty(key)) {\n                    this.keyOrder.push(key);\n                } else if (shouldReorder) {\n                    var index = this.keyOrder.indexOf(key);\n                    this.keyOrder.splice(index, 1);\n                    this.keyOrder.push(key);\n                }\n\n                if (value == null) {\n                    this.elements[key] = value;\n                    return;\n                }\n\n                if (MAP_EXISTS && value instanceof Map || value instanceof OrderedElements) {\n                    // We have found a nested Map, so we need to recurse so that all\n                    // of the nested objects and Maps are merged properly.\n                    var nested = this.elements.hasOwnProperty(key) ? this.elements[key] : new OrderedElements();\n                    value.forEach(function (value, key) {\n                        nested.set(key, value, shouldReorder);\n                    });\n                    this.elements[key] = nested;\n                    return;\n                }\n\n                if (!Array.isArray(value) && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {\n                    // We have found a nested object, so we need to recurse so that all\n                    // of the nested objects and Maps are merged properly.\n                    var _nested = this.elements.hasOwnProperty(key) ? this.elements[key] : new OrderedElements();\n                    var keys = Object.keys(value);\n                    for (var i = 0; i < keys.length; i += 1) {\n                        _nested.set(keys[i], value[keys[i]], shouldReorder);\n                    }\n                    this.elements[key] = _nested;\n                    return;\n                }\n\n                this.elements[key] = value;\n            }\n\n            return set;\n        }()\n    }, {\n        key: 'get',\n        value: function () {\n            function get(key /* : string */) /* : any */{\n                return this.elements[key];\n            }\n\n            return get;\n        }()\n    }, {\n        key: 'has',\n        value: function () {\n            function has(key /* : string */) /* : boolean */{\n                return this.elements.hasOwnProperty(key);\n            }\n\n            return has;\n        }()\n    }, {\n        key: 'addStyleType',\n        value: function () {\n            function addStyleType(styleType /* : any */) /* : void */{\n                var _this = this;\n\n                if (MAP_EXISTS && styleType instanceof Map || styleType instanceof OrderedElements) {\n                    styleType.forEach(function (value, key) {\n                        _this.set(key, value, true);\n                    });\n                } else {\n                    var keys = Object.keys(styleType);\n                    for (var i = 0; i < keys.length; i++) {\n                        this.set(keys[i], styleType[keys[i]], true);\n                    }\n                }\n            }\n\n            return addStyleType;\n        }()\n    }]);\n\n    return OrderedElements;\n}();\n\n/* ::\ntype ObjectMap = { [id:string]: any };\n*/\n\nvar UPPERCASE_RE = /([A-Z])/g;\nvar UPPERCASE_RE_TO_KEBAB = function UPPERCASE_RE_TO_KEBAB(match /* : string */) {\n    return (/* : string */'-' + String(match.toLowerCase())\n    );\n};\n\nvar kebabifyStyleName = function kebabifyStyleName(string /* : string */) /* : string */{\n    var result = string.replace(UPPERCASE_RE, UPPERCASE_RE_TO_KEBAB);\n    if (result[0] === 'm' && result[1] === 's' && result[2] === '-') {\n        return '-' + String(result);\n    }\n    return result;\n};\n\n/**\n * CSS properties which accept numbers but are not in units of \"px\".\n * Taken from React's CSSProperty.js\n */\nvar isUnitlessNumber = {\n    animationIterationCount: true,\n    borderImageOutset: true,\n    borderImageSlice: true,\n    borderImageWidth: true,\n    boxFlex: true,\n    boxFlexGroup: true,\n    boxOrdinalGroup: true,\n    columnCount: true,\n    flex: true,\n    flexGrow: true,\n    flexPositive: true,\n    flexShrink: true,\n    flexNegative: true,\n    flexOrder: true,\n    gridRow: true,\n    gridColumn: true,\n    fontWeight: true,\n    lineClamp: true,\n    lineHeight: true,\n    opacity: true,\n    order: true,\n    orphans: true,\n    tabSize: true,\n    widows: true,\n    zIndex: true,\n    zoom: true,\n\n    // SVG-related properties\n    fillOpacity: true,\n    floodOpacity: true,\n    stopOpacity: true,\n    strokeDasharray: true,\n    strokeDashoffset: true,\n    strokeMiterlimit: true,\n    strokeOpacity: true,\n    strokeWidth: true\n};\n\n/**\n * Taken from React's CSSProperty.js\n *\n * @param {string} prefix vendor-specific prefix, eg: Webkit\n * @param {string} key style name, eg: transitionDuration\n * @return {string} style name prefixed with `prefix`, properly camelCased, eg:\n * WebkitTransitionDuration\n */\nfunction prefixKey(prefix, key) {\n    return prefix + key.charAt(0).toUpperCase() + key.substring(1);\n}\n\n/**\n * Support style names that may come passed in prefixed by adding permutations\n * of vendor prefixes.\n * Taken from React's CSSProperty.js\n */\nvar prefixes = ['Webkit', 'ms', 'Moz', 'O'];\n\n// Using Object.keys here, or else the vanilla for-in loop makes IE8 go into an\n// infinite loop, because it iterates over the newly added props too.\n// Taken from React's CSSProperty.js\nObject.keys(isUnitlessNumber).forEach(function (prop) {\n    prefixes.forEach(function (prefix) {\n        isUnitlessNumber[prefixKey(prefix, prop)] = isUnitlessNumber[prop];\n    });\n});\n\nvar stringifyValue = function stringifyValue(key /* : string */\n, prop /* : any */\n) /* : string */{\n    if (typeof prop === \"number\") {\n        if (isUnitlessNumber[key]) {\n            return \"\" + prop;\n        } else {\n            return prop + \"px\";\n        }\n    } else {\n        return '' + prop;\n    }\n};\n\nvar stringifyAndImportantifyValue = function stringifyAndImportantifyValue(key /* : string */\n, prop /* : any */\n) {\n    return (/* : string */importantify(stringifyValue(key, prop))\n    );\n};\n\n// Turn a string into a hash string of base-36 values (using letters and numbers)\n// eslint-disable-next-line no-unused-vars\nvar hashString = function hashString(string /* : string */, key /* : ?string */) {\n    return (/* string */stringHash(string).toString(36)\n    );\n};\n\n// Hash a javascript object using JSON.stringify. This is very fast, about 3\n// microseconds on my computer for a sample object:\n// http://jsperf.com/test-hashfnv32a-hash/5\n//\n// Note that this uses JSON.stringify to stringify the objects so in order for\n// this to produce consistent hashes browsers need to have a consistent\n// ordering of objects. Ben Alpert says that Facebook depends on this, so we\n// can probably depend on this too.\nvar hashObject = function hashObject(object /* : ObjectMap */) {\n    return (/* : string */hashString(JSON.stringify(object))\n    );\n};\n\n// Given a single style value string like the \"b\" from \"a: b;\", adds !important\n// to generate \"b !important\".\nvar importantify = function importantify(string /* : string */) {\n    return (/* : string */\n        // Bracket string character access is very fast, and in the default case we\n        // normally don't expect there to be \"!important\" at the end of the string\n        // so we can use this simple check to take an optimized path. If there\n        // happens to be a \"!\" in this position, we follow up with a more thorough\n        // check.\n        string[string.length - 10] === '!' && string.slice(-11) === ' !important' ? string : String(string) + ' !important'\n    );\n};\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar prefixAll = createPrefixer(staticPrefixData);\n\n/* ::\nimport type { SheetDefinition } from './index.js';\ntype StringHandlers = { [id:string]: Function };\ntype SelectorCallback = (selector: string) => string[];\nexport type SelectorHandler = (\n    selector: string,\n    baseSelector: string,\n    callback: SelectorCallback\n) => string[] | string | null;\n*/\n\n/**\n * `selectorHandlers` are functions which handle special selectors which act\n * differently than normal style definitions. These functions look at the\n * current selector and can generate CSS for the styles in their subtree by\n * calling the callback with a new selector.\n *\n * For example, when generating styles with a base selector of '.foo' and the\n * following styles object:\n *\n *   {\n *     ':nth-child(2n)': {\n *       ':hover': {\n *         color: 'red'\n *       }\n *     }\n *   }\n *\n * when we reach the ':hover' style, we would call our selector handlers like\n *\n *   handler(':hover', '.foo:nth-child(2n)', callback)\n *\n * Since our `pseudoSelectors` handles ':hover' styles, that handler would call\n * the callback like\n *\n *   callback('.foo:nth-child(2n):hover')\n *\n * to generate its subtree `{ color: 'red' }` styles with a\n * '.foo:nth-child(2n):hover' selector. The callback would return an array of CSS\n * rules like\n *\n *   ['.foo:nth-child(2n):hover{color:red !important;}']\n *\n * and the handler would then return that resulting CSS.\n *\n * `defaultSelectorHandlers` is the list of default handlers used in a call to\n * `generateCSS`.\n *\n * @name SelectorHandler\n * @function\n * @param {string} selector: The currently inspected selector. ':hover' in the\n *     example above.\n * @param {string} baseSelector: The selector of the parent styles.\n *     '.foo:nth-child(2n)' in the example above.\n * @param {function} generateSubtreeStyles: A function which can be called to\n *     generate CSS for the subtree of styles corresponding to the selector.\n *     Accepts a new baseSelector to use for generating those styles.\n * @returns {string[] | string | null} The generated CSS for this selector, or\n *     null if we don't handle this selector.\n */\nvar defaultSelectorHandlers /* : SelectorHandler[] */ = [\n// Handle pseudo-selectors, like :hover and :nth-child(3n)\nfunction () {\n    function pseudoSelectors(selector, baseSelector, generateSubtreeStyles) {\n        if (selector[0] !== \":\") {\n            return null;\n        }\n        return generateSubtreeStyles(baseSelector + selector);\n    }\n\n    return pseudoSelectors;\n}(),\n\n// Handle media queries (or font-faces)\nfunction () {\n    function mediaQueries(selector, baseSelector, generateSubtreeStyles) {\n        if (selector[0] !== \"@\") {\n            return null;\n        }\n        // Generate the styles normally, and then wrap them in the media query.\n        var generated = generateSubtreeStyles(baseSelector);\n        return [String(selector) + '{' + String(generated.join('')) + '}'];\n    }\n\n    return mediaQueries;\n}()];\n\n/**\n * Generate CSS for a selector and some styles.\n *\n * This function handles the media queries and pseudo selectors that can be used\n * in aphrodite styles.\n *\n * @param {string} selector: A base CSS selector for the styles to be generated\n *     with.\n * @param {Object} styleTypes: A list of properties of the return type of\n *     StyleSheet.create, e.g. [styles.red, styles.blue].\n * @param {Array.<SelectorHandler>} selectorHandlers: A list of selector\n *     handlers to use for handling special selectors. See\n *     `defaultSelectorHandlers`.\n * @param stringHandlers: See `generateCSSRuleset`\n * @param useImportant: See `generateCSSRuleset`\n *\n * To actually generate the CSS special-construct-less styles are passed to\n * `generateCSSRuleset`.\n *\n * For instance, a call to\n *\n *     generateCSS(\".foo\", [{\n *       color: \"red\",\n *       \"@media screen\": {\n *         height: 20,\n *         \":hover\": {\n *           backgroundColor: \"black\"\n *         }\n *       },\n *       \":active\": {\n *         fontWeight: \"bold\"\n *       }\n *     }], defaultSelectorHandlers);\n *\n * with the default `selectorHandlers` will make 5 calls to\n * `generateCSSRuleset`:\n *\n *     generateCSSRuleset(\".foo\", { color: \"red\" }, ...)\n *     generateCSSRuleset(\".foo:active\", { fontWeight: \"bold\" }, ...)\n *     // These 2 will be wrapped in @media screen {}\n *     generateCSSRuleset(\".foo\", { height: 20 }, ...)\n *     generateCSSRuleset(\".foo:hover\", { backgroundColor: \"black\" }, ...)\n */\nvar generateCSS = function generateCSS(selector /* : string */\n, styleTypes /* : SheetDefinition[] */\n, selectorHandlers /* : SelectorHandler[] */\n, stringHandlers /* : StringHandlers */\n, useImportant /* : boolean */\n) /* : string[] */{\n    var merged = new OrderedElements();\n\n    for (var i = 0; i < styleTypes.length; i++) {\n        merged.addStyleType(styleTypes[i]);\n    }\n\n    var plainDeclarations = new OrderedElements();\n    var generatedStyles = [];\n\n    // TODO(emily): benchmark this to see if a plain for loop would be faster.\n    merged.forEach(function (val, key) {\n        // For each key, see if one of the selector handlers will handle these\n        // styles.\n        var foundHandler = selectorHandlers.some(function (handler) {\n            var result = handler(key, selector, function (newSelector) {\n                return generateCSS(newSelector, [val], selectorHandlers, stringHandlers, useImportant);\n            });\n            if (result != null) {\n                // If the handler returned something, add it to the generated\n                // CSS and stop looking for another handler.\n                if (Array.isArray(result)) {\n                    generatedStyles.push.apply(generatedStyles, _toConsumableArray(result));\n                } else {\n                    // eslint-disable-next-line\n                    console.warn('WARNING: Selector handlers should return an array of rules.' + 'Returning a string containing multiple rules is deprecated.', handler);\n                    generatedStyles.push('@media all {' + String(result) + '}');\n                }\n                return true;\n            }\n        });\n        // If none of the handlers handled it, add it to the list of plain\n        // style declarations.\n        if (!foundHandler) {\n            plainDeclarations.set(key, val, true);\n        }\n    });\n    var generatedRuleset = generateCSSRuleset(selector, plainDeclarations, stringHandlers, useImportant, selectorHandlers);\n\n    if (generatedRuleset) {\n        generatedStyles.unshift(generatedRuleset);\n    }\n\n    return generatedStyles;\n};\n\n/**\n * Helper method of generateCSSRuleset to facilitate custom handling of certain\n * CSS properties. Used for e.g. font families.\n *\n * See generateCSSRuleset for usage and documentation of paramater types.\n */\nvar runStringHandlers = function runStringHandlers(declarations /* : OrderedElements */\n, stringHandlers /* : StringHandlers */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : void */{\n    if (!stringHandlers) {\n        return;\n    }\n\n    var stringHandlerKeys = Object.keys(stringHandlers);\n    for (var i = 0; i < stringHandlerKeys.length; i++) {\n        var key = stringHandlerKeys[i];\n        if (declarations.has(key)) {\n            // A declaration exists for this particular string handler, so we\n            // need to let the string handler interpret the declaration first\n            // before proceeding.\n            //\n            // TODO(emily): Pass in a callback which generates CSS, similar to\n            // how our selector handlers work, instead of passing in\n            // `selectorHandlers` and have them make calls to `generateCSS`\n            // themselves. Right now, this is impractical because our string\n            // handlers are very specialized and do complex things.\n            declarations.set(key, stringHandlers[key](declarations.get(key), selectorHandlers),\n\n            // Preserve order here, since we are really replacing an\n            // unprocessed style with a processed style, not overriding an\n            // earlier style\n            false);\n        }\n    }\n};\n\nvar transformRule = function transformRule(key /* : string */\n, value /* : string */\n, transformValue /* : function */\n) {\n    return (/* : string */String(kebabifyStyleName(key)) + ':' + String(transformValue(key, value)) + ';'\n    );\n};\n\nvar arrayToObjectKeysReducer = function arrayToObjectKeysReducer(acc, val) {\n    acc[val] = true;\n    return acc;\n};\n\n/**\n * Generate a CSS ruleset with the selector and containing the declarations.\n *\n * This function assumes that the given declarations don't contain any special\n * children (such as media queries, pseudo-selectors, or descendant styles).\n *\n * Note that this method does not deal with nesting used for e.g.\n * psuedo-selectors or media queries. That responsibility is left to  the\n * `generateCSS` function.\n *\n * @param {string} selector: the selector associated with the ruleset\n * @param {Object} declarations: a map from camelCased CSS property name to CSS\n *     property value.\n * @param {Object.<string, function>} stringHandlers: a map from camelCased CSS\n *     property name to a function which will map the given value to the value\n *     that is output.\n * @param {bool} useImportant: A boolean saying whether to append \"!important\"\n *     to each of the CSS declarations.\n * @returns {string} A string of raw CSS.\n *\n * Examples:\n *\n *    generateCSSRuleset(\".blah\", { color: \"red\" })\n *    -> \".blah{color: red !important;}\"\n *    generateCSSRuleset(\".blah\", { color: \"red\" }, {}, false)\n *    -> \".blah{color: red}\"\n *    generateCSSRuleset(\".blah\", { color: \"red\" }, {color: c => c.toUpperCase})\n *    -> \".blah{color: RED}\"\n *    generateCSSRuleset(\".blah:hover\", { color: \"red\" })\n *    -> \".blah:hover{color: red}\"\n */\nvar generateCSSRuleset = function generateCSSRuleset(selector /* : string */\n, declarations /* : OrderedElements */\n, stringHandlers /* : StringHandlers */\n, useImportant /* : boolean */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : string */{\n    // Mutates declarations\n    runStringHandlers(declarations, stringHandlers, selectorHandlers);\n\n    var originalElements = Object.keys(declarations.elements).reduce(arrayToObjectKeysReducer, Object.create(null));\n\n    // NOTE(emily): This mutates handledDeclarations.elements.\n    var prefixedElements = prefixAll(declarations.elements);\n\n    var elementNames = Object.keys(prefixedElements);\n    if (elementNames.length !== declarations.keyOrder.length) {\n        // There are some prefixed values, so we need to figure out how to sort\n        // them.\n        //\n        // Loop through prefixedElements, looking for anything that is not in\n        // sortOrder, which means it was added by prefixAll. This means that we\n        // need to figure out where it should appear in the sortOrder.\n        for (var i = 0; i < elementNames.length; i++) {\n            if (!originalElements[elementNames[i]]) {\n                // This element is not in the sortOrder, which means it is a prefixed\n                // value that was added by prefixAll. Let's try to figure out where it\n                // goes.\n                var originalStyle = void 0;\n                if (elementNames[i][0] === 'W') {\n                    // This is a Webkit-prefixed style, like \"WebkitTransition\". Let's\n                    // find its original style's sort order.\n                    originalStyle = elementNames[i][6].toLowerCase() + elementNames[i].slice(7);\n                } else if (elementNames[i][1] === 'o') {\n                    // This is a Moz-prefixed style, like \"MozTransition\". We check\n                    // the second character to avoid colliding with Ms-prefixed\n                    // styles. Let's find its original style's sort order.\n                    originalStyle = elementNames[i][3].toLowerCase() + elementNames[i].slice(4);\n                } else {\n                    // if (elementNames[i][1] === 's') {\n                    // This is a Ms-prefixed style, like \"MsTransition\".\n                    originalStyle = elementNames[i][2].toLowerCase() + elementNames[i].slice(3);\n                }\n\n                if (originalStyle && originalElements[originalStyle]) {\n                    var originalIndex = declarations.keyOrder.indexOf(originalStyle);\n                    declarations.keyOrder.splice(originalIndex, 0, elementNames[i]);\n                } else {\n                    // We don't know what the original style was, so sort it to\n                    // top. This can happen for styles that are added that don't\n                    // have the same base name as the original style.\n                    declarations.keyOrder.unshift(elementNames[i]);\n                }\n            }\n        }\n    }\n\n    var transformValue = useImportant === false ? stringifyValue : stringifyAndImportantifyValue;\n\n    var rules = [];\n    for (var _i = 0; _i < declarations.keyOrder.length; _i++) {\n        var key = declarations.keyOrder[_i];\n        var value = prefixedElements[key];\n        if (Array.isArray(value)) {\n            // inline-style-prefixer returns an array when there should be\n            // multiple rules for the same key. Here we flatten to multiple\n            // pairs with the same key.\n            for (var j = 0; j < value.length; j++) {\n                rules.push(transformRule(key, value[j], transformValue));\n            }\n        } else {\n            rules.push(transformRule(key, value, transformValue));\n        }\n    }\n\n    if (rules.length) {\n        return String(selector) + '{' + String(rules.join(\"\")) + '}';\n    } else {\n        return \"\";\n    }\n};\n\nvar _typeof$1 = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray$1(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/* ::\nimport type { SheetDefinition, SheetDefinitions } from './index.js';\nimport type { MaybeSheetDefinition } from './exports.js';\nimport type { SelectorHandler } from './generate.js';\n*/\n\n// The current <style> tag we are inserting into, or null if we haven't\n// inserted anything yet. We could find this each time using\n// `document.querySelector(\"style[data-aphrodite\"])`, but holding onto it is\n// faster.\nvar styleTag /* : ?HTMLStyleElement */ = null;\n\n// Inject a set of rules into a <style> tag in the head of the document. This\n// will automatically create a style tag and then continue to use it for\n// multiple injections. It will also use a style tag with the `data-aphrodite`\n// tag on it if that exists in the DOM. This could be used for e.g. reusing the\n// same style tag that server-side rendering inserts.\nvar injectStyleTag = function injectStyleTag(cssRules /* : string[] */) {\n    if (styleTag == null) {\n        // Try to find a style tag with the `data-aphrodite` attribute first.\n        styleTag = document.querySelector(\"style[data-aphrodite]\") /* : any */;\n\n        // If that doesn't work, generate a new style tag.\n        if (styleTag == null) {\n            // Taken from\n            // http://stackoverflow.com/questions/524696/how-to-create-a-style-tag-with-javascript\n            var head = document.head || document.getElementsByTagName('head')[0];\n            styleTag = document.createElement('style');\n\n            styleTag.type = 'text/css';\n            styleTag.setAttribute(\"data-aphrodite\", \"\");\n            head.appendChild(styleTag);\n        }\n    }\n\n    var sheet = styleTag.styleSheet || styleTag.sheet /* : any */;\n\n    if (sheet.insertRule) {\n        var numRules = sheet.cssRules.length;\n        cssRules.forEach(function (rule) {\n            try {\n                sheet.insertRule(rule, numRules);\n                numRules += 1;\n            } catch (e) {\n                // The selector for this rule wasn't compatible with the browser\n            }\n        });\n    } else {\n        styleTag.innerText = (styleTag.innerText || '') + cssRules.join('');\n    }\n};\n\n// Custom handlers for stringifying CSS values that have side effects\n// (such as fontFamily, which can cause @font-face rules to be injected)\nvar stringHandlers = {\n    // With fontFamily we look for objects that are passed in and interpret\n    // them as @font-face rules that we need to inject. The value of fontFamily\n    // can either be a string (as normal), an object (a single font face), or\n    // an array of objects and strings.\n    fontFamily: function () {\n        function fontFamily(val) {\n            if (Array.isArray(val)) {\n                return val.map(fontFamily).join(\",\");\n            } else if ((typeof val === 'undefined' ? 'undefined' : _typeof$1(val)) === \"object\") {\n                injectStyleOnce(val.src, \"@font-face\", [val], false);\n                return '\"' + String(val.fontFamily) + '\"';\n            } else {\n                return val;\n            }\n        }\n\n        return fontFamily;\n    }(),\n\n    // With animationName we look for an object that contains keyframes and\n    // inject them as an `@keyframes` block, returning a uniquely generated\n    // name. The keyframes object should look like\n    //  animationName: {\n    //    from: {\n    //      left: 0,\n    //      top: 0,\n    //    },\n    //    '50%': {\n    //      left: 15,\n    //      top: 5,\n    //    },\n    //    to: {\n    //      left: 20,\n    //      top: 20,\n    //    }\n    //  }\n    // TODO(emily): `stringHandlers` doesn't let us rename the key, so I have\n    // to use `animationName` here. Improve that so we can call this\n    // `animation` instead of `animationName`.\n    animationName: function () {\n        function animationName(val, selectorHandlers) {\n            if (Array.isArray(val)) {\n                return val.map(function (v) {\n                    return animationName(v, selectorHandlers);\n                }).join(\",\");\n            } else if ((typeof val === 'undefined' ? 'undefined' : _typeof$1(val)) === \"object\") {\n                // Generate a unique name based on the hash of the object. We can't\n                // just use the hash because the name can't start with a number.\n                // TODO(emily): this probably makes debugging hard, allow a custom\n                // name?\n                var name = 'keyframe_' + String(hashObject(val));\n\n                // Since keyframes need 3 layers of nesting, we use `generateCSS` to\n                // build the inner layers and wrap it in `@keyframes` ourselves.\n                var finalVal = '@keyframes ' + name + '{';\n\n                // TODO see if we can find a way where checking for OrderedElements\n                // here is not necessary. Alternatively, perhaps we should have a\n                // utility method that can iterate over either a plain object, an\n                // instance of OrderedElements, or a Map, and then use that here and\n                // elsewhere.\n                if (val instanceof OrderedElements) {\n                    val.forEach(function (valVal, valKey) {\n                        finalVal += generateCSS(valKey, [valVal], selectorHandlers, stringHandlers, false).join('');\n                    });\n                } else {\n                    Object.keys(val).forEach(function (key) {\n                        finalVal += generateCSS(key, [val[key]], selectorHandlers, stringHandlers, false).join('');\n                    });\n                }\n                finalVal += '}';\n\n                injectGeneratedCSSOnce(name, [finalVal]);\n\n                return name;\n            } else {\n                return val;\n            }\n        }\n\n        return animationName;\n    }()\n};\n\n// This is a map from Aphrodite's generated class names to `true` (acting as a\n// set of class names)\nvar alreadyInjected = {};\n\n// This is the buffer of styles which have not yet been flushed.\nvar injectionBuffer /* : string[] */ = [];\n\n// A flag to tell if we are already buffering styles. This could happen either\n// because we scheduled a flush call already, so newly added styles will\n// already be flushed, or because we are statically buffering on the server.\nvar isBuffering = false;\n\nvar injectGeneratedCSSOnce = function injectGeneratedCSSOnce(key, generatedCSS) {\n    var _injectionBuffer;\n\n    if (alreadyInjected[key]) {\n        return;\n    }\n\n    if (!isBuffering) {\n        // We should never be automatically buffering on the server (or any\n        // place without a document), so guard against that.\n        if (typeof document === \"undefined\") {\n            throw new Error(\"Cannot automatically buffer without a document\");\n        }\n\n        // If we're not already buffering, schedule a call to flush the\n        // current styles.\n        isBuffering = true;\n        asap(flushToStyleTag);\n    }\n\n    (_injectionBuffer = injectionBuffer).push.apply(_injectionBuffer, _toConsumableArray$1(generatedCSS));\n    alreadyInjected[key] = true;\n};\n\nvar injectStyleOnce = function injectStyleOnce(key /* : string */\n, selector /* : string */\n, definitions /* : SheetDefinition[] */\n, useImportant /* : boolean */\n) {\n    var selectorHandlers /* : SelectorHandler[] */ = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];\n\n    if (alreadyInjected[key]) {\n        return;\n    }\n\n    var generated = generateCSS(selector, definitions, selectorHandlers, stringHandlers, useImportant);\n\n    injectGeneratedCSSOnce(key, generated);\n};\n\nvar reset = function reset() {\n    injectionBuffer = [];\n    alreadyInjected = {};\n    isBuffering = false;\n    styleTag = null;\n};\n\nvar getBufferedStyles = function getBufferedStyles() {\n    return injectionBuffer;\n};\n\nvar startBuffering = function startBuffering() {\n    if (isBuffering) {\n        throw new Error(\"Cannot buffer while already buffering\");\n    }\n    isBuffering = true;\n};\n\nvar flushToArray = function flushToArray() {\n    isBuffering = false;\n    var ret = injectionBuffer;\n    injectionBuffer = [];\n    return ret;\n};\n\nvar flushToString = function flushToString() {\n    return flushToArray().join('');\n};\n\nvar flushToStyleTag = function flushToStyleTag() {\n    var cssRules = flushToArray();\n    if (cssRules.length > 0) {\n        injectStyleTag(cssRules);\n    }\n};\n\nvar getRenderedClassNames = function getRenderedClassNames() {\n    return Object.keys(alreadyInjected);\n};\n\nvar addRenderedClassNames = function addRenderedClassNames(classNames /* : string[] */) {\n    classNames.forEach(function (className) {\n        alreadyInjected[className] = true;\n    });\n};\n\nvar processStyleDefinitions = function processStyleDefinitions(styleDefinitions /* : any[] */\n, classNameBits /* : string[] */\n, definitionBits /* : Object[] */\n, length /* : number */\n) /* : number */{\n    for (var i = 0; i < styleDefinitions.length; i += 1) {\n        // Filter out falsy values from the input, to allow for\n        // `css(a, test && c)`\n        if (styleDefinitions[i]) {\n            if (Array.isArray(styleDefinitions[i])) {\n                // We've encountered an array, so let's recurse\n                length += processStyleDefinitions(styleDefinitions[i], classNameBits, definitionBits, length);\n            } else {\n                classNameBits.push(styleDefinitions[i]._name);\n                definitionBits.push(styleDefinitions[i]._definition);\n                length += styleDefinitions[i]._len;\n            }\n        }\n    }\n    return length;\n};\n\n/**\n * Inject styles associated with the passed style definition objects, and return\n * an associated CSS class name.\n *\n * @param {boolean} useImportant If true, will append !important to generated\n *     CSS output. e.g. {color: red} -> \"color: red !important\".\n * @param {(Object|Object[])[]} styleDefinitions style definition objects, or\n *     arbitrarily nested arrays of them, as returned as properties of the\n *     return value of StyleSheet.create().\n */\nvar injectAndGetClassName = function injectAndGetClassName(useImportant /* : boolean */\n, styleDefinitions /* : MaybeSheetDefinition[] */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : string */{\n    var classNameBits = [];\n    var definitionBits = [];\n\n    // Mutates classNameBits and definitionBits and returns a length which we\n    // will append to the hash to decrease the chance of hash collisions.\n    var length = processStyleDefinitions(styleDefinitions, classNameBits, definitionBits, 0);\n\n    // Break if there aren't any valid styles.\n    if (classNameBits.length === 0) {\n        return \"\";\n    }\n\n    var className = void 0;\n    if (process.env.NODE_ENV === 'production') {\n        className = classNameBits.length === 1 ? '_' + String(classNameBits[0]) : '_' + String(hashString(classNameBits.join())) + String((length % 36).toString(36));\n    } else {\n        className = classNameBits.join(\"-o_O-\");\n    }\n\n    injectStyleOnce(className, '.' + String(className), definitionBits, useImportant, selectorHandlers);\n\n    return className;\n};\n\n/* ::\nimport type { SelectorHandler } from './generate.js';\nexport type SheetDefinition = { [id:string]: any };\nexport type SheetDefinitions = SheetDefinition | SheetDefinition[];\ntype RenderFunction = () => string;\ntype Extension = {\n    selectorHandler: SelectorHandler\n};\nexport type MaybeSheetDefinition = SheetDefinition | false | null | void\n*/\n\nvar unminifiedHashFn = function unminifiedHashFn(str /* : string */, key /* : string */) {\n    return String(key) + '_' + String(hashString(str));\n};\n\n// StyleSheet.create is in a hot path so we want to keep as much logic out of it\n// as possible. So, we figure out which hash function to use once, and only\n// switch it out via minify() as necessary.\n//\n// This is in an exported function to make it easier to test.\nvar initialHashFn = function initialHashFn() {\n    return process.env.NODE_ENV === 'production' ? hashString : unminifiedHashFn;\n};\n\nvar hashFn = initialHashFn();\n\nvar StyleSheet = {\n    create: function () {\n        function create(sheetDefinition /* : SheetDefinition */) /* : Object */{\n            var mappedSheetDefinition = {};\n            var keys = Object.keys(sheetDefinition);\n\n            for (var i = 0; i < keys.length; i += 1) {\n                var key = keys[i];\n                var val = sheetDefinition[key];\n                var stringVal = JSON.stringify(val);\n\n                mappedSheetDefinition[key] = {\n                    _len: stringVal.length,\n                    _name: hashFn(stringVal, key),\n                    _definition: val\n                };\n            }\n\n            return mappedSheetDefinition;\n        }\n\n        return create;\n    }(),\n    rehydrate: function () {\n        function rehydrate() {\n            var renderedClassNames /* : string[] */ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n            addRenderedClassNames(renderedClassNames);\n        }\n\n        return rehydrate;\n    }()\n};\n\n/**\n * Utilities for using Aphrodite server-side.\n *\n * This can be minified out in client-only bundles by replacing `typeof window`\n * with `\"object\"`, e.g. via Webpack's DefinePlugin:\n *\n *   new webpack.DefinePlugin({\n *     \"typeof window\": JSON.stringify(\"object\")\n *   })\n */\nvar StyleSheetServer = typeof window !== 'undefined' ? null : {\n    renderStatic: function () {\n        function renderStatic(renderFunc /* : RenderFunction */) {\n            reset();\n            startBuffering();\n            var html = renderFunc();\n            var cssContent = flushToString();\n\n            return {\n                html: html,\n                css: {\n                    content: cssContent,\n                    renderedClassNames: getRenderedClassNames()\n                }\n            };\n        }\n\n        return renderStatic;\n    }()\n};\n\n/**\n * Utilities for using Aphrodite in tests.\n *\n * Not meant to be used in production.\n */\nvar StyleSheetTestUtils = process.env.NODE_ENV === 'production' ? null : {\n    /**\n    * Prevent styles from being injected into the DOM.\n    *\n    * This is useful in situations where you'd like to test rendering UI\n    * components which use Aphrodite without any of the side-effects of\n    * Aphrodite happening. Particularly useful for testing the output of\n    * components when you have no DOM, e.g. testing in Node without a fake DOM.\n    *\n    * Should be paired with a subsequent call to\n    * clearBufferAndResumeStyleInjection.\n    */\n    suppressStyleInjection: function () {\n        function suppressStyleInjection() {\n            reset();\n            startBuffering();\n        }\n\n        return suppressStyleInjection;\n    }(),\n\n\n    /**\n    * Opposite method of preventStyleInject.\n    */\n    clearBufferAndResumeStyleInjection: function () {\n        function clearBufferAndResumeStyleInjection() {\n            reset();\n        }\n\n        return clearBufferAndResumeStyleInjection;\n    }(),\n\n\n    /**\n    * Returns a string of buffered styles which have not been flushed\n    *\n    * @returns {string}  Buffer of styles which have not yet been flushed.\n    */\n    getBufferedStyles: function () {\n        function getBufferedStyles$$1() {\n            return getBufferedStyles();\n        }\n\n        return getBufferedStyles$$1;\n    }()\n};\n\n/**\n * Generate the Aphrodite API exports, with given `selectorHandlers` and\n * `useImportant` state.\n */\nfunction makeExports(useImportant /* : boolean */\n, selectorHandlers /* : SelectorHandler[] */\n) {\n    return {\n        StyleSheet: Object.assign({}, StyleSheet, {\n\n            /**\n             * Returns a version of the exports of Aphrodite (i.e. an object\n             * with `css` and `StyleSheet` properties) which have some\n             * extensions included.\n             *\n             * @param {Array.<Object>} extensions: An array of extensions to\n             *     add to this instance of Aphrodite. Each object should have a\n             *     single property on it, defining which kind of extension to\n             *     add.\n             * @param {SelectorHandler} [extensions[].selectorHandler]: A\n             *     selector handler extension. See `defaultSelectorHandlers` in\n             *     generate.js.\n             *\n             * @returns {Object} An object containing the exports of the new\n             *     instance of Aphrodite.\n             */\n            extend: function () {\n                function extend(extensions /* : Extension[] */) {\n                    var extensionSelectorHandlers = extensions\n                    // Pull out extensions with a selectorHandler property\n                    .map(function (extension) {\n                        return extension.selectorHandler;\n                    })\n                    // Remove nulls (i.e. extensions without a selectorHandler\n                    // property).\n                    .filter(function (handler) {\n                        return handler;\n                    });\n\n                    return makeExports(useImportant, selectorHandlers.concat(extensionSelectorHandlers));\n                }\n\n                return extend;\n            }()\n        }),\n\n        StyleSheetServer: StyleSheetServer,\n        StyleSheetTestUtils: StyleSheetTestUtils,\n\n        minify: function () {\n            function minify(shouldMinify /* : boolean */) {\n                hashFn = shouldMinify ? hashString : unminifiedHashFn;\n            }\n\n            return minify;\n        }(),\n        css: function () {\n            function css() /* : MaybeSheetDefinition[] */{\n                for (var _len = arguments.length, styleDefinitions = Array(_len), _key = 0; _key < _len; _key++) {\n                    styleDefinitions[_key] = arguments[_key];\n                }\n\n                return injectAndGetClassName(useImportant, styleDefinitions, selectorHandlers);\n            }\n\n            return css;\n        }()\n    };\n}\n\nvar useImportant = true; // Add !important to all style definitions\n\nvar Aphrodite = makeExports(useImportant, defaultSelectorHandlers);\n\nvar StyleSheet$1 = Aphrodite.StyleSheet,\n    StyleSheetServer$1 = Aphrodite.StyleSheetServer,\n    StyleSheetTestUtils$1 = Aphrodite.StyleSheetTestUtils,\n    css = Aphrodite.css,\n    minify = Aphrodite.minify;\n\nexport { StyleSheet$1 as StyleSheet, StyleSheetServer$1 as StyleSheetServer, StyleSheetTestUtils$1 as StyleSheetTestUtils, css, minify, flushToStyleTag };\n","import {StyleSheet} from 'aphrodite'\n\nexport enum FontFamily {\n  MONOSPACE = 'Fira Mono',\n}\n\nexport enum FontSize {\n  LABEL = 10,\n  TITLE = 12,\n  BIG_BUTTON = 36,\n}\n\nexport enum Sizes {\n  MINIMAP_HEIGHT = 100,\n  DETAIL_VIEW_HEIGHT = 150,\n  TOOLTIP_WIDTH_MAX = 900,\n  TOOLTIP_HEIGHT_MAX = 80,\n  SEPARATOR_HEIGHT = 2,\n  FRAME_HEIGHT = 20,\n  TOOLBAR_HEIGHT = 20,\n  TOOLBAR_TAB_HEIGHT = TOOLBAR_HEIGHT - SEPARATOR_HEIGHT,\n}\n\nexport enum Duration {\n  HOVER_CHANGE = '0.07s',\n}\n\nexport enum ZIndex {\n  PROFILE_SELECT = 1,\n  HOVERTIP = 2,\n}\n\nexport const commonStyle = StyleSheet.create({\n  fillY: {\n    height: '100%',\n  },\n  fillX: {\n    width: '100%',\n  },\n  hbox: {\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'relative',\n    overflow: 'hidden',\n  },\n  vbox: {\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'relative',\n    overflow: 'hidden',\n  },\n})\n","import {Profile, Frame, CallTreeNode} from './profile'\nimport {Flamechart, FlamechartFrame} from './flamechart'\nimport {Rect, Vec2} from './math'\n\nexport enum FlamechartType {\n  CHRONO_FLAME_CHART,\n  LEFT_HEAVY_FLAME_GRAPH,\n}\n\n// In previous versions of speedscope, searching for strings within the profile\n// was done using fuzzy finding. As it turns out, this was surprising behavior\n// to most people, so we've switched to a more traditional substring search that\n// more closely mimics browser behavior.\n//\n// This is case insensitive for both the needle & the haystack. This means\n// searching for \"hello\" will match \"Hello\" and \"HELLO\", and searching for\n// \"HELLO\" will match both \"hello\" and \"Hello\". This matches Chrome's behavior\n// as far as I can tell.\n//\n// See https://github.com/jlfwong/speedscope/issues/352\n//\n// Return ranges for all matches in order to highlight them.\nexport function exactMatchStrings(text: string, pattern: string): [number, number][] {\n  const lowerText = text.toLocaleLowerCase()\n  const lowerPattern = pattern.toLocaleLowerCase()\n\n  let lastIndex = 0\n  const matchedRanges: Array<[number, number]> = []\n  while (true) {\n    let index = lowerText.indexOf(lowerPattern, lastIndex)\n    if (index === -1) {\n      return matchedRanges\n    }\n    matchedRanges.push([index, index + pattern.length])\n    lastIndex = index + pattern.length\n  }\n}\n\n// A utility class for storing cached search results to avoid recomputation when\n// the search results & profile did not change.\nexport class ProfileSearchResults {\n  constructor(readonly profile: Profile, readonly searchQuery: string) {}\n\n  private matches: Map<Frame, [number, number][] | null> | null = null\n  getMatchForFrame(frame: Frame): [number, number][] | null {\n    if (!this.matches) {\n      this.matches = new Map()\n      this.profile.forEachFrame(frame => {\n        const match = exactMatchStrings(frame.name, this.searchQuery)\n        this.matches!.set(frame, match.length === 0 ? null : match)\n      })\n    }\n    return this.matches.get(frame) || null\n  }\n}\n\nexport interface FlamechartSearchMatch {\n  configSpaceBounds: Rect\n  node: CallTreeNode\n}\n\ninterface CachedFlamechartResult {\n  matches: FlamechartSearchMatch[]\n  indexForNode: Map<CallTreeNode, number>\n}\n\nexport class FlamechartSearchResults {\n  constructor(readonly flamechart: Flamechart, readonly profileResults: ProfileSearchResults) {}\n\n  private matches: CachedFlamechartResult | null = null\n  private getResults(): CachedFlamechartResult {\n    if (this.matches == null) {\n      const matches: FlamechartSearchMatch[] = []\n      const indexForNode = new Map<CallTreeNode, number>()\n      const visit = (frame: FlamechartFrame, depth: number) => {\n        const {node} = frame\n        if (this.profileResults.getMatchForFrame(node.frame)) {\n          const configSpaceBounds = new Rect(\n            new Vec2(frame.start, depth),\n            new Vec2(frame.end - frame.start, 1),\n          )\n          indexForNode.set(node, matches.length)\n          matches.push({configSpaceBounds, node})\n        }\n\n        frame.children.forEach(child => {\n          visit(child, depth + 1)\n        })\n      }\n\n      const layers = this.flamechart.getLayers()\n      if (layers.length > 0) {\n        layers[0].forEach(frame => visit(frame, 0))\n      }\n\n      this.matches = {matches, indexForNode}\n    }\n    return this.matches\n  }\n\n  count(): number {\n    return this.getResults().matches.length\n  }\n\n  indexOf(node: CallTreeNode): number | null {\n    const result = this.getResults().indexForNode.get(node)\n    return result === undefined ? null : result\n  }\n\n  at(index: number): FlamechartSearchMatch {\n    const matches = this.getResults().matches\n    if (index < 0 || index >= matches.length) {\n      throw new Error(`Index ${index} out of bounds in list of ${matches.length} matches.`)\n    }\n    return matches[index]\n  }\n}\n","import {StyleSheet, css} from 'aphrodite'\nimport {h, createContext, ComponentChildren, Fragment} from 'preact'\nimport {useCallback, useRef, useEffect, useMemo} from 'preact/hooks'\nimport {memo} from 'preact/compat'\nimport {Sizes, FontSize} from './style'\nimport {ProfileSearchResults} from '../lib/profile-search'\nimport {Profile} from '../lib/profile'\nimport {useActiveProfileState} from '../app-state/active-profile-state'\nimport {useTheme, withTheme} from './themes/theme'\nimport {searchIsActiveAtom, searchQueryAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nfunction stopPropagation(ev: Event) {\n  ev.stopPropagation()\n}\n\nexport const ProfileSearchContext = createContext<ProfileSearchResults | null>(null)\n\nexport const ProfileSearchContextProvider = ({children}: {children: ComponentChildren}) => {\n  const activeProfileState = useActiveProfileState()\n  const profile: Profile | null = activeProfileState ? activeProfileState.profile : null\n  const searchIsActive = useAtom(searchIsActiveAtom)\n  const searchQuery = useAtom(searchQueryAtom)\n\n  const searchResults = useMemo(() => {\n    if (!profile || !searchIsActive || searchQuery.length === 0) {\n      return null\n    }\n    return new ProfileSearchResults(profile, searchQuery)\n  }, [searchIsActive, searchQuery, profile])\n\n  return (\n    <ProfileSearchContext.Provider value={searchResults}>{children}</ProfileSearchContext.Provider>\n  )\n}\n\ninterface SearchViewProps {\n  resultIndex: number | null\n  numResults: number | null\n  selectNext: () => void\n  selectPrev: () => void\n}\n\nexport const SearchView = memo(\n  ({numResults, resultIndex, selectNext, selectPrev}: SearchViewProps) => {\n    const theme = useTheme()\n    const style = getStyle(theme)\n    const searchIsActive = useAtom(searchIsActiveAtom)\n    const searchQuery = useAtom(searchQueryAtom)\n    const setSearchQuery = searchQueryAtom.set\n    const setSearchIsActive = searchIsActiveAtom.set\n\n    const onInput = useCallback(\n      (ev: Event) => {\n        const value = (ev.target as HTMLInputElement).value\n        setSearchQuery(value)\n      },\n      [setSearchQuery],\n    )\n\n    const inputRef = useRef<HTMLInputElement | null>(null)\n\n    const close = useCallback(() => setSearchIsActive(false), [setSearchIsActive])\n\n    const selectPrevOrNextResult = useCallback(\n      (ev: KeyboardEvent) => {\n        if (ev.shiftKey) {\n          selectPrev()\n        } else {\n          selectNext()\n        }\n      },\n      [selectPrev, selectNext],\n    )\n\n    const onKeyDown = useCallback(\n      (ev: KeyboardEvent) => {\n        ev.stopPropagation()\n\n        // Hitting Esc should close the search box\n        if (ev.key === 'Escape') {\n          setSearchIsActive(false)\n        }\n\n        if (ev.key === 'Enter') {\n          selectPrevOrNextResult(ev)\n        }\n\n        if (ev.key == 'f' && (ev.metaKey || ev.ctrlKey)) {\n          if (inputRef.current) {\n            // If the input is already focused, select all\n            inputRef.current.select()\n          }\n\n          // It seems like when an input is focused, the browser find menu pops\n          // up without this line. It seems like it's not sufficient to only\n          // preventDefault in the window keydown handler.\n          ev.preventDefault()\n        }\n      },\n      [setSearchIsActive, selectPrevOrNextResult],\n    )\n\n    useEffect(() => {\n      const onWindowKeyDown = (ev: KeyboardEvent) => {\n        // Cmd+F or Ctrl+F open the search box\n        if (ev.key == 'f' && (ev.metaKey || ev.ctrlKey)) {\n          // Prevent the browser's search menu from appearing\n          ev.preventDefault()\n\n          if (inputRef.current) {\n            // If the search box is already open, then re-select it immediately.\n            inputRef.current.select()\n          } else {\n            // Otherwise, focus the search, then focus the input on the next\n            // frame, when the search box should have mounted.\n            setSearchIsActive(true)\n            requestAnimationFrame(() => {\n              if (inputRef.current) {\n                inputRef.current.select()\n              }\n            })\n          }\n        }\n      }\n\n      window.addEventListener('keydown', onWindowKeyDown)\n      return () => {\n        window.removeEventListener('keydown', onWindowKeyDown)\n      }\n    }, [setSearchIsActive])\n\n    if (!searchIsActive) return null\n\n    return (\n      <div className={css(style.searchView)}>\n        <span className={css(style.icon)}>🔍</span>\n        <span className={css(style.inputContainer)}>\n          <input\n            className={css(style.input)}\n            value={searchQuery}\n            onInput={onInput}\n            onKeyDown={onKeyDown}\n            onKeyUp={stopPropagation}\n            onKeyPress={stopPropagation}\n            ref={inputRef}\n          />\n        </span>\n        {numResults != null && (\n          <Fragment>\n            <span className={css(style.resultCount)}>\n              {resultIndex == null ? '?' : resultIndex + 1}/{numResults}\n            </span>\n            <button className={css(style.icon, style.button)} onClick={selectPrev}>\n              ⬅️\n            </button>\n            <button className={css(style.icon, style.button)} onClick={selectNext}>\n              ➡️\n            </button>\n          </Fragment>\n        )}\n        <svg\n          className={css(style.icon)}\n          onClick={close}\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 16 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M4.99999 4.16217L11.6427 10.8048M11.6427 4.16217L4.99999 10.8048\"\n            stroke={theme.altFgSecondaryColor}\n          />\n        </svg>\n      </div>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    searchView: {\n      position: 'absolute',\n      top: 0,\n      right: 10,\n      height: Sizes.TOOLBAR_HEIGHT,\n      width: 16 * 13,\n      borderWidth: 2,\n      borderColor: theme.altFgPrimaryColor,\n      borderStyle: 'solid',\n      fontSize: FontSize.LABEL,\n      boxSizing: 'border-box',\n      background: theme.altBgSecondaryColor,\n      color: theme.altFgPrimaryColor,\n      display: 'flex',\n      alignItems: 'center',\n    },\n    inputContainer: {\n      flexShrink: 1,\n      flexGrow: 1,\n      display: 'flex',\n    },\n    input: {\n      width: '100%',\n      border: 'none',\n      background: 'none',\n      fontSize: FontSize.LABEL,\n      lineHeight: `${Sizes.TOOLBAR_HEIGHT}px`,\n      color: theme.altFgPrimaryColor,\n      ':focus': {\n        border: 'none',\n        outline: 'none',\n      },\n      '::selection': {\n        color: theme.altFgPrimaryColor,\n        background: theme.selectionPrimaryColor,\n      },\n    },\n    resultCount: {\n      verticalAlign: 'middle',\n    },\n    icon: {\n      flexShrink: 0,\n      verticalAlign: 'middle',\n      height: '100%',\n      margin: '0px 2px 0px 2px',\n      fontSize: FontSize.LABEL,\n    },\n    button: {\n      display: 'inline',\n      background: 'none',\n      border: 'none',\n      padding: 0,\n      ':focus': {\n        outline: 'none',\n      },\n    },\n  }),\n)\n","import {FileFormat} from './file-format-spec'\nimport {zeroPad} from './utils'\n\nexport interface ValueFormatter {\n  unit: FileFormat.ValueUnit\n  format(v: number): string\n}\n\nexport class RawValueFormatter implements ValueFormatter {\n  unit: FileFormat.ValueUnit = 'none'\n  format(v: number) {\n    return v.toLocaleString()\n  }\n}\n\nexport class TimeFormatter implements ValueFormatter {\n  private multiplier: number\n\n  constructor(public unit: 'nanoseconds' | 'microseconds' | 'milliseconds' | 'seconds') {\n    if (unit === 'nanoseconds') this.multiplier = 1e-9\n    else if (unit === 'microseconds') this.multiplier = 1e-6\n    else if (unit === 'milliseconds') this.multiplier = 1e-3\n    else this.multiplier = 1\n  }\n\n  formatUnsigned(v: number) {\n    const s = v * this.multiplier\n\n    if (s / 60 >= 1) {\n      const minutes = Math.floor(s / 60)\n      const seconds = Math.floor(s - minutes * 60).toString()\n      return `${minutes}:${zeroPad(seconds, 2)}`\n    }\n    if (s / 1 >= 1) return `${s.toFixed(2)}s`\n    if (s / 1e-3 >= 1) return `${(s / 1e-3).toFixed(2)}ms`\n    if (s / 1e-6 >= 1) return `${(s / 1e-6).toFixed(2)}µs`\n    else return `${(s / 1e-9).toFixed(2)}ns`\n  }\n\n  format(v: number) {\n    return `${v < 0 ? '-' : ''}${this.formatUnsigned(Math.abs(v))}`\n  }\n}\n\nexport class ByteFormatter implements ValueFormatter {\n  unit: FileFormat.ValueUnit = 'bytes'\n\n  format(v: number) {\n    if (v < 1024) return `${v.toFixed(0)} B`\n    v /= 1024\n    if (v < 1024) return `${v.toFixed(2)} KB`\n    v /= 1024\n    if (v < 1024) return `${v.toFixed(2)} MB`\n    v /= 1024\n    return `${v.toFixed(2)} GB`\n  }\n}\n","import {lastOf, KeyedSet} from './utils'\nimport {ValueFormatter, RawValueFormatter} from './value-formatters'\nimport {FileFormat} from './file-format-spec'\nconst demangleCppModule = import('./demangle-cpp')\n\nexport interface FrameInfo {\n  color_key: string | number\n\n  key: string | number\n\n  // Name of the frame. May be a method name, e.g.\n  // \"ActiveRecord##to_hash\"\n  name: string\n\n  // File path of the code corresponding to this\n  // call stack frame.\n  file?: string\n\n  // Line in the given file where this frame occurs, 1-based.\n  line?: number\n\n  // Column in the file, 1-based.\n  col?: number\n}\n\nexport type SymbolRemapper = (\n  frame: Frame,\n) => {name?: string; file?: string; line?: number; col?: number} | null\n\nexport class HasWeights {\n  private selfWeight = 0\n  private totalWeight = 0\n  getSelfWeight() {\n    return this.selfWeight\n  }\n  getTotalWeight() {\n    return this.totalWeight\n  }\n  addToTotalWeight(delta: number) {\n    this.totalWeight += delta\n  }\n  addToSelfWeight(delta: number) {\n    this.selfWeight += delta\n  }\n\n  overwriteWeightWith(other: HasWeights) {\n    this.selfWeight = other.selfWeight\n    this.totalWeight = other.totalWeight\n  }\n}\n\nexport class Frame extends HasWeights {\n  color_key: string | number\n\n  key: string | number\n\n  // Name of the frame. May be a method name, e.g.\n  // \"ActiveRecord##to_hash\"\n  name: string\n\n  // File path of the code corresponding to this\n  // call stack frame.\n  file?: string\n\n  // Line in the given file where this frame occurs\n  line?: number\n\n  // Column in the file\n  col?: number\n\n  public constructor(info: FrameInfo) {\n    super()\n    this.color_key = info.color_key\n    this.key = info.key\n    this.name = info.name\n    this.file = info.file\n    this.line = info.line\n    this.col = info.col\n  }\n\n  static root = new Frame({\n    color_key: \"Root\",\n    key: '(speedscope root)',\n    name: '(speedscope root)',\n  })\n\n  static getOrInsert(set: KeyedSet<Frame>, info: FrameInfo) {\n    return set.getOrInsert(new Frame(info))\n  }\n}\n\nexport class CallTreeNode extends HasWeights {\n  children: CallTreeNode[] = []\n\n  isRoot() {\n    return this.frame === Frame.root\n  }\n\n  // If a node is \"frozen\", it means it should no longer be mutated.\n  private frozen = false\n  isFrozen() {\n    return this.frozen\n  }\n  freeze() {\n    this.frozen = true\n  }\n\n  constructor(public frame: Frame, readonly parent: CallTreeNode | null) {\n    super()\n  }\n}\n\nexport interface ProfileGroup {\n  name: string\n  profile: Profile\n}\n\n\nexport class Profile {\n  protected name: string = ''\n\n  protected totalWeight: number\n\n  public frames = new KeyedSet<Frame>()\n\n  // Profiles store two call-trees.\n  //\n  // The \"append order\" call tree is the one in which nodes are ordered in\n  // whatever order they were appended to their parent.\n  //\n  // The \"grouped\" call tree is one in which each node has at most one child per\n  // frame. Nodes are ordered in decreasing order of weight\n  protected appendOrderCalltreeRoot = new CallTreeNode(Frame.root, null)\n  protected groupedCalltreeRoot = new CallTreeNode(Frame.root, null)\n\n  public getAppendOrderCalltreeRoot() {\n    return this.appendOrderCalltreeRoot\n  }\n  public getGroupedCalltreeRoot() {\n    return this.groupedCalltreeRoot\n  }\n\n  // List of references to CallTreeNodes at the top of the\n  // stack at the time of the sample.\n  public samples: CallTreeNode[] = []\n  public weights: number[] = []\n\n  protected valueFormatter: ValueFormatter = new RawValueFormatter()\n\n  constructor(totalWeight: number = 0) {\n    this.totalWeight = totalWeight\n  }\n\n  shallowClone(): Profile {\n    const profile = new Profile(this.totalWeight)\n    Object.assign(profile, this)\n    return profile\n  }\n\n  formatValue(v: number) {\n    return this.valueFormatter.format(v)\n  }\n  setValueFormatter(f: ValueFormatter) {\n    this.valueFormatter = f\n  }\n  getWeightUnit(): FileFormat.ValueUnit {\n    return this.valueFormatter.unit\n  }\n\n  getName() {\n    return this.name\n  }\n  setName(name: string) {\n    this.name = name\n  }\n\n  getTotalWeight() {\n    return this.totalWeight\n  }\n\n  private totalNonIdleWeight: number | null = null\n  getTotalNonIdleWeight() {\n    if (this.totalNonIdleWeight === null) {\n      this.totalNonIdleWeight = this.groupedCalltreeRoot.children.reduce(\n        (n, c) => n + c.getTotalWeight(),\n        0,\n      )\n    }\n    return this.totalNonIdleWeight\n  }\n\n  // This is private because it should only be called in the ProfileBuilder\n  // classes. Once a Profile instance has been constructed, it should be treated\n  // as immutable.\n  protected sortGroupedCallTree() {\n    function visit(node: CallTreeNode) {\n      node.children.sort((a, b) => -(a.getTotalWeight() - b.getTotalWeight()))\n      node.children.forEach(visit)\n    }\n    visit(this.groupedCalltreeRoot)\n  }\n\n  forEachCallGrouped(\n    openFrame: (node: CallTreeNode, value: number) => void,\n    closeFrame: (node: CallTreeNode, value: number) => void,\n  ) {\n    function visit(node: CallTreeNode, start: number) {\n      if (node.frame !== Frame.root) {\n        openFrame(node, start)\n      }\n\n      let childTime = 0\n\n      node.children.forEach(function (child) {\n        visit(child, start + childTime)\n        childTime += child.getTotalWeight()\n      })\n\n      if (node.frame !== Frame.root) {\n        closeFrame(node, start + node.getTotalWeight())\n      }\n    }\n    visit(this.groupedCalltreeRoot, 0)\n  }\n\n  forEachCall(\n    openFrame: (node: CallTreeNode, value: number) => void,\n    closeFrame: (node: CallTreeNode, value: number) => void,\n  ) {\n    let prevStack: CallTreeNode[] = []\n    let value = 0\n\n    let sampleIndex = 0\n    for (let stackTop of this.samples) {\n      // Find lowest common ancestor of the current stack and the previous one\n      let lca: CallTreeNode | null = null\n\n      // This is O(n^2), but n should be relatively small here (stack height),\n      // so hopefully this isn't much of a problem\n      for (\n        lca = stackTop;\n        lca && lca.frame != Frame.root && prevStack.indexOf(lca) === -1;\n        lca = lca.parent\n      ) {}\n\n      // Close frames that are no longer open\n      while (prevStack.length > 0 && lastOf(prevStack) != lca) {\n        const node = prevStack.pop()!\n        closeFrame(node, value)\n      }\n\n      // Open frames that are now becoming open\n      const toOpen: CallTreeNode[] = []\n      for (\n        let node: CallTreeNode | null = stackTop;\n        node && node.frame != Frame.root && node != lca;\n        node = node.parent\n      ) {\n        toOpen.push(node)\n      }\n      toOpen.reverse()\n\n      for (let node of toOpen) {\n        openFrame(node, value)\n      }\n\n      prevStack = prevStack.concat(toOpen)\n      value += this.weights[sampleIndex++]\n    }\n\n    // Close frames that are open at the end of the trace\n    for (let i = prevStack.length - 1; i >= 0; i--) {\n      closeFrame(prevStack[i], value)\n    }\n  }\n\n  forEachFrame(fn: (frame: Frame) => void) {\n    this.frames.forEach(fn)\n  }\n\n  // getProfileWithRecursionFlattened(): Profile {\n  //   const builder = new CallTreeProfileBuilder()\n\n  //   const stack: (CallTreeNode | null)[] = []\n  //   const framesInStack = new Set<Frame>()\n\n  //   function openFrame(node: CallTreeNode, value: number) {\n  //     if (framesInStack.has(node.frame)) {\n  //       stack.push(null)\n  //     } else {\n  //       framesInStack.add(node.frame)\n  //       stack.push(node)\n  //       builder.enterFrame(node.frame, value)\n  //     }\n  //   }\n  //   function closeFrame(node: CallTreeNode, value: number) {\n  //     const stackTop = stack.pop()\n  //     if (stackTop) {\n  //       framesInStack.delete(stackTop.frame)\n  //       builder.leaveFrame(stackTop.frame, value)\n  //     }\n  //   }\n\n  //   this.forEachCall(openFrame, closeFrame)\n\n  //   const flattenedProfile = builder.build()\n  //   flattenedProfile.name = this.name\n  //   flattenedProfile.valueFormatter = this.valueFormatter\n\n  //   // When constructing a profile with recursion flattened,\n  //   // counter-intuitive things can happen to \"self time\" measurements\n  //   // for functions.\n  //   // For example, given the following list of stacks w/ weights:\n  //   //\n  //   // a 1\n  //   // a;b;a 1\n  //   // a;b;a;b;a 1\n  //   // a;b;a 1\n  //   //\n  //   // The resulting profile with recursion flattened out will look like this:\n  //   //\n  //   // a 1\n  //   // a;b 3\n  //   //\n  //   // Which is useful to view, but it's counter-intuitive to move self-time\n  //   // for frames around, since analyzing the self-time of functions is an important\n  //   // thing to be able to do accurately, and we don't want this to change when recursion\n  //   // is flattened. To work around that, we'll just copy the weights directly from the\n  //   // un-flattened profile.\n  //   this.forEachFrame(f => {\n  //     flattenedProfile.frames.getOrInsert(f).overwriteWeightWith(f)\n  //   })\n\n  //   return flattenedProfile\n  // }\n\n  getInvertedProfileForCallersOf(focalFrameInfo: FrameInfo): Profile {\n    const focalFrame = Frame.getOrInsert(this.frames, focalFrameInfo)\n    const builder = new StackListProfileBuilder()\n\n    // TODO(jlfwong): Could construct this at profile\n    // construction time rather than on demand.\n    const nodes: CallTreeNode[] = []\n\n    function visit(node: CallTreeNode) {\n      if (node.frame === focalFrame) {\n        nodes.push(node)\n      } else {\n        for (let child of node.children) {\n          visit(child)\n        }\n      }\n    }\n\n    visit(this.appendOrderCalltreeRoot)\n\n    for (let node of nodes) {\n      const stack: FrameInfo[] = []\n      for (let n: CallTreeNode | null = node; n != null && n.frame !== Frame.root; n = n.parent) {\n        stack.push(n.frame)\n      }\n      builder.appendSampleWithWeight(stack, node.getTotalWeight())\n    }\n\n    const ret = builder.build()\n    ret.name = this.name\n    ret.valueFormatter = this.valueFormatter\n    return ret\n  }\n\n  getProfileForCalleesOf(focalFrameInfo: FrameInfo): Profile {\n    const focalFrame = Frame.getOrInsert(this.frames, focalFrameInfo)\n    const builder = new StackListProfileBuilder()\n\n    function recordSubtree(focalFrameNode: CallTreeNode) {\n      const stack: FrameInfo[] = []\n\n      function visit(node: CallTreeNode) {\n        stack.push(node.frame)\n        builder.appendSampleWithWeight(stack, node.getSelfWeight())\n        for (let child of node.children) {\n          visit(child)\n        }\n        stack.pop()\n      }\n\n      visit(focalFrameNode)\n    }\n\n    function findCalls(node: CallTreeNode) {\n      if (node.frame === focalFrame) {\n        recordSubtree(node)\n      } else {\n        for (let child of node.children) {\n          findCalls(child)\n        }\n      }\n    }\n\n    findCalls(this.appendOrderCalltreeRoot)\n\n    const ret = builder.build()\n    ret.name = this.name\n    ret.valueFormatter = this.valueFormatter\n    return ret\n  }\n\n  // Demangle symbols for readability\n  async demangle() {\n    let demangleCpp: ((name: string) => string) | null = null\n\n    for (let frame of this.frames) {\n      // This function converts a mangled C++ name such as \"__ZNK7Support6ColorFeqERKS0_\"\n      // into a human-readable symbol (in this case \"Support::ColorF::==(Support::ColorF&)\")\n      if (frame.name.startsWith('__Z')) {\n        if (!demangleCpp) {\n          demangleCpp = (await demangleCppModule).demangleCpp\n        }\n        frame.name = demangleCpp(frame.name)\n      }\n    }\n  }\n\n  remapSymbols(callback: SymbolRemapper) {\n    for (let frame of this.frames) {\n      const remapped = callback(frame)\n      if (remapped == null) {\n        continue\n      }\n      const {name, file, line, col} = remapped\n      if (name != null) {\n        frame.name = name\n      }\n      if (file != null) {\n        frame.file = file\n      }\n      if (line != null) {\n        frame.line = line\n      }\n      if (col != null) {\n        frame.col = col\n      }\n    }\n  }\n}\n\n\nexport class StackListProfileBuilder extends Profile {\n  _appendSample(stack: FrameInfo[], weight: number, useAppendOrder: boolean) {\n    if (isNaN(weight)) throw new Error('invalid weight')\n    let node = useAppendOrder ? this.appendOrderCalltreeRoot : this.groupedCalltreeRoot\n\n    let framesInStack = new Set<Frame>()\n\n    for (let frameInfo of stack) {\n      const frame = Frame.getOrInsert(this.frames, frameInfo)\n      const last = useAppendOrder\n        ? lastOf(node.children)\n        : node.children.find(c => c.frame === frame)\n      if (last && !last.isFrozen() && last.frame == frame) {\n        node = last\n      } else {\n        const parent = node\n        node = new CallTreeNode(frame, node)\n        parent.children.push(node)\n      }\n      node.addToTotalWeight(weight)\n\n      // It's possible for the same frame to occur multiple\n      // times in the same call stack due to either direct\n      // or indirect recursion. We want to avoid counting that\n      // frame multiple times for a single sample, we so just\n      // track all of the unique frames that participated in\n      // this call stack, then add to their weight at the end.\n      framesInStack.add(node.frame)\n    }\n    node.addToSelfWeight(weight)\n\n    if (useAppendOrder) {\n      for (let child of node.children) {\n        child.freeze()\n      }\n    }\n\n    if (useAppendOrder) {\n      node.frame.addToSelfWeight(weight)\n\n      for (let frame of framesInStack) {\n        frame.addToTotalWeight(weight)\n      }\n\n      if (node === lastOf(this.samples)) {\n        this.weights[this.weights.length - 1] += weight\n      } else {\n        this.samples.push(node)\n        this.weights.push(weight)\n      }\n    }\n  }\n\n  appendSampleWithWeight(stack: FrameInfo[], weight: number) {\n    if (weight === 0) {\n      // Samples with zero weight have no effect, so let's ignore them\n      return\n    }\n    if (weight < 0) {\n      throw new Error('Samples must have positive weights')\n    }\n\n    this._appendSample(stack, weight, true)\n    this._appendSample(stack, weight, false)\n  }\n\n  private pendingSample: {\n    stack: FrameInfo[]\n    startTimestamp: number\n    centralTimestamp: number\n  } | null = null\n  appendSampleWithTimestamp(stack: FrameInfo[], timestamp: number) {\n    if (this.pendingSample) {\n      if (timestamp < this.pendingSample.centralTimestamp) {\n        throw new Error('Timestamps received out of order')\n      }\n      const endTimestamp = (timestamp + this.pendingSample.centralTimestamp) / 2\n      this.appendSampleWithWeight(\n        this.pendingSample.stack,\n        endTimestamp - this.pendingSample.startTimestamp,\n      )\n      this.pendingSample = {stack, startTimestamp: endTimestamp, centralTimestamp: timestamp}\n    } else {\n      this.pendingSample = {stack, startTimestamp: timestamp, centralTimestamp: timestamp}\n    }\n  }\n\n  build(): Profile {\n    if (this.pendingSample) {\n      if (this.samples.length > 0) {\n        this.appendSampleWithWeight(\n          this.pendingSample.stack,\n          this.pendingSample.centralTimestamp - this.pendingSample.startTimestamp,\n        )\n      } else {\n        // There is only a single sample. In this case, units will be meaningless,\n        // so we'll append with a weight of 1 and also clear any value formatter\n        this.appendSampleWithWeight(this.pendingSample.stack, 1)\n        this.setValueFormatter(new RawValueFormatter())\n      }\n    }\n    this.totalWeight = Math.max(\n      this.totalWeight,\n      this.weights.reduce((a, b) => a + b, 0),\n    )\n    this.sortGroupedCallTree()\n    return this\n  }\n}\n","import {h} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\nimport {FontSize} from './style'\nimport {useTheme, withTheme} from './themes/theme'\n\ninterface ColorChitProps {\n  color: string\n}\n\nexport function ColorChit(props: ColorChitProps) {\n  const style = getStyle(useTheme())\n  return <span className={css(style.stackChit)} style={{backgroundColor: props.color}} />\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    stackChit: {\n      position: 'relative',\n      top: -1,\n      display: 'inline-block',\n      verticalAlign: 'middle',\n      marginRight: '0.5em',\n      border: `1px solid ${theme.fgSecondaryColor}`,\n      width: FontSize.LABEL - 2,\n      height: FontSize.LABEL - 2,\n    },\n  }),\n)\n","// A simple implementation of an efficient scrolling list view which\n// renders only items within the viewport + a couple extra items.\n\nimport {h, JSX} from 'preact'\nimport {useState, useCallback, useRef, useMemo, useEffect} from 'preact/hooks'\n\nexport interface ListItem {\n  size: number\n}\n\ninterface RangeResult {\n  firstVisibleIndex: number\n  lastVisibleIndex: number\n  invisiblePrefixSize: number\n}\n\ninterface ScrollableListViewProps {\n  items: ListItem[]\n  axis: 'x' | 'y'\n  renderItems: (\n    firstVisibleIndex: number,\n    lastVisibleIndex: number,\n  ) => JSX.Element | JSX.Element[] | null\n  className?: string\n  initialIndexInView?: number | null\n}\n\nexport const ScrollableListView = ({\n  items,\n  axis,\n  renderItems,\n  className,\n  initialIndexInView,\n}: ScrollableListViewProps) => {\n  const [viewportSize, setViewportSize] = useState<number | null>(null)\n  const [viewportScrollOffset, setViewportScrollOffset] = useState<number>(0)\n\n  const viewportRef = useRef<HTMLDivElement | null>(null)\n\n  const widthOrHeight = axis === 'x' ? 'width' : 'height'\n  const leftOrTop = axis === 'x' ? 'left' : 'top'\n  const scrollLeftOrScrollTop = axis === 'x' ? 'scrollLeft' : 'scrollTop'\n\n  // This is kind of a weird hack, but I'm not sure what the better of doing something like this is.\n  const offset = initialIndexInView\n    ? items.reduce((a, b, i) => (i < initialIndexInView ? a + b.size : a), 0)\n    : 0\n  const initialScroll = useRef<number | null>(offset)\n\n  const viewportCallback = useCallback(\n    (viewport: HTMLDivElement | null) => {\n      if (viewport) {\n        requestAnimationFrame(() => {\n          setViewportSize(viewport.getBoundingClientRect()[widthOrHeight])\n          if (initialScroll.current != null) {\n            viewport.scrollTo({[leftOrTop]: initialScroll.current})\n            initialScroll.current = null\n          }\n        })\n      } else {\n        setViewportSize(null)\n      }\n      viewportRef.current = viewport\n    },\n    [setViewportSize, widthOrHeight, leftOrTop],\n  )\n\n  const rangeResult: RangeResult | null = useMemo(() => {\n    if (viewportRef.current == null || viewportSize == null || viewportScrollOffset == null) {\n      return null\n    }\n\n    // We render items up to a quarter viewport height outside of the\n    // viewport both above and below to prevent flickering.\n    const minY = viewportScrollOffset - viewportSize / 4\n    const maxY = viewportScrollOffset + viewportSize + viewportSize / 4\n\n    let total = 0\n    let invisiblePrefixSize = 0\n\n    let i = 0\n    for (; i < items.length; i++) {\n      const item = items[i]\n      invisiblePrefixSize = total\n      total += item.size\n      if (total >= minY) {\n        break\n      }\n    }\n\n    const firstVisibleIndex = i\n\n    for (; i < items.length; i++) {\n      const item = items[i]\n      total += item.size\n      if (total >= maxY) {\n        break\n      }\n    }\n\n    const lastVisibleIndex = Math.min(i, items.length - 1)\n\n    return {\n      firstVisibleIndex,\n      lastVisibleIndex,\n      invisiblePrefixSize,\n    }\n  }, [viewportSize, viewportScrollOffset, items])\n\n  const totalSize = useMemo(() => items.reduce((a, b) => a + b.size, 0), [items])\n\n  const onViewportScroll = useCallback(() => {\n    if (viewportRef.current != null) {\n      setViewportScrollOffset(viewportRef.current[scrollLeftOrScrollTop])\n    }\n  }, [scrollLeftOrScrollTop])\n\n  useEffect(() => {\n    const resizeListener = () => {\n      if (viewportRef.current != null) {\n        setViewportSize(viewportRef.current.getBoundingClientRect()[widthOrHeight])\n      }\n    }\n\n    window.addEventListener('resize', resizeListener)\n    return () => {\n      window.removeEventListener('resize', resizeListener)\n    }\n  }, [widthOrHeight])\n\n  const visibleItems = useMemo(() => {\n    return rangeResult\n      ? renderItems(rangeResult.firstVisibleIndex, rangeResult.lastVisibleIndex)\n      : null\n  }, [renderItems, rangeResult])\n\n  const content = useMemo(() => {\n    return (\n      <div style={{height: totalSize}}>\n        <div style={{transform: `translateY(${rangeResult?.invisiblePrefixSize || 0}px)`}}>\n          {visibleItems}\n        </div>\n      </div>\n    )\n  }, [rangeResult, visibleItems, totalSize])\n\n  return (\n    <div className={className} ref={viewportCallback} onScroll={onViewportScroll}>\n      {content}\n    </div>\n  )\n}\n","import {h, JSX, ComponentChild} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\nimport {Profile, Frame} from '../lib/profile'\nimport {formatPercent} from '../lib/utils'\nimport {FontSize, Sizes, commonStyle} from './style'\nimport {ColorChit} from './color-chit'\nimport {ListItem, ScrollableListView} from './scrollable-list-view'\nimport {createGetCSSColorForFrame, getFrameToColorBucket} from '../app-state/getters'\nimport {memo} from 'preact/compat'\nimport {useCallback, useMemo, useContext} from 'preact/hooks'\nimport {SandwichViewContext} from './sandwich-view'\nimport {Color} from '../lib/color'\nimport {useTheme, withTheme} from './themes/theme'\nimport {\n  SortDirection,\n  SortMethod,\n  SortField,\n  profileGroupAtom,\n  tableSortMethodAtom,\n  searchIsActiveAtom,\n  searchQueryAtom,\n} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\n\ninterface HBarProps {\n  perc: number\n}\n\nfunction HBarDisplay(props: HBarProps) {\n  const style = getStyle(useTheme())\n\n  return (\n    <div className={css(style.hBarDisplay)}>\n      <div className={css(style.hBarDisplayFilled)} style={{width: `${props.perc}%`}} />\n    </div>\n  )\n}\n\ninterface SortIconProps {\n  activeDirection: SortDirection | null\n}\n\nfunction SortIcon(props: SortIconProps) {\n  const theme = useTheme()\n  const style = getStyle(theme)\n\n  const {activeDirection} = props\n  const upFill =\n    activeDirection === SortDirection.ASCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n  const downFill =\n    activeDirection === SortDirection.DESCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n\n  return (\n    <svg\n      width=\"8\"\n      height=\"10\"\n      viewBox=\"0 0 8 10\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className={css(style.sortIcon)}\n    >\n      <path d=\"M0 4L4 0L8 4H0Z\" fill={upFill} />\n      <path d=\"M0 4L4 0L8 4H0Z\" transform=\"translate(0 10) scale(1 -1)\" fill={downFill} />\n    </svg>\n  )\n}\n\ninterface ProfileTableRowViewProps {\n  frame: Frame\n  matchedRanges: [number, number][] | null\n  index: number\n  profile: Profile\n  selectedFrame: Frame | null\n  setSelectedFrame: (f: Frame) => void\n  getCSSColorForFrame: (frame: Frame) => string\n}\n\nfunction highlightRanges(\n  text: string,\n  ranges: [number, number][],\n  highlightedClassName: string,\n): JSX.Element {\n  const spans: ComponentChild[] = []\n  let last = 0\n  for (let range of ranges) {\n    spans.push(text.slice(last, range[0]))\n    spans.push(<span className={highlightedClassName}>{text.slice(range[0], range[1])}</span>)\n    last = range[1]\n  }\n  spans.push(text.slice(last))\n\n  return <span>{spans}</span>\n}\n\nconst ProfileTableRowView = ({\n  frame,\n  matchedRanges,\n  profile,\n  index,\n  selectedFrame,\n  setSelectedFrame,\n  getCSSColorForFrame,\n}: ProfileTableRowViewProps) => {\n  const style = getStyle(useTheme())\n\n  const totalWeight = frame.getTotalWeight()\n  const selfWeight = frame.getSelfWeight()\n  const totalPerc = (100.0 * totalWeight) / profile.getTotalNonIdleWeight()\n  const selfPerc = (100.0 * selfWeight) / profile.getTotalNonIdleWeight()\n\n  const selected = frame === selectedFrame\n\n  // We intentionally use index rather than frame.key here as the tr key\n  // in order to re-use rows when sorting rather than creating all new elements.\n  return (\n    <tr\n      key={`${index}`}\n      onClick={setSelectedFrame.bind(null, frame)}\n      className={css(\n        style.tableRow,\n        index % 2 == 0 && style.tableRowEven,\n        selected && style.tableRowSelected,\n      )}\n    >\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(totalWeight)} ({formatPercent(totalPerc)})\n        <HBarDisplay perc={totalPerc} />\n      </td>\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(selfWeight)} ({formatPercent(selfPerc)})\n        <HBarDisplay perc={selfPerc} />\n      </td>\n      <td title={frame.file} className={css(style.textCell)}>\n        <ColorChit color={getCSSColorForFrame(frame)} />\n        {matchedRanges\n          ? highlightRanges(\n              frame.name,\n              matchedRanges,\n              css(style.matched, selected && style.matchedSelected),\n            )\n          : frame.name}\n      </td>\n    </tr>\n  )\n}\n\ninterface ProfileTableViewProps {\n  profile: Profile\n  selectedFrame: Frame | null\n  getCSSColorForFrame: (frame: Frame) => string\n  sortMethod: SortMethod\n  setSelectedFrame: (frame: Frame | null) => void\n  setSortMethod: (sortMethod: SortMethod) => void\n  searchQuery: string\n  searchIsActive: boolean\n}\n\nexport const ProfileTableView = memo(\n  ({\n    profile,\n    sortMethod,\n    setSortMethod,\n    selectedFrame,\n    setSelectedFrame,\n    getCSSColorForFrame,\n    searchQuery,\n    searchIsActive,\n  }: ProfileTableViewProps) => {\n    const style = getStyle(useTheme())\n\n    const onSortClick = useCallback(\n      (field: SortField, ev: MouseEvent) => {\n        ev.preventDefault()\n\n        if (sortMethod.field == field) {\n          // Toggle\n          setSortMethod({\n            field,\n            direction:\n              sortMethod.direction === SortDirection.ASCENDING\n                ? SortDirection.DESCENDING\n                : SortDirection.ASCENDING,\n          })\n        } else {\n          // Set a sane default\n          switch (field) {\n            case SortField.SYMBOL_NAME: {\n              setSortMethod({field, direction: SortDirection.ASCENDING})\n              break\n            }\n            case SortField.SELF: {\n              setSortMethod({field, direction: SortDirection.DESCENDING})\n              break\n            }\n            case SortField.TOTAL: {\n              setSortMethod({field, direction: SortDirection.DESCENDING})\n              break\n            }\n          }\n        }\n      },\n      [sortMethod, setSortMethod],\n    )\n\n    const sandwichContext = useContext(SandwichViewContext)\n\n    const renderItems = useCallback(\n      (firstIndex: number, lastIndex: number) => {\n        if (!sandwichContext) return null\n\n        const rows: JSX.Element[] = []\n\n        for (let i = firstIndex; i <= lastIndex; i++) {\n          const frame = sandwichContext.rowList[i]\n          const match = sandwichContext.getSearchMatchForFrame(frame)\n          rows.push(\n            ProfileTableRowView({\n              frame,\n              matchedRanges: match == null ? null : match,\n              index: i,\n              profile: profile,\n              selectedFrame: selectedFrame,\n              setSelectedFrame: setSelectedFrame,\n              getCSSColorForFrame: getCSSColorForFrame,\n            }),\n          )\n        }\n\n        if (rows.length === 0) {\n          if (searchIsActive) {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>\n                  No symbol names match query \"{searchQuery}\".\n                </td>\n              </tr>,\n            )\n          } else {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>No symbols found.</td>\n              </tr>,\n            )\n          }\n        }\n\n        return <table className={css(style.tableView)}>{rows}</table>\n      },\n      [\n        sandwichContext,\n        profile,\n        selectedFrame,\n        setSelectedFrame,\n        getCSSColorForFrame,\n        searchIsActive,\n        searchQuery,\n        style.emptyState,\n        style.tableView,\n      ],\n    )\n\n    const listItems: ListItem[] = useMemo(\n      () =>\n        sandwichContext == null\n          ? []\n          : sandwichContext.rowList.map(f => ({size: Sizes.FRAME_HEIGHT})),\n      [sandwichContext],\n    )\n\n    const onTotalClick = useCallback((ev: MouseEvent) => onSortClick(SortField.TOTAL, ev), [\n      onSortClick,\n    ])\n    const onSelfClick = useCallback((ev: MouseEvent) => onSortClick(SortField.SELF, ev), [\n      onSortClick,\n    ])\n    const onSymbolNameClick = useCallback(\n      (ev: MouseEvent) => onSortClick(SortField.SYMBOL_NAME, ev),\n      [onSortClick],\n    )\n\n    return (\n      <div className={css(commonStyle.vbox, style.profileTableView)}>\n        <table className={css(style.tableView)}>\n          <thead className={css(style.tableHeader)}>\n            <tr>\n              <th className={css(style.numericCell)} onClick={onTotalClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.TOTAL ? sortMethod.direction : null\n                  }\n                />\n                Total\n              </th>\n              <th className={css(style.numericCell)} onClick={onSelfClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.SELF ? sortMethod.direction : null\n                  }\n                />\n                Self\n              </th>\n              <th className={css(style.textCell)} onClick={onSymbolNameClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.SYMBOL_NAME ? sortMethod.direction : null\n                  }\n                />\n                Symbol Name\n              </th>\n            </tr>\n          </thead>\n        </table>\n        <ScrollableListView\n          axis={'y'}\n          items={listItems}\n          className={css(style.scrollView)}\n          renderItems={renderItems}\n          initialIndexInView={\n            selectedFrame == null ? null : sandwichContext?.getIndexForFrame(selectedFrame)\n          }\n        />\n      </div>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    profileTableView: {\n      background: theme.bgPrimaryColor,\n      height: '100%',\n    },\n    scrollView: {\n      overflowY: 'auto',\n      overflowX: 'hidden',\n      flexGrow: 1,\n      '::-webkit-scrollbar': {\n        background: theme.bgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.fgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.bgPrimaryColor}`,\n        ':hover': {\n          background: theme.fgPrimaryColor,\n        },\n      },\n    },\n    tableView: {\n      width: '100%',\n      fontSize: FontSize.LABEL,\n      background: theme.bgPrimaryColor,\n    },\n    tableHeader: {\n      borderBottom: `2px solid ${theme.bgSecondaryColor}`,\n      textAlign: 'left',\n      color: theme.fgPrimaryColor,\n      userSelect: 'none',\n    },\n    sortIcon: {\n      position: 'relative',\n      top: 1,\n      marginRight: Sizes.FRAME_HEIGHT / 4,\n    },\n    tableRow: {\n      background: theme.bgPrimaryColor,\n      height: Sizes.FRAME_HEIGHT,\n    },\n    tableRowEven: {\n      background: theme.bgSecondaryColor,\n    },\n    tableRowSelected: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    numericCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      position: 'relative',\n      textAlign: 'right',\n      paddingRight: Sizes.FRAME_HEIGHT,\n      width: 6 * Sizes.FRAME_HEIGHT,\n      minWidth: 6 * Sizes.FRAME_HEIGHT,\n    },\n    textCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      width: '100%',\n      maxWidth: 0,\n    },\n    hBarDisplay: {\n      position: 'absolute',\n      background: Color.fromCSSHex(theme.weightColor).withAlpha(0.2).toCSS(),\n      bottom: 2,\n      height: 2,\n      width: `calc(100% - ${2 * Sizes.FRAME_HEIGHT}px)`,\n      right: Sizes.FRAME_HEIGHT,\n    },\n    hBarDisplayFilled: {\n      height: '100%',\n      position: 'absolute',\n      background: theme.weightColor,\n      right: 0,\n    },\n    matched: {\n      borderBottom: `2px solid ${theme.fgPrimaryColor}`,\n    },\n    matchedSelected: {\n      borderColor: theme.altFgPrimaryColor,\n    },\n    emptyState: {\n      textAlign: 'center',\n      fontWeight: 'bold',\n    },\n  }),\n)\n\ninterface ProfileTableViewContainerProps {\n  activeProfileState: ActiveProfileState\n}\n\nexport const ProfileTableViewContainer = memo((ownProps: ProfileTableViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  const {profile, sandwichViewState} = activeProfileState\n  if (!profile) throw new Error('profile missing')\n  const tableSortMethod = useAtom(tableSortMethodAtom)\n  const theme = useTheme()\n  const {callerCallee} = sandwichViewState\n  const selectedFrame = callerCallee ? callerCallee.selectedFrame : null\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const setSelectedFrame = useCallback((selectedFrame: Frame | null) => {\n    profileGroupAtom.setSelectedFrame(selectedFrame)\n  }, [])\n  const searchIsActive = useAtom(searchIsActiveAtom)\n  const searchQuery = useAtom(searchQueryAtom)\n\n  return (\n    <ProfileTableView\n      profile={profile}\n      selectedFrame={selectedFrame}\n      getCSSColorForFrame={getCSSColorForFrame}\n      sortMethod={tableSortMethod}\n      setSelectedFrame={setSelectedFrame}\n      setSortMethod={tableSortMethodAtom.set}\n      searchIsActive={searchIsActive}\n      searchQuery={searchQuery}\n    />\n  )\n})\n","import {Frame, CallTreeNode} from './profile'\n\nimport {lastOf} from './utils'\nimport {clamp, Rect, Vec2} from './math'\n\nexport interface FlamechartFrame {\n  node: CallTreeNode\n  start: number\n  end: number\n  parent: FlamechartFrame | null\n  children: FlamechartFrame[]\n}\n\ntype StackLayer = FlamechartFrame[]\n\ninterface FlamechartDataSource {\n  getTotalWeight(): number\n\n  formatValue(v: number): string\n\n  forEachCall(\n    openFrame: (node: CallTreeNode, value: number) => void,\n    closeFrame: (node: CallTreeNode, value: number) => void,\n  ): void\n\n  getColorBucketForFrame(f: Frame): number\n}\n\nexport class Flamechart {\n  // Bottom to top\n  private layers: StackLayer[] = []\n  private totalWeight: number = 0\n  private minFrameWidth: number = 1\n\n  getTotalWeight() {\n    return this.totalWeight\n  }\n  getLayers() {\n    return this.layers\n  }\n  getColorBucketForFrame(frame: Frame) {\n    return this.source.getColorBucketForFrame(frame)\n  }\n  getMinFrameWidth() {\n    return this.minFrameWidth\n  }\n  formatValue(v: number) {\n    return this.source.formatValue(v)\n  }\n\n  getClampedViewportWidth(viewportWidth: number) {\n    const maxWidth = this.getTotalWeight()\n\n    // In order to avoid floating point error, we cap the maximum zoom. In\n    // particular, it's important that at the maximum zoom level, the total\n    // trace size + a viewport width is not equal to the trace size due to\n    // floating point rounding.\n    //\n    // For instance, if the profile's total weight is 2^60, and the viewport\n    // size is 1, trying to move one viewport width right will result in no\n    // change because 2^60 + 1 = 2^60 in floating point arithmetic. JavaScript\n    // numbers are 64 bit floats, and therefore have 53 mantissa bits. You can\n    // see this for yourself in the console. Try:\n    //\n    //   > Math.pow(2, 60) + 1 === Math.pow(2, 60)\n    //   true\n    //   > Math.pow(2, 53) + 1 === Math.pow(2, 53)\n    //   true\n    //   > Math.pow(2, 52) + 1 === Math.pow(2, 52)\n    //   false\n    //\n    // We use 2^40 as a cap instead, since we want to be able to make small\n    // adjustments within a viewport width.\n    //\n    // For reference, this will still allow you to zoom until 1 nanosecond fills\n    // the screen in a profile with a duration of over 18 minutes.\n    //\n    //   > Math.pow(2, 40) / (60 * Math.pow(10, 9))\n    //   18.325193796266667\n    //\n    const maxZoom = Math.pow(2, 40)\n\n    // In addition to capping zoom to avoid floating point error, we further cap\n    // zoom to avoid letting you zoom in so that the smallest element more than\n    // fills the screen, since that probably isn't useful. The final zoom cap is\n    // determined by the minimum zoom of either 2^40x zoom or the necessary zoom\n    // for the smallest frame to fill the screen three times.\n    const minWidth = clamp(3 * this.getMinFrameWidth(), maxWidth / maxZoom, maxWidth)\n\n    return clamp(viewportWidth, minWidth, maxWidth)\n  }\n\n  // Given a desired config-space viewport rectangle, clamp the rectangle so\n  // that it fits within the given flamechart. This prevents the viewport from\n  // extending past the bounds of the flamechart or zooming in too far.\n  getClampedConfigSpaceViewportRect({\n    configSpaceViewportRect,\n    renderInverted,\n  }: {\n    configSpaceViewportRect: Rect\n    renderInverted?: boolean\n  }) {\n    const configSpaceSize = new Vec2(this.getTotalWeight(), this.getLayers().length)\n    const width = this.getClampedViewportWidth(configSpaceViewportRect.size.x)\n    const size = configSpaceViewportRect.size.withX(width)\n    const origin = Vec2.clamp(\n      configSpaceViewportRect.origin,\n      new Vec2(0, renderInverted ? 0 : -1),\n      Vec2.max(Vec2.zero, configSpaceSize.minus(size).plus(new Vec2(0, 1))),\n    )\n    return new Rect(origin, configSpaceViewportRect.size.withX(width))\n  }\n\n  constructor(private source: FlamechartDataSource) {\n    const stack: FlamechartFrame[] = []\n    const openFrame = (node: CallTreeNode, value: number) => {\n      const parent = lastOf(stack)\n      const frame: FlamechartFrame = {\n        node,\n        parent,\n        children: [],\n        start: value,\n        end: value,\n      }\n      if (parent) {\n        parent.children.push(frame)\n      }\n      stack.push(frame)\n    }\n\n    this.minFrameWidth = Infinity\n    const closeFrame = (node: CallTreeNode, value: number) => {\n      console.assert(stack.length > 0)\n      const stackTop = stack.pop()!\n      stackTop.end = value\n      if (stackTop.end - stackTop.start === 0) return\n      const layerIndex = stack.length\n      while (this.layers.length <= layerIndex) this.layers.push([])\n      this.layers[layerIndex].push(stackTop)\n      this.minFrameWidth = Math.min(this.minFrameWidth, stackTop.end - stackTop.start)\n    }\n\n    this.totalWeight = source.getTotalWeight()\n    source.forEachCall(openFrame, closeFrame)\n\n    if (!isFinite(this.minFrameWidth)) this.minFrameWidth = 1\n  }\n}\n","import {Flamechart} from '../lib/flamechart'\nimport {RectangleBatch, RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {KeyedSet} from '../lib/utils'\nimport {RowAtlas} from './row-atlas'\nimport {Graphics} from './graphics'\nimport {FlamechartColorPassRenderer} from './flamechart-color-pass-renderer'\nimport {renderInto} from './utils'\n\nconst MAX_BATCH_SIZE = 10000\n\ninterface RangeTreeNode {\n  getBounds(): Rect\n  getRectCount(): number\n  getChildren(): RangeTreeNode[]\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void): void\n}\n\nclass RangeTreeLeafNode implements RangeTreeNode {\n  private children: RangeTreeNode[] = []\n\n  constructor(\n    private batch: RectangleBatch,\n    private bounds: Rect,\n    private numPrecedingRectanglesInRow: number,\n  ) {}\n\n  getBatch() {\n    return this.batch\n  }\n  getBounds() {\n    return this.bounds\n  }\n  getRectCount() {\n    return this.batch.getRectCount()\n  }\n  getChildren() {\n    return this.children\n  }\n  getParity() {\n    return this.numPrecedingRectanglesInRow % 2\n  }\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void) {\n    if (!this.bounds.hasIntersectionWith(configSpaceBounds)) return\n    cb(this)\n  }\n}\n\nclass RangeTreeInteriorNode implements RangeTreeNode {\n  private rectCount: number = 0\n  private bounds: Rect\n  constructor(private children: RangeTreeNode[]) {\n    if (children.length === 0) {\n      throw new Error('Empty interior node')\n    }\n    let minLeft = Infinity\n    let maxRight = -Infinity\n    let minTop = Infinity\n    let maxBottom = -Infinity\n    for (let child of children) {\n      this.rectCount += child.getRectCount()\n      const bounds = child.getBounds()\n      minLeft = Math.min(minLeft, bounds.left())\n      maxRight = Math.max(maxRight, bounds.right())\n      minTop = Math.min(minTop, bounds.top())\n      maxBottom = Math.max(maxBottom, bounds.bottom())\n    }\n    this.bounds = new Rect(\n      new Vec2(minLeft, minTop),\n      new Vec2(maxRight - minLeft, maxBottom - minTop),\n    )\n  }\n\n  getBounds() {\n    return this.bounds\n  }\n  getRectCount() {\n    return this.rectCount\n  }\n  getChildren() {\n    return this.children\n  }\n\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void) {\n    if (!this.bounds.hasIntersectionWith(configSpaceBounds)) return\n    for (let child of this.children) {\n      child.forEachLeafNodeWithinBounds(configSpaceBounds, cb)\n    }\n  }\n}\n\nexport interface FlamechartRendererProps {\n  configSpaceSrcRect: Rect\n  physicalSpaceDstRect: Rect\n  renderOutlines: boolean\n}\n\ninterface FlamechartRowAtlasKeyInfo {\n  stackDepth: number\n  zoomLevel: number\n  index: number\n}\n\nexport class FlamechartRowAtlasKey {\n  readonly stackDepth: number\n  readonly zoomLevel: number\n  readonly index: number\n\n  get key() {\n    return `${this.stackDepth}_${this.index}_${this.zoomLevel}`\n  }\n  private constructor(options: FlamechartRowAtlasKeyInfo) {\n    this.stackDepth = options.stackDepth\n    this.zoomLevel = options.zoomLevel\n    this.index = options.index\n  }\n  static getOrInsert(set: KeyedSet<FlamechartRowAtlasKey>, info: FlamechartRowAtlasKeyInfo) {\n    return set.getOrInsert(new FlamechartRowAtlasKey(info))\n  }\n}\n\nexport interface FlamechartRendererOptions {\n  inverted: boolean\n}\n\nexport class FlamechartRenderer {\n  private layers: RangeTreeNode[] = []\n\n  constructor(\n    private gl: Graphics.Context,\n    private rowAtlas: RowAtlas<FlamechartRowAtlasKey>,\n    private flamechart: Flamechart,\n    private rectangleBatchRenderer: RectangleBatchRenderer,\n    private colorPassRenderer: FlamechartColorPassRenderer,\n    private options: FlamechartRendererOptions = {inverted: false},\n  ) {\n    const nLayers = flamechart.getLayers().length\n    for (let stackDepth = 0; stackDepth < nLayers; stackDepth++) {\n      const leafNodes: RangeTreeLeafNode[] = []\n      const y = options.inverted ? nLayers - 1 - stackDepth : stackDepth\n\n      let minLeft = Infinity\n      let maxRight = -Infinity\n      let batch = new RectangleBatch(this.gl)\n\n      let rectCount = 0\n\n      const layer = flamechart.getLayers()[stackDepth]\n\n      for (let i = 0; i < layer.length; i++) {\n        const frame = layer[i]\n        if (batch.getRectCount() >= MAX_BATCH_SIZE) {\n          leafNodes.push(\n            new RangeTreeLeafNode(\n              batch,\n              new Rect(new Vec2(minLeft, y), new Vec2(maxRight - minLeft, 1)),\n              rectCount,\n            ),\n          )\n          minLeft = Infinity\n          maxRight = -Infinity\n          batch = new RectangleBatch(this.gl)\n        }\n        const configSpaceBounds = new Rect(\n          new Vec2(frame.start, y),\n          new Vec2(frame.end - frame.start, 1),\n        )\n        minLeft = Math.min(minLeft, configSpaceBounds.left())\n        maxRight = Math.max(maxRight, configSpaceBounds.right())\n\n        // We'll use the red channel to indicate the index to allow\n        // us to separate adjacent rectangles within a row from one another,\n        // the green channel to indicate the row,\n        // and the blue channel to indicate the color bucket to render.\n        // We add one to each so we have zero reserved for the background color.\n        const color = new Color(\n          (1 + (i % 255)) / 256,\n          (1 + (stackDepth % 255)) / 256,\n          (1 + this.flamechart.getColorBucketForFrame(frame.node.frame)) / 256,\n        )\n        batch.addRect(configSpaceBounds, color)\n        rectCount++\n      }\n\n      if (batch.getRectCount() > 0) {\n        leafNodes.push(\n          new RangeTreeLeafNode(\n            batch,\n            new Rect(new Vec2(minLeft, y), new Vec2(maxRight - minLeft, 1)),\n            rectCount,\n          ),\n        )\n      }\n\n      // TODO(jlfwong): Making this into a binary tree\n      // range than a tree of always-height-two might make this run faster\n      this.layers.push(new RangeTreeInteriorNode(leafNodes))\n    }\n  }\n\n  private rectInfoTexture: Graphics.Texture | null = null\n  getRectInfoTexture(width: number, height: number): Graphics.Texture {\n    if (this.rectInfoTexture) {\n      const texture = this.rectInfoTexture\n      if (texture.width != width || texture.height != height) {\n        texture.resize(width, height)\n      }\n    } else {\n      this.rectInfoTexture = this.gl.createTexture(\n        Graphics.TextureFormat.NEAREST_CLAMP,\n        width,\n        height,\n      )\n    }\n    return this.rectInfoTexture\n  }\n\n  private rectInfoRenderTarget: Graphics.RenderTarget | null = null\n  getRectInfoRenderTarget(width: number, height: number): Graphics.RenderTarget {\n    const texture = this.getRectInfoTexture(width, height)\n    if (this.rectInfoRenderTarget) {\n      if (this.rectInfoRenderTarget.texture != texture) {\n        this.rectInfoRenderTarget.texture.free()\n        this.rectInfoRenderTarget.setColor(texture)\n      }\n    }\n    if (!this.rectInfoRenderTarget) {\n      this.rectInfoRenderTarget = this.gl.createRenderTarget(texture)\n    }\n    return this.rectInfoRenderTarget\n  }\n\n  free() {\n    if (this.rectInfoRenderTarget) {\n      this.rectInfoRenderTarget.free()\n    }\n    if (this.rectInfoTexture) {\n      this.rectInfoTexture.free()\n    }\n  }\n\n  private atlasKeys = new KeyedSet<FlamechartRowAtlasKey>()\n\n  configSpaceBoundsForKey(key: FlamechartRowAtlasKey): Rect {\n    const {stackDepth, zoomLevel, index} = key\n    const configSpaceContentWidth = this.flamechart.getTotalWeight()\n\n    const width = configSpaceContentWidth / Math.pow(2, zoomLevel)\n\n    const nLayers = this.flamechart.getLayers().length\n    const y = this.options.inverted ? nLayers - 1 - stackDepth : stackDepth\n    return new Rect(new Vec2(width * index, y), new Vec2(width, 1))\n  }\n\n  render(props: FlamechartRendererProps) {\n    const {configSpaceSrcRect, physicalSpaceDstRect} = props\n\n    const atlasKeysToRender: FlamechartRowAtlasKey[] = []\n\n    // We want to render the lowest resolution we can while still guaranteeing that the\n    // atlas line is higher resolution than its corresponding destination rectangle on\n    // the screen.\n    const configToPhysical = AffineTransform.betweenRects(configSpaceSrcRect, physicalSpaceDstRect)\n    if (configSpaceSrcRect.isEmpty()) {\n      // Prevent an infinite loop\n      return\n    }\n\n    let zoomLevel = 0\n    while (true) {\n      const key = FlamechartRowAtlasKey.getOrInsert(this.atlasKeys, {\n        stackDepth: 0,\n        zoomLevel,\n        index: 0,\n      })\n      const configSpaceBounds = this.configSpaceBoundsForKey(key)\n      const physicalBounds = configToPhysical.transformRect(configSpaceBounds)\n      if (physicalBounds.width() < this.rowAtlas.getResolution()) {\n        break\n      }\n      zoomLevel++\n    }\n\n    const top = Math.max(0, Math.floor(configSpaceSrcRect.top()))\n    const bottom = Math.min(this.layers.length, Math.ceil(configSpaceSrcRect.bottom()))\n\n    const configSpaceContentWidth = this.flamechart.getTotalWeight()\n    const numAtlasEntriesPerLayer = Math.pow(2, zoomLevel)\n    const left = Math.floor(\n      (numAtlasEntriesPerLayer * configSpaceSrcRect.left()) / configSpaceContentWidth,\n    )\n    const right = Math.ceil(\n      (numAtlasEntriesPerLayer * configSpaceSrcRect.right()) / configSpaceContentWidth,\n    )\n\n    const nLayers = this.flamechart.getLayers().length\n\n    for (let y = top; y < bottom; y++) {\n      for (let index = left; index <= right; index++) {\n        const stackDepth = this.options.inverted ? nLayers - 1 - y : y\n        const key = FlamechartRowAtlasKey.getOrInsert(this.atlasKeys, {\n          stackDepth,\n          zoomLevel,\n          index,\n        })\n        const configSpaceBounds = this.configSpaceBoundsForKey(key)\n        if (!configSpaceBounds.hasIntersectionWith(configSpaceSrcRect)) continue\n        atlasKeysToRender.push(key)\n      }\n    }\n\n    // TODO(jlfwong): When I switched the GL backend from regl to the port from\n    // evanw/sky, rendering uncached even for massive documents seemed fast\n    // enough. It's possible that the row cache is now unnecessary, but I'll\n    // leave it around for now since it's not causing issues.\n\n    const cacheCapacity = this.rowAtlas.getCapacity()\n    const keysToRenderCached = atlasKeysToRender.slice(0, cacheCapacity)\n    const keysToRenderUncached = atlasKeysToRender.slice(cacheCapacity)\n\n    // Fill the cache\n    this.rowAtlas.writeToAtlasIfNeeded(keysToRenderCached, (textureDstRect, key) => {\n      const configSpaceBounds = this.configSpaceBoundsForKey(key)\n      this.layers[key.stackDepth].forEachLeafNodeWithinBounds(configSpaceBounds, leaf => {\n        this.rectangleBatchRenderer.render({\n          batch: leaf.getBatch(),\n          configSpaceSrcRect: configSpaceBounds,\n          physicalSpaceDstRect: textureDstRect,\n        })\n      })\n    })\n\n    const renderTarget = this.getRectInfoRenderTarget(\n      physicalSpaceDstRect.width(),\n      physicalSpaceDstRect.height(),\n    )\n\n    renderInto(this.gl, renderTarget, () => {\n      this.gl.clear(new Graphics.Color(0, 0, 0, 0))\n\n      const viewportRect = new Rect(\n        Vec2.zero,\n        new Vec2(this.gl.viewport.width, this.gl.viewport.height),\n      )\n      const configToViewport = AffineTransform.betweenRects(configSpaceSrcRect, viewportRect)\n\n      // Render from the cache\n      for (let key of keysToRenderCached) {\n        const configSpaceSrcRect = this.configSpaceBoundsForKey(key)\n        this.rowAtlas.renderViaAtlas(key, configToViewport.transformRect(configSpaceSrcRect))\n      }\n\n      // Render entries that didn't make it into the cache\n      for (let key of keysToRenderUncached) {\n        const configSpaceBounds = this.configSpaceBoundsForKey(key)\n        const physicalBounds = configToViewport.transformRect(configSpaceBounds)\n        this.layers[key.stackDepth].forEachLeafNodeWithinBounds(configSpaceBounds, leaf => {\n          this.rectangleBatchRenderer.render({\n            batch: leaf.getBatch(),\n            configSpaceSrcRect: configSpaceBounds,\n            physicalSpaceDstRect: physicalBounds,\n          })\n        })\n      }\n    })\n\n    const rectInfoTexture = this.getRectInfoTexture(\n      physicalSpaceDstRect.width(),\n      physicalSpaceDstRect.height(),\n    )\n\n    this.colorPassRenderer.render({\n      rectInfoTexture,\n      srcRect: new Rect(Vec2.zero, new Vec2(rectInfoTexture.width, rectInfoTexture.height)),\n      dstRect: physicalSpaceDstRect,\n      renderOutlines: props.renderOutlines,\n    })\n  }\n}\n","import {StyleSheet} from 'aphrodite'\nimport {FontSize, Sizes} from './style'\nimport {withTheme} from './themes/theme'\n\nexport const getFlamechartStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverCount: {\n      color: theme.weightColor,\n    },\n    fill: {\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      left: 0,\n      top: 0,\n    },\n    minimap: {\n      height: Sizes.MINIMAP_HEIGHT,\n      borderBottom: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n    },\n    panZoomView: {\n      flex: 1,\n    },\n\n    detailView: {\n      display: 'grid',\n      height: Sizes.DETAIL_VIEW_HEIGHT,\n      overflow: 'hidden',\n      gridTemplateColumns: '120px 120px 1fr',\n      gridTemplateRows: 'repeat(4, 1fr)',\n      borderTop: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n      fontSize: FontSize.LABEL,\n      position: 'absolute',\n      background: theme.bgPrimaryColor,\n      width: '100vw',\n      bottom: 0,\n    },\n    stackTraceViewPadding: {\n      padding: 5,\n    },\n    stackTraceView: {\n      height: Sizes.DETAIL_VIEW_HEIGHT,\n      lineHeight: `${FontSize.LABEL + 2}px`,\n      overflow: 'auto',\n      '::-webkit-scrollbar': {\n        background: theme.bgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.fgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.bgPrimaryColor}`,\n        ':hover': {\n          background: theme.fgPrimaryColor,\n        },\n      },\n    },\n    stackLine: {\n      whiteSpace: 'nowrap',\n    },\n    stackFileLine: {\n      color: theme.fgSecondaryColor,\n    },\n    statsTable: {\n      display: 'grid',\n      gridTemplateColumns: '1fr 1fr',\n      gridTemplateRows: `repeat(3, ${FontSize.LABEL + 10}px)`,\n      gridGap: '1px 1px',\n      textAlign: 'center',\n      paddingRight: 1,\n    },\n    statsTableHeader: {\n      gridColumn: '1 / 3',\n    },\n    statsTableCell: {\n      position: 'relative',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n    },\n    thisInstanceCell: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    allInstancesCell: {\n      background: theme.selectionSecondaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    barDisplay: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      background: 'rgba(0, 0, 0, 0.2)',\n      width: '100%',\n    },\n  }),\n)\n","import {findValueBisect} from './utils'\n\nexport const ELLIPSIS = '\\u2026'\n\n// NOTE: This blindly assumes the same result across contexts.\nconst measureTextCache = new Map<string, number>()\n\nlet lastDevicePixelRatio = -1\nexport function cachedMeasureTextWidth(ctx: CanvasRenderingContext2D, text: string): number {\n  if (window.devicePixelRatio !== lastDevicePixelRatio) {\n    // This cache is no longer valid!\n    measureTextCache.clear()\n    lastDevicePixelRatio = window.devicePixelRatio\n  }\n  if (!measureTextCache.has(text)) {\n    measureTextCache.set(text, ctx.measureText(text).width)\n  }\n  return measureTextCache.get(text)!\n}\n\ninterface TrimmedTextResult {\n  trimmedString: string\n  trimmedLength: number\n  prefixLength: number\n  suffixLength: number\n  originalLength: number\n  originalString: string\n}\n\n// Trim text, placing an ellipsis in the middle, with a slight bias towards\n// keeping text from the beginning rather than the end\nexport function buildTrimmedText(text: string, length: number): TrimmedTextResult {\n  if (text.length <= length) {\n    return {\n      trimmedString: text,\n      trimmedLength: text.length,\n      prefixLength: text.length,\n      suffixLength: 0,\n      originalString: text,\n      originalLength: text.length,\n    }\n  }\n\n  let prefixLength = Math.floor(length / 2)\n  const suffixLength = length - prefixLength - 1\n  const prefix = text.substr(0, prefixLength)\n  const suffix = text.substr(text.length - suffixLength, suffixLength)\n  const trimmedString = prefix + ELLIPSIS + suffix\n  return {\n    trimmedString,\n    trimmedLength: trimmedString.length,\n    prefixLength: prefix.length,\n    suffixLength: suffix.length,\n    originalString: text,\n    originalLength: text.length,\n  }\n}\n\n// Trim text to fit within the given number of pixels on the canvas\nexport function trimTextMid(\n  ctx: CanvasRenderingContext2D,\n  text: string,\n  maxWidth: number,\n): TrimmedTextResult {\n  if (cachedMeasureTextWidth(ctx, text) <= maxWidth) {\n    return buildTrimmedText(text, text.length)\n  }\n  const [lo] = findValueBisect(\n    0,\n    text.length,\n    n => {\n      return cachedMeasureTextWidth(ctx, buildTrimmedText(text, n).trimmedString)\n    },\n    maxWidth,\n  )\n  return buildTrimmedText(text, lo)\n}\n\nenum IndexTypeInTrimmed {\n  IN_PREFIX,\n  IN_SUFFIX,\n  ELIDED,\n}\n\nfunction getIndexTypeInTrimmed(result: TrimmedTextResult, index: number): IndexTypeInTrimmed {\n  if (index < result.prefixLength) {\n    return IndexTypeInTrimmed.IN_PREFIX\n  } else if (index < result.originalLength - result.suffixLength) {\n    return IndexTypeInTrimmed.ELIDED\n  } else {\n    return IndexTypeInTrimmed.IN_SUFFIX\n  }\n}\n\nexport function remapRangesToTrimmedText(\n  trimmedText: TrimmedTextResult,\n  ranges: [number, number][],\n): [number, number][] {\n  // We intentionally don't just re-run fuzzy matching on the trimmed\n  // text, beacuse if the search query is \"helloWorld\", the frame name\n  // is \"application::helloWorld\", and that gets trimmed down to\n  // \"appl...oWorld\", we still want \"oWorld\" to be highlighted, even\n  // though the string \"appl...oWorld\" is not matched by the query\n  // \"helloWorld\".\n  //\n  // There's a weird case to consider here: what if the trimmedText is\n  // also matched by the query, but results in a different match than\n  // the original query? Consider, e.g. the search string of \"ab\". The\n  // string \"hello ab shabby\" will be matched at the first \"ab\", but\n  // may be trimmed to \"hello...shabby\". In this case, should we\n  // highlight the \"ab\" hidden by the ellipsis, or the \"ab\" in\n  // \"shabby\"? The code below highlights the ellipsis so that the\n  // matched characters don't change as you zoom in and out.\n\n  const rangesToHighlightInTrimmedText: [number, number][] = []\n  const lengthLoss = trimmedText.originalLength - trimmedText.trimmedLength\n  let highlightedEllipsis = false\n\n  for (let [origStart, origEnd] of ranges) {\n    let startPosType = getIndexTypeInTrimmed(trimmedText, origStart)\n    let endPosType = getIndexTypeInTrimmed(trimmedText, origEnd - 1)\n\n    switch (startPosType) {\n      case IndexTypeInTrimmed.IN_PREFIX: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // The entire range fits in the prefix. Add it unmodified.\n            rangesToHighlightInTrimmedText.push([origStart, origEnd])\n            break\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // The range starts in the prefix, but ends in the elided\n            // section. Add just the prefix + one char for the ellipsis.\n            rangesToHighlightInTrimmedText.push([origStart, trimmedText.prefixLength + 1])\n            highlightedEllipsis = true\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // The range crosses from the prefix to the suffix.\n            // Highlight everything including the ellipsis.\n            rangesToHighlightInTrimmedText.push([origStart, origEnd - lengthLoss])\n            break\n          }\n        }\n        break\n      }\n      case IndexTypeInTrimmed.ELIDED: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in elided and ends in prefix')\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // The match starts & ends within the elided section.\n            if (!highlightedEllipsis) {\n              rangesToHighlightInTrimmedText.push([\n                trimmedText.prefixLength,\n                trimmedText.prefixLength + 1,\n              ])\n              highlightedEllipsis = true\n            }\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // The match starts in elided, but ends in suffix.\n            if (highlightedEllipsis) {\n              rangesToHighlightInTrimmedText.push([\n                trimmedText.trimmedLength - trimmedText.suffixLength,\n                origEnd - lengthLoss,\n              ])\n            } else {\n              rangesToHighlightInTrimmedText.push([trimmedText.prefixLength, origEnd - lengthLoss])\n              highlightedEllipsis = true\n            }\n            break\n          }\n        }\n        break\n      }\n      case IndexTypeInTrimmed.IN_SUFFIX: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in suffix and ends in prefix')\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in suffix and ends in elided')\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // Match starts & ends in suffix\n            rangesToHighlightInTrimmedText.push([origStart - lengthLoss, origEnd - lengthLoss])\n            break\n          }\n        }\n        break\n      }\n    }\n  }\n  return rangesToHighlightInTrimmedText\n}\n","import {h, Component} from 'preact'\nimport {css} from 'aphrodite'\nimport {Flamechart} from '../lib/flamechart'\nimport {Rect, Vec2, AffineTransform, clamp} from '../lib/math'\nimport {FlamechartRenderer} from '../gl/flamechart-renderer'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {FontFamily, FontSize, Sizes, commonStyle} from './style'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {cachedMeasureTextWidth} from '../lib/text-utils'\nimport {Color} from '../lib/color'\nimport {Theme} from './themes/theme'\n\ninterface FlamechartMinimapViewProps {\n  theme: Theme\n\n  flamechart: Flamechart\n  configSpaceViewportRect: Rect\n\n  canvasContext: CanvasContext\n  flamechartRenderer: FlamechartRenderer\n\n  transformViewport: (transform: AffineTransform) => void\n  setConfigSpaceViewportRect: (rect: Rect) => void\n}\n\nenum DraggingMode {\n  DRAW_NEW_VIEWPORT,\n  TRANSLATE_VIEWPORT,\n}\n\nexport class FlamechartMinimapView extends Component<FlamechartMinimapViewProps, {}> {\n  container: Element | null = null\n  containerRef = (element: Element | null) => {\n    this.container = element || null\n  }\n\n  overlayCanvas: HTMLCanvasElement | null = null\n  overlayCtx: CanvasRenderingContext2D | null = null\n\n  private physicalViewSize() {\n    return new Vec2(\n      this.overlayCanvas ? this.overlayCanvas.width : 0,\n      this.overlayCanvas ? this.overlayCanvas.height : 0,\n    )\n  }\n\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private minimapOrigin() {\n    return new Vec2(0, Sizes.FRAME_HEIGHT * window.devicePixelRatio)\n    // return new Vec2(0, 0)\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private configSpaceToPhysicalViewSpace() {\n    const minimapOrigin = this.minimapOrigin()\n\n    return AffineTransform.betweenRects(\n      new Rect(new Vec2(0, 0), this.configSpaceSize()),\n      new Rect(minimapOrigin, this.physicalViewSize().minus(minimapOrigin)),\n    )\n  }\n\n  private logicalToPhysicalViewSpace() {\n    return AffineTransform.withScale(new Vec2(window.devicePixelRatio, window.devicePixelRatio))\n  }\n\n  private windowToLogicalViewSpace() {\n    if (!this.container) return new AffineTransform()\n    const bounds = this.container.getBoundingClientRect()\n    return AffineTransform.withTranslation(new Vec2(-bounds.left, -bounds.top))\n  }\n\n  private renderRects() {\n    if (!this.container) return\n\n    // Hasn't resized yet -- no point in rendering yet\n    if (this.physicalViewSize().x < 2) return\n\n    this.props.canvasContext.renderBehind(this.container, () => {\n      this.props.flamechartRenderer.render({\n        configSpaceSrcRect: new Rect(new Vec2(0, 0), this.configSpaceSize()),\n        physicalSpaceDstRect: new Rect(\n          this.minimapOrigin(),\n          this.physicalViewSize().minus(this.minimapOrigin()),\n        ),\n        renderOutlines: false,\n      })\n\n      this.props.canvasContext.viewportRectangleRenderer.render({\n        configSpaceViewportRect: this.props.configSpaceViewportRect,\n        configSpaceToPhysicalViewSpace: this.configSpaceToPhysicalViewSpace(),\n      })\n    })\n  }\n\n  private renderOverlays() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n    const physicalViewSize = this.physicalViewSize()\n    ctx.clearRect(0, 0, physicalViewSize.x, physicalViewSize.y)\n\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n\n    const left = 0\n    const right = this.configSpaceSize().x\n\n    // TODO(jlfwong): There's a huge amount of code duplication here between\n    // this and the FlamechartView.renderOverlays(). Consolidate.\n\n    // We want about 10 gridlines to be visible, and want the unit to be\n    // 1eN, 2eN, or 5eN for some N\n\n    // Ideally, we want an interval every 100 logical screen pixels\n    const logicalToConfig = (\n      this.configSpaceToPhysicalViewSpace().inverted() || new AffineTransform()\n    ).times(this.logicalToPhysicalViewSpace())\n    const targetInterval = logicalToConfig.transformVector(new Vec2(200, 1)).x\n\n    const physicalViewSpaceFrameHeight = Sizes.FRAME_HEIGHT * window.devicePixelRatio\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const labelPaddingPx = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2\n\n    ctx.font = `${physicalViewSpaceFontSize}px/${physicalViewSpaceFrameHeight}px ${FontFamily.MONOSPACE}`\n    ctx.textBaseline = 'top'\n\n    const minInterval = Math.pow(10, Math.floor(Math.log10(targetInterval)))\n    let interval = minInterval\n\n    if (targetInterval / interval > 5) {\n      interval *= 5\n    } else if (targetInterval / interval > 2) {\n      interval *= 2\n    }\n\n    const theme = this.props.theme\n\n    {\n      ctx.fillStyle = Color.fromCSSHex(theme.bgPrimaryColor).withAlpha(0.8).toCSS()\n      ctx.fillRect(0, 0, physicalViewSize.x, physicalViewSpaceFrameHeight)\n      ctx.textBaseline = 'top'\n\n      for (let x = Math.ceil(left / interval) * interval; x < right; x += interval) {\n        // TODO(jlfwong): Ensure that labels do not overlap\n        const pos = Math.round(configToPhysical.transformPosition(new Vec2(x, 0)).x)\n        const labelText = this.props.flamechart.formatValue(x)\n        const textWidth = Math.ceil(cachedMeasureTextWidth(ctx, labelText))\n\n        ctx.fillStyle = theme.fgPrimaryColor\n        ctx.fillText(labelText, pos - textWidth - labelPaddingPx, labelPaddingPx)\n        ctx.fillStyle = theme.fgSecondaryColor\n        ctx.fillRect(pos, 0, 1, physicalViewSize.y)\n      }\n    }\n  }\n\n  onWindowResize = () => {\n    this.onBeforeFrame()\n  }\n\n  componentWillReceiveProps(nextProps: FlamechartMinimapViewProps) {\n    if (this.props.flamechart !== nextProps.flamechart) {\n      this.renderCanvas()\n    } else if (this.props.configSpaceViewportRect != nextProps.configSpaceViewportRect) {\n      this.renderCanvas()\n    } else if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.onWindowResize)\n    this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onWindowResize)\n    this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n  }\n\n  private resizeOverlayCanvasIfNeeded() {\n    if (!this.overlayCanvas) return\n    let {width, height} = this.overlayCanvas.getBoundingClientRect()\n    {\n      /*\n      We render text at a higher resolution then scale down to\n      ensure we're rendering at 1:1 device pixel ratio.\n      This ensures our text is rendered crisply.\n    */\n    }\n    width = Math.floor(width)\n    height = Math.floor(height)\n\n    // Still initializing: don't resize yet\n    if (width === 0 || height === 0) return\n\n    const scaledWidth = width * window.devicePixelRatio\n    const scaledHeight = height * window.devicePixelRatio\n\n    if (scaledWidth === this.overlayCanvas.width && scaledHeight === this.overlayCanvas.height)\n      return\n\n    this.overlayCanvas.width = scaledWidth\n    this.overlayCanvas.height = scaledHeight\n  }\n\n  private onBeforeFrame = () => {\n    this.maybeClearInteractionLock()\n    this.resizeOverlayCanvasIfNeeded()\n    this.renderRects()\n    this.renderOverlays()\n  }\n\n  private renderCanvas = () => {\n    this.props.canvasContext.requestFrame()\n  }\n\n  // Inertial scrolling introduces tricky interaction problems.\n  // Namely, if you start panning, and hit the edge of the scrollable\n  // area, the browser continues to receive WheelEvents from inertial\n  // scrolling. If we start zooming by holding Cmd + scrolling, then\n  // release the Cmd key, this can cause us to interpret the incoming\n  // inertial scrolling events as panning. To prevent this, we introduce\n  // a concept of an \"Interaction Lock\". Once a certain interaction has\n  // begun, we don't allow the other type of interaction to begin until\n  // we've received two frames with no inertial wheel events. This\n  // prevents us from accidentally switching between panning & zooming.\n  private frameHadWheelEvent = false\n  private framesWithoutWheelEvents = 0\n  private interactionLock: 'pan' | 'zoom' | null = null\n  private maybeClearInteractionLock = () => {\n    if (this.interactionLock) {\n      if (!this.frameHadWheelEvent) {\n        this.framesWithoutWheelEvents++\n        if (this.framesWithoutWheelEvents >= 2) {\n          this.interactionLock = null\n          this.framesWithoutWheelEvents = 0\n        }\n      }\n      this.props.canvasContext.requestFrame()\n    }\n    this.frameHadWheelEvent = false\n  }\n\n  private pan(logicalViewSpaceDelta: Vec2) {\n    this.interactionLock = 'pan'\n    const physicalDelta = this.logicalToPhysicalViewSpace().transformVector(logicalViewSpaceDelta)\n    const configDelta = this.configSpaceToPhysicalViewSpace().inverseTransformVector(physicalDelta)\n\n    if (!configDelta) return\n    this.props.transformViewport(AffineTransform.withTranslation(configDelta))\n  }\n\n  private zoom(multiplier: number) {\n    this.interactionLock = 'zoom'\n    const configSpaceViewport = this.props.configSpaceViewportRect\n    const configSpaceCenter = configSpaceViewport.origin.plus(configSpaceViewport.size.times(1 / 2))\n    if (!configSpaceCenter) return\n\n    const zoomTransform = AffineTransform.withTranslation(configSpaceCenter.times(-1))\n      .scaledBy(new Vec2(multiplier, 1))\n      .translatedBy(configSpaceCenter)\n\n    this.props.transformViewport(zoomTransform)\n  }\n\n  private onWheel = (ev: WheelEvent) => {\n    ev.preventDefault()\n\n    this.frameHadWheelEvent = true\n\n    const isZoom = ev.metaKey || ev.ctrlKey\n\n    if (isZoom && this.interactionLock !== 'pan') {\n      let multiplier = 1 + ev.deltaY / 100\n\n      // On Chrome & Firefox, pinch-to-zoom maps to\n      // WheelEvent + Ctrl Key. We'll accelerate it in\n      // this case, since it feels a bit sluggish otherwise.\n      if (ev.ctrlKey) {\n        multiplier = 1 + ev.deltaY / 40\n      }\n\n      multiplier = clamp(multiplier, 0.1, 10.0)\n\n      this.zoom(multiplier)\n    } else if (this.interactionLock !== 'zoom') {\n      this.pan(new Vec2(ev.deltaX, ev.deltaY))\n    }\n\n    this.renderCanvas()\n  }\n\n  private configSpaceMouse(ev: MouseEvent): Vec2 | null {\n    const logicalSpaceMouse = this.windowToLogicalViewSpace().transformPosition(\n      new Vec2(ev.clientX, ev.clientY),\n    )\n    const physicalSpaceMouse = this.logicalToPhysicalViewSpace().transformPosition(\n      logicalSpaceMouse,\n    )\n    return this.configSpaceToPhysicalViewSpace().inverseTransformPosition(physicalSpaceMouse)\n  }\n\n  private dragStartConfigSpaceMouse: Vec2 | null = null\n  private dragConfigSpaceViewportOffset: Vec2 | null = null\n  private draggingMode: DraggingMode | null = null\n  private onMouseDown = (ev: MouseEvent) => {\n    const configSpaceMouse = this.configSpaceMouse(ev)\n\n    if (configSpaceMouse) {\n      if (this.props.configSpaceViewportRect.contains(configSpaceMouse)) {\n        // If dragging starting inside the viewport rectangle,\n        // we'll move the existing viewport\n        this.draggingMode = DraggingMode.TRANSLATE_VIEWPORT\n        this.dragConfigSpaceViewportOffset = configSpaceMouse.minus(\n          this.props.configSpaceViewportRect.origin,\n        )\n      } else {\n        // If dragging starts outside the the viewport rectangle,\n        // we'll start drawing a new viewport\n        this.draggingMode = DraggingMode.DRAW_NEW_VIEWPORT\n      }\n\n      this.dragStartConfigSpaceMouse = configSpaceMouse\n      window.addEventListener('mousemove', this.onWindowMouseMove)\n      window.addEventListener('mouseup', this.onWindowMouseUp)\n      this.updateCursor(configSpaceMouse)\n    }\n  }\n\n  private onWindowMouseMove = (ev: MouseEvent) => {\n    if (!this.dragStartConfigSpaceMouse) return\n    let configSpaceMouse = this.configSpaceMouse(ev)\n\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n\n    // Clamp the mouse position to avoid weird behavior when outside the canvas bounds\n    configSpaceMouse = new Rect(new Vec2(0, 0), this.configSpaceSize()).closestPointTo(\n      configSpaceMouse,\n    )\n\n    if (this.draggingMode === DraggingMode.DRAW_NEW_VIEWPORT) {\n      const configStart = this.dragStartConfigSpaceMouse\n      let configEnd = configSpaceMouse\n\n      if (!configStart || !configEnd) return\n      const left = Math.min(configStart.x, configEnd.x)\n      const right = Math.max(configStart.x, configEnd.x)\n\n      const width = right - left\n      const height = this.props.configSpaceViewportRect.height()\n\n      this.props.setConfigSpaceViewportRect(\n        new Rect(new Vec2(left, configEnd.y - height / 2), new Vec2(width, height)),\n      )\n    } else if (this.draggingMode === DraggingMode.TRANSLATE_VIEWPORT) {\n      if (!this.dragConfigSpaceViewportOffset) return\n\n      const newOrigin = configSpaceMouse.minus(this.dragConfigSpaceViewportOffset)\n      this.props.setConfigSpaceViewportRect(\n        this.props.configSpaceViewportRect.withOrigin(newOrigin),\n      )\n    }\n  }\n\n  private updateCursor = (configSpaceMouse: Vec2) => {\n    if (this.draggingMode === DraggingMode.TRANSLATE_VIEWPORT) {\n      document.body.style.cursor = 'grabbing'\n      document.body.style.cursor = '-webkit-grabbing'\n    } else if (this.draggingMode === DraggingMode.DRAW_NEW_VIEWPORT) {\n      document.body.style.cursor = 'col-resize'\n    } else if (this.props.configSpaceViewportRect.contains(configSpaceMouse)) {\n      document.body.style.cursor = 'grab'\n      document.body.style.cursor = '-webkit-grab'\n    } else {\n      document.body.style.cursor = 'col-resize'\n    }\n  }\n\n  private onMouseLeave = () => {\n    if (this.draggingMode == null) {\n      document.body.style.cursor = 'default'\n    }\n  }\n\n  private onMouseMove = (ev: MouseEvent) => {\n    const configSpaceMouse = this.configSpaceMouse(ev)\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n  }\n\n  private onWindowMouseUp = (ev: MouseEvent) => {\n    this.draggingMode = null\n    window.removeEventListener('mousemove', this.onWindowMouseMove)\n    window.removeEventListener('mouseup', this.onWindowMouseUp)\n\n    const configSpaceMouse = this.configSpaceMouse(ev)\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n  }\n\n  private overlayCanvasRef = (element: Element | null) => {\n    if (element) {\n      this.overlayCanvas = element as HTMLCanvasElement\n      this.overlayCtx = this.overlayCanvas.getContext('2d')\n      this.renderCanvas()\n    } else {\n      this.overlayCanvas = null\n      this.overlayCtx = null\n    }\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div\n        ref={this.containerRef}\n        onWheel={this.onWheel}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n        onMouseLeave={this.onMouseLeave}\n        className={css(style.minimap, commonStyle.vbox)}\n      >\n        <canvas width={1} height={1} ref={this.overlayCanvasRef} className={css(style.fill)} />\n      </div>\n    )\n  }\n}\n","import {StyleDeclarationValue, css} from 'aphrodite'\nimport {h, JSX} from 'preact'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {formatPercent} from '../lib/utils'\nimport {Frame, CallTreeNode} from '../lib/profile'\nimport {ColorChit} from './color-chit'\nimport {Flamechart} from '../lib/flamechart'\nimport {useTheme} from './themes/theme'\n\ninterface StatisticsTableProps {\n  title: string\n  grandTotal: number\n  selectedTotal: number\n  selectedSelf: number\n  cellStyle: StyleDeclarationValue\n  formatter: (v: number) => string\n}\n\nfunction StatisticsTable(props: StatisticsTableProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const total = props.formatter(props.selectedTotal)\n  const self = props.formatter(props.selectedSelf)\n  const totalPerc = (100.0 * props.selectedTotal) / props.grandTotal\n  const selfPerc = (100.0 * props.selectedSelf) / props.grandTotal\n\n  return (\n    <div className={css(style.statsTable)}>\n      <div className={css(props.cellStyle, style.statsTableCell, style.statsTableHeader)}>\n        {props.title}\n      </div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>Total</div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>Self</div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>{total}</div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>{self}</div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>\n        {formatPercent(totalPerc)}\n        <div className={css(style.barDisplay)} style={{height: `${totalPerc}%`}} />\n      </div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>\n        {formatPercent(selfPerc)}\n        <div className={css(style.barDisplay)} style={{height: `${selfPerc}%`}} />\n      </div>\n    </div>\n  )\n}\n\ninterface StackTraceViewProps {\n  getFrameColor: (frame: Frame) => string\n  node: CallTreeNode\n}\nfunction StackTraceView(props: StackTraceViewProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const rows: JSX.Element[] = []\n  let node: CallTreeNode | null = props.node\n  for (; node && !node.isRoot(); node = node.parent) {\n    const row: (JSX.Element | string)[] = []\n    const {frame} = node\n\n    row.push(<ColorChit color={props.getFrameColor(frame)} />)\n\n    if (rows.length) {\n      row.push(<span className={css(style.stackFileLine)}>&gt; </span>)\n    }\n    row.push(frame.name)\n\n    if (frame.file) {\n      let pos = frame.file\n      if (frame.line != null) {\n        pos += `:${frame.line}`\n        if (frame.col != null) {\n          pos += `:${frame.col}`\n        }\n      }\n      row.push(<span className={css(style.stackFileLine)}> ({pos})</span>)\n    }\n    rows.push(<div className={css(style.stackLine)}>{row}</div>)\n  }\n  return (\n    <div className={css(style.stackTraceView)}>\n      <div className={css(style.stackTraceViewPadding)}>{rows}</div>\n    </div>\n  )\n}\n\ninterface FlamechartDetailViewProps {\n  flamechart: Flamechart\n  getCSSColorForFrame: (frame: Frame) => string\n  selectedNode: CallTreeNode\n}\n\nexport function FlamechartDetailView(props: FlamechartDetailViewProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const {flamechart, selectedNode} = props\n  const {frame} = selectedNode\n\n  return (\n    <div className={css(style.detailView)}>\n      <StatisticsTable\n        title={'This Instance'}\n        cellStyle={style.thisInstanceCell}\n        grandTotal={flamechart.getTotalWeight()}\n        selectedTotal={selectedNode.getTotalWeight()}\n        selectedSelf={selectedNode.getSelfWeight()}\n        formatter={flamechart.formatValue.bind(flamechart)}\n      />\n      <StatisticsTable\n        title={'All Instances'}\n        cellStyle={style.allInstancesCell}\n        grandTotal={flamechart.getTotalWeight()}\n        selectedTotal={frame.getTotalWeight()}\n        selectedSelf={frame.getSelfWeight()}\n        formatter={flamechart.formatValue.bind(flamechart)}\n      />\n      <StackTraceView node={selectedNode} getFrameColor={props.getCSSColorForFrame} />\n    </div>\n  )\n}\n","// This file contains a collection of classes which make it easier to perform\n// batch rendering of Canvas2D primitives. The advantage of this over just doing\n// ctx.beginPath() ... ctx.rect(...) ... ctx.endPath() is that you can construct\n// several different batch renderers are the same time, then decide on their\n// paint order at the end.\n//\n// See FlamechartPanZoomView.renderOverlays for an example of how this is used.\n\nexport interface TextArgs {\n  text: string\n  x: number\n  y: number\n}\n\nexport class BatchCanvasTextRenderer {\n  private argsBatch: TextArgs[] = []\n\n  text(args: TextArgs) {\n    this.argsBatch.push(args)\n  }\n\n  fill(ctx: CanvasRenderingContext2D, color: string) {\n    if (this.argsBatch.length === 0) return\n    ctx.fillStyle = color\n    for (let args of this.argsBatch) {\n      ctx.fillText(args.text, args.x, args.y)\n    }\n    this.argsBatch = []\n  }\n}\n\nexport interface RectArgs {\n  x: number\n  y: number\n  w: number\n  h: number\n}\n\nexport class BatchCanvasRectRenderer {\n  private argsBatch: RectArgs[] = []\n\n  rect(args: RectArgs) {\n    this.argsBatch.push(args)\n  }\n\n  private drawPath(ctx: CanvasRenderingContext2D) {\n    ctx.beginPath()\n    for (let args of this.argsBatch) {\n      ctx.rect(args.x, args.y, args.w, args.h)\n    }\n    ctx.closePath()\n    this.argsBatch = []\n  }\n\n  fill(ctx: CanvasRenderingContext2D, color: string) {\n    if (this.argsBatch.length === 0) return\n    ctx.fillStyle = color\n    this.drawPath(ctx)\n    ctx.fill()\n  }\n\n  stroke(ctx: CanvasRenderingContext2D, color: string, lineWidth: number) {\n    if (this.argsBatch.length === 0) return\n    ctx.strokeStyle = color\n    ctx.lineWidth = lineWidth\n    this.drawPath(ctx)\n    ctx.stroke()\n  }\n}\n","import {Rect, AffineTransform, Vec2, clamp} from '../lib/math'\nimport {CallTreeNode} from '../lib/profile'\nimport {Flamechart, FlamechartFrame} from '../lib/flamechart'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {FlamechartRenderer} from '../gl/flamechart-renderer'\nimport {Sizes, FontSize, FontFamily, commonStyle} from './style'\nimport {\n  cachedMeasureTextWidth,\n  ELLIPSIS,\n  trimTextMid,\n  remapRangesToTrimmedText,\n} from '../lib/text-utils'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {h, Component} from 'preact'\nimport {css} from 'aphrodite'\nimport {ProfileSearchResults} from '../lib/profile-search'\nimport {BatchCanvasTextRenderer, BatchCanvasRectRenderer} from '../lib/canvas-2d-batch-renderers'\nimport {Color} from '../lib/color'\nimport {Theme} from './themes/theme'\n\ninterface FlamechartFrameLabel {\n  configSpaceBounds: Rect\n  node: CallTreeNode\n}\n\n/**\n * Component to visualize a Flamechart and interact with it via hovering,\n * zooming, and panning.\n *\n * There are 3 vector spaces involved:\n * - Configuration Space: In this space, the horizontal unit is ms, and the\n *   vertical unit is stack depth. Each stack frame is one unit high.\n * - Logical view space: Origin is top-left, with +y downwards. This represents\n *   the coordinate space of the view as specified in CSS: horizontal and vertical\n *   units are both \"logical\" pixels.\n * - Physical view space: Origin is top-left, with +y downwards. This represents\n *   the coordinate space of the view as specified in hardware pixels: horizontal\n *   and vertical units are both \"physical\" pixels.\n *\n * We use two canvases to draw the flamechart itself: one for the rectangles,\n * which we render via WebGL, and one for the labels, which we render via 2D\n * canvas primitives.\n */\nexport interface FlamechartPanZoomViewProps {\n  flamechart: Flamechart\n  canvasContext: CanvasContext\n  flamechartRenderer: FlamechartRenderer\n  renderInverted: boolean\n  selectedNode: CallTreeNode | null\n  theme: Theme\n\n  onNodeHover: (hover: {node: CallTreeNode; event: MouseEvent} | null) => void\n  onNodeSelect: (node: CallTreeNode | null) => void\n\n  configSpaceViewportRect: Rect\n  transformViewport: (transform: AffineTransform) => void\n  setConfigSpaceViewportRect: (rect: Rect) => void\n\n  logicalSpaceViewportSize: Vec2\n  setLogicalSpaceViewportSize: (size: Vec2) => void\n\n  searchResults: ProfileSearchResults | null\n}\n\nexport class FlamechartPanZoomView extends Component<FlamechartPanZoomViewProps, {}> {\n  private container: Element | null = null\n  private containerRef = (element: Element | null) => {\n    this.container = element || null\n  }\n\n  private overlayCanvas: HTMLCanvasElement | null = null\n  private overlayCtx: CanvasRenderingContext2D | null = null\n\n  private hoveredLabel: FlamechartFrameLabel | null = null\n\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private setConfigSpaceViewportRect(r: Rect) {\n    this.props.setConfigSpaceViewportRect(r)\n  }\n\n  private overlayCanvasRef = (element: Element | null) => {\n    if (element) {\n      this.overlayCanvas = element as HTMLCanvasElement\n      this.overlayCtx = this.overlayCanvas.getContext('2d')\n      this.renderCanvas()\n    } else {\n      this.overlayCanvas = null\n      this.overlayCtx = null\n    }\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private physicalViewSize() {\n    return new Vec2(\n      this.overlayCanvas ? this.overlayCanvas.width : 0,\n      this.overlayCanvas ? this.overlayCanvas.height : 0,\n    )\n  }\n\n  private physicalBounds(): Rect {\n    if (this.props.renderInverted) {\n      // If we're rendering inverted and the flamegraph won't fill the viewport,\n      // we want to stick the flamegraph to the bottom of the viewport, not the top.\n\n      const physicalViewportHeight = this.physicalViewSize().y\n      const physicalFlamegraphHeight =\n        (this.configSpaceSize().y + 1) *\n        this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT *\n        window.devicePixelRatio\n\n      if (physicalFlamegraphHeight < physicalViewportHeight) {\n        return new Rect(\n          new Vec2(0, physicalViewportHeight - physicalFlamegraphHeight),\n          this.physicalViewSize(),\n        )\n      }\n    }\n\n    return new Rect(new Vec2(0, 0), this.physicalViewSize())\n  }\n\n  private LOGICAL_VIEW_SPACE_FRAME_HEIGHT = Sizes.FRAME_HEIGHT\n\n  private configSpaceToPhysicalViewSpace() {\n    return AffineTransform.betweenRects(this.props.configSpaceViewportRect, this.physicalBounds())\n  }\n\n  private logicalToPhysicalViewSpace() {\n    return AffineTransform.withScale(new Vec2(window.devicePixelRatio, window.devicePixelRatio))\n  }\n\n  private resizeOverlayCanvasIfNeeded() {\n    if (!this.overlayCanvas) return\n    let {width, height} = this.overlayCanvas.getBoundingClientRect()\n    {\n      /*\n      We render text at a higher resolution then scale down to\n      ensure we're rendering at 1:1 device pixel ratio.\n      This ensures our text is rendered crisply.\n    */\n    }\n    width = Math.floor(width)\n    height = Math.floor(height)\n\n    // Still initializing: don't resize yet\n    if (width === 0 || height === 0) return\n\n    const scaledWidth = width * window.devicePixelRatio\n    const scaledHeight = height * window.devicePixelRatio\n\n    if (scaledWidth === this.overlayCanvas.width && scaledHeight === this.overlayCanvas.height)\n      return\n\n    this.overlayCanvas.width = scaledWidth\n    this.overlayCanvas.height = scaledHeight\n  }\n\n  private renderOverlays() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n    if (this.props.configSpaceViewportRect.isEmpty()) return\n\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const physicalViewSpaceFrameHeight =\n      this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT * window.devicePixelRatio\n\n    const physicalViewSize = this.physicalViewSize()\n\n    ctx.clearRect(0, 0, physicalViewSize.x, physicalViewSize.y)\n\n    ctx.font = `${physicalViewSpaceFontSize}px/${physicalViewSpaceFrameHeight}px ${FontFamily.MONOSPACE}`\n    ctx.textBaseline = 'alphabetic'\n\n    const minWidthToRender = cachedMeasureTextWidth(ctx, 'M' + ELLIPSIS + 'M')\n    const minConfigSpaceWidthToRender = (\n      configToPhysical.inverseTransformVector(new Vec2(minWidthToRender, 0)) || new Vec2(0, 0)\n    ).x\n\n    const LABEL_PADDING_PX = 5 * window.devicePixelRatio\n\n    const labelBatch = new BatchCanvasTextRenderer()\n    const fadedLabelBatch = new BatchCanvasTextRenderer()\n    const matchedTextHighlightBatch = new BatchCanvasRectRenderer()\n    const directlySelectedOutlineBatch = new BatchCanvasRectRenderer()\n    const indirectlySelectedOutlineBatch = new BatchCanvasRectRenderer()\n    const matchedFrameBatch = new BatchCanvasRectRenderer()\n\n    const renderFrameLabelAndChildren = (frame: FlamechartFrame, depth = 0) => {\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n\n      if (width < minConfigSpaceWidthToRender) return\n      if (configSpaceBounds.left() > this.props.configSpaceViewportRect.right()) return\n      if (configSpaceBounds.right() < this.props.configSpaceViewportRect.left()) return\n\n      if (this.props.renderInverted) {\n        if (configSpaceBounds.bottom() < this.props.configSpaceViewportRect.top()) return\n      } else {\n        if (configSpaceBounds.top() > this.props.configSpaceViewportRect.bottom()) return\n      }\n\n      if (configSpaceBounds.hasIntersectionWith(this.props.configSpaceViewportRect)) {\n        let physicalLabelBounds = configToPhysical.transformRect(configSpaceBounds)\n\n        if (physicalLabelBounds.left() < 0) {\n          physicalLabelBounds = physicalLabelBounds\n            .withOrigin(physicalLabelBounds.origin.withX(0))\n            .withSize(\n              physicalLabelBounds.size.withX(\n                physicalLabelBounds.size.x + physicalLabelBounds.left(),\n              ),\n            )\n        }\n        if (physicalLabelBounds.right() > physicalViewSize.x) {\n          physicalLabelBounds = physicalLabelBounds.withSize(\n            physicalLabelBounds.size.withX(physicalViewSize.x - physicalLabelBounds.left()),\n          )\n        }\n\n        if (physicalLabelBounds.width() > minWidthToRender) {\n          const match = this.props.searchResults?.getMatchForFrame(frame.node.frame)\n\n          const trimmedText = trimTextMid(\n            ctx,\n            frame.node.frame.name,\n            physicalLabelBounds.width() - 2 * LABEL_PADDING_PX,\n          )\n\n          if (match) {\n            const rangesToHighlightInTrimmedText = remapRangesToTrimmedText(\n              trimmedText,\n              match\n            )\n\n            // Once we have the character ranges to highlight, we need to\n            // actually do the highlighting.\n            let lastEndIndex = 0\n            let left = physicalLabelBounds.left() + LABEL_PADDING_PX\n\n            const padding = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2 - 2\n            for (let [startIndex, endIndex] of rangesToHighlightInTrimmedText) {\n              left += cachedMeasureTextWidth(\n                ctx,\n                trimmedText.trimmedString.substring(lastEndIndex, startIndex),\n              )\n              const highlightWidth = cachedMeasureTextWidth(\n                ctx,\n                trimmedText.trimmedString.substring(startIndex, endIndex),\n              )\n              matchedTextHighlightBatch.rect({\n                x: left,\n                y: physicalLabelBounds.top() + padding,\n                w: highlightWidth,\n                h: physicalViewSpaceFrameHeight - 2 * padding,\n              })\n\n              left += highlightWidth\n              lastEndIndex = endIndex\n            }\n          }\n\n          const batch = this.props.searchResults != null && !match ? fadedLabelBatch : labelBatch\n          batch.text({\n            text: trimmedText.trimmedString,\n\n            // This is specifying the position of the starting text baseline.\n            x: physicalLabelBounds.left() + LABEL_PADDING_PX,\n            y: Math.round(\n              physicalLabelBounds.bottom() -\n                (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2,\n            ),\n          })\n        }\n      }\n      for (let child of frame.children) {\n        renderFrameLabelAndChildren(child, depth + 1)\n      }\n    }\n\n    const frameOutlineWidth = 2 * window.devicePixelRatio\n    ctx.strokeStyle = this.props.theme.selectionSecondaryColor\n    const minConfigSpaceWidthToRenderOutline = (\n      configToPhysical.inverseTransformVector(new Vec2(1, 0)) || new Vec2(0, 0)\n    ).x\n\n    const renderSpecialFrameOutlines = (frame: FlamechartFrame, depth = 0) => {\n      if (!this.props.selectedNode && this.props.searchResults == null) return\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n\n      if (width < minConfigSpaceWidthToRenderOutline) return\n      if (configSpaceBounds.left() > this.props.configSpaceViewportRect.right()) return\n      if (configSpaceBounds.right() < this.props.configSpaceViewportRect.left()) return\n      if (configSpaceBounds.top() > this.props.configSpaceViewportRect.bottom()) return\n\n      if (configSpaceBounds.hasIntersectionWith(this.props.configSpaceViewportRect)) {\n        if (this.props.searchResults?.getMatchForFrame(frame.node.frame)) {\n          const physicalRectBounds = configToPhysical.transformRect(configSpaceBounds)\n          matchedFrameBatch.rect({\n            x: Math.round(physicalRectBounds.left() + frameOutlineWidth / 2),\n            y: Math.round(physicalRectBounds.top() + frameOutlineWidth / 2),\n            w: Math.round(Math.max(0, physicalRectBounds.width() - frameOutlineWidth)),\n            h: Math.round(Math.max(0, physicalRectBounds.height() - frameOutlineWidth)),\n          })\n        }\n\n        if (this.props.selectedNode != null && frame.node.frame === this.props.selectedNode.frame) {\n          let batch =\n            frame.node === this.props.selectedNode\n              ? directlySelectedOutlineBatch\n              : indirectlySelectedOutlineBatch\n\n          const physicalRectBounds = configToPhysical.transformRect(configSpaceBounds)\n          batch.rect({\n            x: Math.round(physicalRectBounds.left() + 1 + frameOutlineWidth / 2),\n            y: Math.round(physicalRectBounds.top() + 1 + frameOutlineWidth / 2),\n            w: Math.round(Math.max(0, physicalRectBounds.width() - 2 - frameOutlineWidth)),\n            h: Math.round(Math.max(0, physicalRectBounds.height() - 2 - frameOutlineWidth)),\n          })\n        }\n      }\n      for (let child of frame.children) {\n        renderSpecialFrameOutlines(child, depth + 1)\n      }\n    }\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      renderSpecialFrameOutlines(frame)\n    }\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      renderFrameLabelAndChildren(frame)\n    }\n\n    const theme = this.props.theme\n\n    matchedFrameBatch.fill(ctx, theme.searchMatchPrimaryColor)\n    matchedTextHighlightBatch.fill(ctx, theme.searchMatchSecondaryColor)\n    fadedLabelBatch.fill(ctx, theme.fgSecondaryColor)\n    labelBatch.fill(\n      ctx,\n      this.props.searchResults != null ? theme.searchMatchTextColor : theme.fgPrimaryColor,\n    )\n    indirectlySelectedOutlineBatch.stroke(ctx, theme.selectionSecondaryColor, frameOutlineWidth)\n    directlySelectedOutlineBatch.stroke(ctx, theme.selectionPrimaryColor, frameOutlineWidth)\n\n    if (this.hoveredLabel) {\n      let color: string = theme.fgPrimaryColor\n      if (this.props.selectedNode === this.hoveredLabel.node) {\n        color = theme.selectionPrimaryColor\n      }\n\n      ctx.lineWidth = 2 * devicePixelRatio\n      ctx.strokeStyle = color\n\n      const physicalViewBounds = configToPhysical.transformRect(this.hoveredLabel.configSpaceBounds)\n      ctx.strokeRect(\n        Math.round(physicalViewBounds.left()),\n        Math.round(physicalViewBounds.top()),\n        Math.round(Math.max(0, physicalViewBounds.width())),\n        Math.round(Math.max(0, physicalViewBounds.height())),\n      )\n    }\n\n    this.renderTimeIndicators()\n  }\n\n  private renderTimeIndicators() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n\n    const physicalViewSpaceFrameHeight =\n      this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT * window.devicePixelRatio\n    const physicalViewSize = this.physicalViewSize()\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const labelPaddingPx = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2\n\n    const left = this.props.configSpaceViewportRect.left()\n    const right = this.props.configSpaceViewportRect.right()\n    // We want about 10 gridlines to be visible, and want the unit to be\n    // 1eN, 2eN, or 5eN for some N\n    // Ideally, we want an interval every 100 logical screen pixels\n    const logicalToConfig = (\n      this.configSpaceToPhysicalViewSpace().inverted() || new AffineTransform()\n    ).times(this.logicalToPhysicalViewSpace())\n    const targetInterval = logicalToConfig.transformVector(new Vec2(200, 1)).x\n    const minInterval = Math.pow(10, Math.floor(Math.log10(targetInterval)))\n    let interval = minInterval\n    if (targetInterval / interval > 5) {\n      interval *= 5\n    } else if (targetInterval / interval > 2) {\n      interval *= 2\n    }\n\n    const theme = this.props.theme\n\n    {\n      const y = this.props.renderInverted ? physicalViewSize.y - physicalViewSpaceFrameHeight : 0\n\n      ctx.fillStyle = Color.fromCSSHex(theme.bgPrimaryColor).withAlpha(0.8).toCSS()\n      ctx.fillRect(0, y, physicalViewSize.x, physicalViewSpaceFrameHeight)\n      ctx.textBaseline = 'top'\n      for (let x = Math.ceil(left / interval) * interval; x < right; x += interval) {\n        // TODO(jlfwong): Ensure that labels do not overlap\n        const pos = Math.round(configToPhysical.transformPosition(new Vec2(x, 0)).x)\n        const labelText = this.props.flamechart.formatValue(x)\n        const textWidth = cachedMeasureTextWidth(ctx, labelText)\n        ctx.fillStyle = theme.fgPrimaryColor\n        ctx.fillText(labelText, pos - textWidth - labelPaddingPx, y + labelPaddingPx)\n        ctx.fillStyle = theme.fgSecondaryColor\n        ctx.fillRect(pos, 0, 1, physicalViewSize.y)\n      }\n    }\n  }\n\n  private updateConfigSpaceViewport() {\n    if (!this.container) return\n    const {logicalSpaceViewportSize} = this.props\n    const bounds = this.container.getBoundingClientRect()\n    const {width, height} = bounds\n\n    // Still initializing: don't resize yet\n    if (width < 2 || height < 2) return\n\n    if (this.props.configSpaceViewportRect.isEmpty()) {\n      const configSpaceViewportHeight = height / this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n      if (this.props.renderInverted) {\n        this.setConfigSpaceViewportRect(\n          new Rect(\n            new Vec2(0, this.configSpaceSize().y - configSpaceViewportHeight + 1),\n            new Vec2(this.configSpaceSize().x, configSpaceViewportHeight),\n          ),\n        )\n      } else {\n        this.setConfigSpaceViewportRect(\n          new Rect(new Vec2(0, -1), new Vec2(this.configSpaceSize().x, configSpaceViewportHeight)),\n        )\n      }\n    } else if (\n      !logicalSpaceViewportSize.equals(Vec2.zero) &&\n      (logicalSpaceViewportSize.x !== width || logicalSpaceViewportSize.y !== height)\n    ) {\n      // Resize the viewport rectangle to match the window size aspect\n      // ratio.\n      this.setConfigSpaceViewportRect(\n        this.props.configSpaceViewportRect.withSize(\n          this.props.configSpaceViewportRect.size.timesPointwise(\n            new Vec2(width / logicalSpaceViewportSize.x, height / logicalSpaceViewportSize.y),\n          ),\n        ),\n      )\n    }\n\n    const newSize = new Vec2(width, height)\n    if (!newSize.equals(logicalSpaceViewportSize)) {\n      this.props.setLogicalSpaceViewportSize(newSize)\n    }\n  }\n\n  onWindowResize = () => {\n    this.updateConfigSpaceViewport()\n    this.onBeforeFrame()\n  }\n\n  private renderRects() {\n    if (!this.container) return\n    this.updateConfigSpaceViewport()\n\n    if (this.props.configSpaceViewportRect.isEmpty()) return\n\n    this.props.canvasContext.renderBehind(this.container, () => {\n      this.props.flamechartRenderer.render({\n        physicalSpaceDstRect: this.physicalBounds(),\n        configSpaceSrcRect: this.props.configSpaceViewportRect,\n        renderOutlines: true,\n      })\n    })\n  }\n\n  // Inertial scrolling introduces tricky interaction problems.\n  // Namely, if you start panning, and hit the edge of the scrollable\n  // area, the browser continues to receive WheelEvents from inertial\n  // scrolling. If we start zooming by holding Cmd + scrolling, then\n  // release the Cmd key, this can cause us to interpret the incoming\n  // inertial scrolling events as panning. To prevent this, we introduce\n  // a concept of an \"Interaction Lock\". Once a certain interaction has\n  // begun, we don't allow the other type of interaction to begin until\n  // we've received two frames with no inertial wheel events. This\n  // prevents us from accidentally switching between panning & zooming.\n  private frameHadWheelEvent = false\n  private framesWithoutWheelEvents = 0\n  private interactionLock: 'pan' | 'zoom' | null = null\n  private maybeClearInteractionLock = () => {\n    if (this.interactionLock) {\n      if (!this.frameHadWheelEvent) {\n        this.framesWithoutWheelEvents++\n        if (this.framesWithoutWheelEvents >= 2) {\n          this.interactionLock = null\n          this.framesWithoutWheelEvents = 0\n        }\n      }\n      this.props.canvasContext.requestFrame()\n    }\n    this.frameHadWheelEvent = false\n  }\n\n  private onBeforeFrame = () => {\n    this.resizeOverlayCanvasIfNeeded()\n    this.renderRects()\n    this.renderOverlays()\n    this.maybeClearInteractionLock()\n  }\n\n  private renderCanvas = () => {\n    this.props.canvasContext.requestFrame()\n  }\n\n  private pan(logicalViewSpaceDelta: Vec2) {\n    this.interactionLock = 'pan'\n\n    const physicalDelta = this.logicalToPhysicalViewSpace().transformVector(logicalViewSpaceDelta)\n    const configDelta = this.configSpaceToPhysicalViewSpace().inverseTransformVector(physicalDelta)\n\n    if (this.hoveredLabel) {\n      this.props.onNodeHover(null)\n    }\n\n    if (!configDelta) return\n    this.props.transformViewport(AffineTransform.withTranslation(configDelta))\n  }\n\n  private zoom(logicalViewSpaceCenter: Vec2, multiplier: number) {\n    this.interactionLock = 'zoom'\n\n    const physicalCenter = this.logicalToPhysicalViewSpace().transformPosition(\n      logicalViewSpaceCenter,\n    )\n    const configSpaceCenter = this.configSpaceToPhysicalViewSpace().inverseTransformPosition(\n      physicalCenter,\n    )\n    if (!configSpaceCenter) return\n\n    const zoomTransform = AffineTransform.withTranslation(configSpaceCenter.times(-1))\n      .scaledBy(new Vec2(multiplier, 1))\n      .translatedBy(configSpaceCenter)\n\n    this.props.transformViewport(zoomTransform)\n  }\n\n  private lastDragPos: Vec2 | null = null\n  private mouseDownPos: Vec2 | null = null\n  private onMouseDown = (ev: MouseEvent) => {\n    this.mouseDownPos = this.lastDragPos = new Vec2(ev.offsetX, ev.offsetY)\n    this.updateCursor()\n    window.addEventListener('mouseup', this.onWindowMouseUp)\n  }\n\n  private onMouseDrag = (ev: MouseEvent) => {\n    if (!this.lastDragPos) return\n    const logicalMousePos = new Vec2(ev.offsetX, ev.offsetY)\n    this.pan(this.lastDragPos.minus(logicalMousePos))\n    this.lastDragPos = logicalMousePos\n\n    // When panning by scrolling, the element under\n    // the cursor will change, so clear the hovered label.\n    if (this.hoveredLabel) {\n      this.props.onNodeHover(null)\n    }\n  }\n\n  private onDblClick = (ev: MouseEvent) => {\n    if (this.hoveredLabel) {\n      const hoveredBounds = this.hoveredLabel.configSpaceBounds\n      const viewportRect = new Rect(\n        hoveredBounds.origin.minus(new Vec2(0, 1)),\n        hoveredBounds.size.withY(this.props.configSpaceViewportRect.height()),\n      )\n      this.props.setConfigSpaceViewportRect(viewportRect)\n    }\n  }\n\n  private onClick = (ev: MouseEvent) => {\n    const logicalMousePos = new Vec2(ev.offsetX, ev.offsetY)\n    const mouseDownPos = this.mouseDownPos\n    this.mouseDownPos = null\n\n    if (mouseDownPos && logicalMousePos.minus(mouseDownPos).length() > 5) {\n      // If the cursor is more than 5 logical space pixels away from the mouse\n      // down location, then don't interpret this event as a click.\n      return\n    }\n\n    if (this.hoveredLabel) {\n      this.props.onNodeSelect(this.hoveredLabel.node)\n      this.renderCanvas()\n    } else {\n      this.props.onNodeSelect(null)\n    }\n  }\n\n  private updateCursor() {\n    if (this.lastDragPos) {\n      document.body.style.cursor = 'grabbing'\n      document.body.style.cursor = '-webkit-grabbing'\n    } else {\n      document.body.style.cursor = 'default'\n    }\n  }\n\n  private onWindowMouseUp = (ev: MouseEvent) => {\n    this.lastDragPos = null\n    this.updateCursor()\n    window.removeEventListener('mouseup', this.onWindowMouseUp)\n  }\n\n  private onMouseMove = (ev: MouseEvent) => {\n    this.updateCursor()\n    if (this.lastDragPos) {\n      ev.preventDefault()\n      this.onMouseDrag(ev)\n      return\n    }\n    this.hoveredLabel = null\n    const logicalViewSpaceMouse = new Vec2(ev.offsetX, ev.offsetY)\n    const physicalViewSpaceMouse = this.logicalToPhysicalViewSpace().transformPosition(\n      logicalViewSpaceMouse,\n    )\n    const configSpaceMouse = this.configSpaceToPhysicalViewSpace().inverseTransformPosition(\n      physicalViewSpaceMouse,\n    )\n\n    if (!configSpaceMouse) return\n\n    const setHoveredLabel = (frame: FlamechartFrame, depth = 0) => {\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n      if (configSpaceMouse.x < configSpaceBounds.left()) return null\n      if (configSpaceMouse.x > configSpaceBounds.right()) return null\n\n      if (configSpaceBounds.contains(configSpaceMouse)) {\n        this.hoveredLabel = {\n          configSpaceBounds,\n          node: frame.node,\n        }\n      }\n\n      for (let child of frame.children) {\n        setHoveredLabel(child, depth + 1)\n      }\n    }\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      setHoveredLabel(frame)\n    }\n\n    if (this.hoveredLabel) {\n      this.props.onNodeHover({node: this.hoveredLabel!.node, event: ev})\n    } else {\n      this.props.onNodeHover(null)\n    }\n\n    this.renderCanvas()\n  }\n\n  private onMouseLeave = (ev: MouseEvent) => {\n    this.hoveredLabel = null\n    this.props.onNodeHover(null)\n    this.renderCanvas()\n  }\n\n  private onWheel = (ev: WheelEvent) => {\n    ev.preventDefault()\n    this.frameHadWheelEvent = true\n\n    const isZoom = ev.metaKey || ev.ctrlKey\n\n    let deltaY = ev.deltaY\n    let deltaX = ev.deltaX\n    if (ev.deltaMode === ev.DOM_DELTA_LINE) {\n      deltaY *= this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n      deltaX *= this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n    }\n\n    if (isZoom && this.interactionLock !== 'pan') {\n      let multiplier = 1 + deltaY / 100\n\n      // On Chrome & Firefox, pinch-to-zoom maps to\n      // WheelEvent + Ctrl Key. We'll accelerate it in\n      // this case, since it feels a bit sluggish otherwise.\n      if (ev.ctrlKey) {\n        multiplier = 1 + deltaY / 40\n      }\n\n      multiplier = clamp(multiplier, 0.1, 10.0)\n\n      this.zoom(new Vec2(ev.offsetX, ev.offsetY), multiplier)\n    } else if (this.interactionLock !== 'zoom') {\n      this.pan(new Vec2(deltaX, deltaY))\n    }\n\n    this.renderCanvas()\n  }\n\n  onWindowKeyPress = (ev: KeyboardEvent) => {\n    if (!this.container) return\n    const {width, height} = this.container.getBoundingClientRect()\n\n    if (ev.key === '=' || ev.key === '+') {\n      this.zoom(new Vec2(width / 2, height / 2), 0.5)\n      ev.preventDefault()\n    } else if (ev.key === '-' || ev.key === '_') {\n      this.zoom(new Vec2(width / 2, height / 2), 2)\n      ev.preventDefault()\n    }\n\n    if (ev.ctrlKey || ev.shiftKey || ev.metaKey) return\n\n    // NOTE: We intentionally use ev.code rather than ev.key for\n    // WASD in order to have the keys retain the same layout even\n    // if the keyboard layout is not QWERTY.\n    //\n    // See: https://github.com/jlfwong/speedscope/pull/184\n    if (ev.key === '0') {\n      this.zoom(new Vec2(width / 2, height / 2), 1e9)\n    } else if (ev.key === 'ArrowRight' || ev.code === 'KeyD') {\n      this.pan(new Vec2(100, 0))\n    } else if (ev.key === 'ArrowLeft' || ev.code === 'KeyA') {\n      this.pan(new Vec2(-100, 0))\n    } else if (ev.key === 'ArrowUp' || ev.code === 'KeyW') {\n      this.pan(new Vec2(0, -100))\n    } else if (ev.key === 'ArrowDown' || ev.code === 'KeyS') {\n      this.pan(new Vec2(0, 100))\n    } else if (ev.key === 'Escape') {\n      this.props.onNodeSelect(null)\n      this.renderCanvas()\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n  componentWillReceiveProps(nextProps: FlamechartPanZoomViewProps) {\n    if (this.props.flamechart !== nextProps.flamechart) {\n      this.hoveredLabel = null\n      this.renderCanvas()\n    } else if (this.props.searchResults !== nextProps.searchResults) {\n      this.renderCanvas()\n    } else if (this.props.selectedNode !== nextProps.selectedNode) {\n      this.renderCanvas()\n    } else if (this.props.configSpaceViewportRect !== nextProps.configSpaceViewportRect) {\n      this.renderCanvas()\n    } else if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n  componentDidMount() {\n    this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n    window.addEventListener('resize', this.onWindowResize)\n    window.addEventListener('keydown', this.onWindowKeyPress)\n  }\n  componentWillUnmount() {\n    this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n    window.removeEventListener('resize', this.onWindowResize)\n    window.removeEventListener('keydown', this.onWindowKeyPress)\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div\n        className={css(style.panZoomView, commonStyle.vbox)}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onClick}\n        onDblClick={this.onDblClick}\n        onWheel={this.onWheel}\n        ref={this.containerRef}\n      >\n        <canvas width={1} height={1} ref={this.overlayCanvasRef} className={css(style.fill)} />\n      </div>\n    )\n  }\n}\n","import {Vec2} from '../lib/math'\nimport {Sizes, FontSize, FontFamily, ZIndex} from './style'\nimport {css, StyleSheet} from 'aphrodite'\nimport {ComponentChildren, h} from 'preact'\nimport {useTheme, withTheme} from './themes/theme'\nimport { useCallback } from 'preact/hooks'\n\ninterface HovertipProps {\n  containerSize: Vec2\n  offset: Vec2\n  children?: ComponentChildren\n}\n\nexport function Hovertip(props: HovertipProps) {\n  const style = getStyle(useTheme())\n\n  const {containerSize, offset} = props\n  const containerWidth = containerSize.x\n  const containerHeight = containerSize.y\n\n  const OFFSET_FROM_MOUSE = 7\n\n  const updateLocation = useCallback((el: HTMLDivElement | null) => {\n    if (!el) return\n\n    const clientRect = el.getBoundingClientRect()\n\n    // Place the hovertip to the right of the cursor.\n    let leftEdgeX = offset.x + OFFSET_FROM_MOUSE\n\n    // If this would cause it to overflow the container, align the right\n    // edge of the hovertip with the right edge of the container.\n    if (leftEdgeX + clientRect.width > containerWidth - 1) {\n      leftEdgeX = containerWidth - clientRect.width - 1\n\n      // If aligning the right edge overflows the container, align the left edge\n      // of the hovertip with the left edge of the container.\n      if (leftEdgeX < 1) { leftEdgeX = 1 }\n    }\n    el.style.left = `${leftEdgeX}px`\n\n    // Place the tooltip below the cursor\n    let topEdgeY = offset.y + OFFSET_FROM_MOUSE\n\n    // If this would cause it to overflow the container, place the hovertip\n    // above the cursor instead. This intentionally differs from the horizontal\n    // axis logic to avoid the cursor being in the middle of a hovertip when\n    // possible.\n    if (topEdgeY + clientRect.height > containerHeight - 1) {\n      topEdgeY = offset.y - clientRect.height - 1\n\n      // If placing the hovertip above the cursor overflows the container, align\n      // the top edge of the hovertip with the top edge of the container.\n      if (topEdgeY < 1) { topEdgeY = 1 }\n    }\n    el.style.top = `${topEdgeY}px`\n\n  }, [containerWidth, containerHeight, offset.x, offset.y])\n\n  return (\n    <div className={css(style.hoverTip)} ref={updateLocation}>\n      <div className={css(style.hoverTipRow)}>{props.children}</div>\n    </div>\n  )\n}\n\nconst HOVERTIP_PADDING = 2\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverTip: {\n      position: 'absolute',\n      background: theme.bgPrimaryColor,\n      border: '1px solid black',\n      maxWidth: Sizes.TOOLTIP_WIDTH_MAX,\n      paddingTop: HOVERTIP_PADDING,\n      paddingBottom: HOVERTIP_PADDING,\n      pointerEvents: 'none',\n      userSelect: 'none',\n      fontSize: FontSize.LABEL,\n      fontFamily: FontFamily.MONOSPACE,\n      zIndex: ZIndex.HOVERTIP,\n    },\n    hoverTipRow: {\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      overflowX: 'hidden',\n      paddingLeft: HOVERTIP_PADDING,\n      paddingRight: HOVERTIP_PADDING,\n      maxWidth: Sizes.TOOLTIP_WIDTH_MAX,\n    },\n  }),\n)\n","import {memo} from 'preact/compat'\nimport {useContext, useMemo, useCallback} from 'preact/hooks'\nimport {SearchView, ProfileSearchContext} from './search-view'\nimport {\n  FlamechartSearchMatch,\n  FlamechartSearchResults,\n  ProfileSearchResults,\n} from '../lib/profile-search'\nimport {Rect, Vec2} from '../lib/math'\nimport {h, createContext, ComponentChildren} from 'preact'\nimport {Flamechart} from '../lib/flamechart'\nimport {CallTreeNode} from '../lib/profile'\n\nexport const FlamechartSearchContext = createContext<FlamechartSearchData | null>(null)\n\nexport interface FlamechartSearchProps {\n  flamechart: Flamechart\n  selectedNode: CallTreeNode | null\n  setSelectedNode: (node: CallTreeNode | null) => void\n  configSpaceViewportRect: Rect\n  setConfigSpaceViewportRect: (rect: Rect) => void\n  children: ComponentChildren\n}\n\ninterface FlamechartSearchData {\n  results: FlamechartSearchResults | null\n  flamechart: Flamechart\n  selectedNode: CallTreeNode | null\n  setSelectedNode: (node: CallTreeNode | null) => void\n  configSpaceViewportRect: Rect\n  setConfigSpaceViewportRect: (rect: Rect) => void\n}\n\nexport const FlamechartSearchContextProvider = ({\n  flamechart,\n  selectedNode,\n  setSelectedNode,\n  configSpaceViewportRect,\n  setConfigSpaceViewportRect,\n  children,\n}: FlamechartSearchProps) => {\n  const profileSearchResults: ProfileSearchResults | null = useContext(ProfileSearchContext)\n  const flamechartSearchResults: FlamechartSearchResults | null = useMemo(() => {\n    if (profileSearchResults == null) {\n      return null\n    }\n    return new FlamechartSearchResults(flamechart, profileSearchResults)\n  }, [flamechart, profileSearchResults])\n\n  return (\n    <FlamechartSearchContext.Provider\n      value={{\n        results: flamechartSearchResults,\n        flamechart,\n        selectedNode,\n        setSelectedNode,\n        configSpaceViewportRect,\n        setConfigSpaceViewportRect,\n      }}\n    >\n      {children}\n    </FlamechartSearchContext.Provider>\n  )\n}\n\nexport const FlamechartSearchView = memo(() => {\n  const flamechartData = useContext(FlamechartSearchContext)\n\n  // TODO(jlfwong): This pattern is pretty gross, but I really don't want values\n  // that can be undefined or null.\n  const searchResults = flamechartData == null ? null : flamechartData.results\n  const selectedNode = flamechartData == null ? null : flamechartData.selectedNode\n  const setSelectedNode = flamechartData == null ? null : flamechartData.setSelectedNode\n  const configSpaceViewportRect =\n    flamechartData == null ? null : flamechartData.configSpaceViewportRect\n  const setConfigSpaceViewportRect =\n    flamechartData == null ? null : flamechartData.setConfigSpaceViewportRect\n  const flamechart = flamechartData == null ? null : flamechartData.flamechart\n\n  const numResults = searchResults == null ? null : searchResults.count()\n  const resultIndex: number | null = useMemo(() => {\n    if (searchResults == null) return null\n    if (selectedNode == null) return null\n    return searchResults.indexOf(selectedNode)\n  }, [searchResults, selectedNode])\n\n  const selectAndZoomToMatch = useCallback(\n    (match: FlamechartSearchMatch) => {\n      if (!setSelectedNode) return\n      if (!flamechart) return\n      if (!configSpaceViewportRect) return\n      if (!setConfigSpaceViewportRect) return\n\n      // After the node is selected, we want to set the viewport so that the new\n      // node can be seen clearly.\n      //\n      // TODO(jlfwong): The lack of animation here can be kind of jarring. It\n      // would be nice to have some easier way for people to orient themselves\n      // after the viewport shifted.\n      const configSpaceResultBounds = match.configSpaceBounds\n\n      const viewportRect = new Rect(\n        configSpaceResultBounds.origin.minus(new Vec2(0, 1)),\n        configSpaceResultBounds.size.withY(configSpaceViewportRect.height()),\n      )\n\n      setSelectedNode(match.node)\n      setConfigSpaceViewportRect(\n        flamechart.getClampedConfigSpaceViewportRect({configSpaceViewportRect: viewportRect}),\n      )\n    },\n    [configSpaceViewportRect, setConfigSpaceViewportRect, setSelectedNode, flamechart],\n  )\n\n  const {selectPrev, selectNext} = useMemo(() => {\n    if (numResults == null || numResults === 0 || searchResults == null) {\n      return {selectPrev: () => {}, selectNext: () => {}}\n    }\n\n    return {\n      selectPrev: () => {\n        if (!searchResults?.at) return\n        if (numResults == null || numResults === 0) return\n\n        let index = resultIndex == null ? numResults - 1 : resultIndex - 1\n        if (index < 0) index = numResults - 1\n        const result = searchResults.at(index)\n        selectAndZoomToMatch(result)\n      },\n\n      selectNext: () => {\n        if (!searchResults?.at) return\n        if (numResults == null || numResults === 0) return\n\n        let index = resultIndex == null ? 0 : resultIndex + 1\n        if (index >= numResults) index = 0\n        const result = searchResults.at(index)\n        selectAndZoomToMatch(result)\n      },\n    }\n  }, [numResults, resultIndex, searchResults, selectAndZoomToMatch])\n\n  return (\n    <SearchView\n      resultIndex={resultIndex}\n      numResults={numResults}\n      selectPrev={selectPrev}\n      selectNext={selectNext}\n    />\n  )\n})\n","import {Component} from 'preact'\n\nexport type VoidState = {\n  __dummyField: void\n}\nexport abstract class StatelessComponent<P> extends Component<P, VoidState> {}\n","import {h, Fragment} from 'preact'\nimport {css} from 'aphrodite'\n\nimport {CallTreeNode} from '../lib/profile'\n\nimport {Rect, Vec2, AffineTransform} from '../lib/math'\nimport {formatPercent} from '../lib/utils'\nimport {FlamechartMinimapView} from './flamechart-minimap-view'\n\nimport {Sizes, commonStyle} from './style'\nimport {FlamechartDetailView} from './flamechart-detail-view'\nimport {FlamechartPanZoomView} from './flamechart-pan-zoom-view'\nimport {Hovertip} from './hovertip'\nimport {FlamechartViewProps} from './flamechart-view-container'\nimport {ProfileSearchContext} from './search-view'\nimport {FlamechartSearchView} from './flamechart-search-view'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\nexport class FlamechartView extends StatelessComponent<FlamechartViewProps> {\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private setConfigSpaceViewportRect = (viewportRect: Rect): void => {\n    const configSpaceDetailViewHeight = Sizes.DETAIL_VIEW_HEIGHT / Sizes.FRAME_HEIGHT\n\n    const configSpaceSize = this.configSpaceSize()\n\n    const width = this.props.flamechart.getClampedViewportWidth(viewportRect.size.x)\n    const size = viewportRect.size.withX(width)\n\n    const origin = Vec2.clamp(\n      viewportRect.origin,\n      new Vec2(0, -1),\n      Vec2.max(\n        Vec2.zero,\n        configSpaceSize.minus(size).plus(new Vec2(0, configSpaceDetailViewHeight + 1)),\n      ),\n    )\n\n    this.props.setConfigSpaceViewportRect(new Rect(origin, viewportRect.size.withX(width)))\n  }\n\n  private setLogicalSpaceViewportSize = (logicalSpaceViewportSize: Vec2): void => {\n    this.props.setLogicalSpaceViewportSize(logicalSpaceViewportSize)\n  }\n\n  private transformViewport = (transform: AffineTransform): void => {\n    const viewportRect = transform.transformRect(this.props.configSpaceViewportRect)\n    this.setConfigSpaceViewportRect(viewportRect)\n  }\n\n  private onNodeHover = (hover: {node: CallTreeNode; event: MouseEvent} | null) => {\n    this.props.setNodeHover(hover)\n  }\n\n  onNodeClick = (node: CallTreeNode | null) => {\n    this.props.setSelectedNode(node)\n  }\n\n  formatValue(weight: number) {\n    const totalWeight = this.props.flamechart.getTotalWeight()\n    const percent = (100 * weight) / totalWeight\n    const formattedPercent = formatPercent(percent)\n    return `${this.props.flamechart.formatValue(weight)} (${formattedPercent})`\n  }\n\n  renderTooltip() {\n    if (!this.container) return null\n\n    const {hover} = this.props\n    if (!hover) return null\n    const {width, height, left, top} = this.container.getBoundingClientRect()\n    const offset = new Vec2(hover.event.clientX - left, hover.event.clientY - top)\n    const frame = hover.node.frame\n\n    const style = this.getStyle()\n\n    return (\n      <Hovertip containerSize={new Vec2(width, height)} offset={offset}>\n        <span className={css(style.hoverCount)}>\n          {this.formatValue(hover.node.frame.getTotalWeight())}\n        </span>{' '}\n        {frame.name}\n        {frame.file ? (\n          <div>\n            {frame.file}:{frame.line}\n          </div>\n        ) : undefined}\n      </Hovertip>\n    )\n  }\n\n  container: HTMLDivElement | null = null\n  containerRef = (container: Element | null) => {\n    this.container = (container as HTMLDivElement) || null\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.fill, commonStyle.vbox)} ref={this.containerRef}>\n        <FlamechartMinimapView\n          theme={this.props.theme}\n          configSpaceViewportRect={this.props.configSpaceViewportRect}\n          transformViewport={this.transformViewport}\n          flamechart={this.props.flamechart}\n          flamechartRenderer={this.props.flamechartRenderer}\n          canvasContext={this.props.canvasContext}\n          setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n        />\n        <ProfileSearchContext.Consumer>\n          {searchResults => (\n            <Fragment>\n              <FlamechartPanZoomView\n                theme={this.props.theme}\n                canvasContext={this.props.canvasContext}\n                flamechart={this.props.flamechart}\n                flamechartRenderer={this.props.flamechartRenderer}\n                renderInverted={false}\n                onNodeHover={this.onNodeHover}\n                onNodeSelect={this.onNodeClick}\n                selectedNode={this.props.selectedNode}\n                transformViewport={this.transformViewport}\n                configSpaceViewportRect={this.props.configSpaceViewportRect}\n                setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n                logicalSpaceViewportSize={this.props.logicalSpaceViewportSize}\n                setLogicalSpaceViewportSize={this.setLogicalSpaceViewportSize}\n                searchResults={searchResults}\n              />\n              <FlamechartSearchView />\n            </Fragment>\n          )}\n        </ProfileSearchContext.Consumer>\n        {this.renderTooltip()}\n        {this.props.selectedNode && (\n          <FlamechartDetailView\n            flamechart={this.props.flamechart}\n            getCSSColorForFrame={this.props.getCSSColorForFrame}\n            selectedNode={this.props.selectedNode}\n          />\n        )}\n      </div>\n    )\n  }\n}\n","import {h} from 'preact'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {Flamechart} from '../lib/flamechart'\nimport {FlamechartRenderer, FlamechartRendererOptions} from '../gl/flamechart-renderer'\nimport {Frame, Profile, CallTreeNode} from '../lib/profile'\nimport {memoizeByShallowEquality} from '../lib/utils'\nimport {FlamechartView} from './flamechart-view'\nimport {\n  getRowAtlas,\n  createGetColorBucketForFrame,\n  getCanvasContext,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {Vec2, Rect} from '../lib/math'\nimport {memo, useCallback} from 'preact/compat'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {FlamechartSearchContextProvider} from './flamechart-search-view'\nimport {Theme, useTheme} from './themes/theme'\nimport {FlamechartID, FlamechartViewState} from '../app-state/profile-group'\nimport {profileGroupAtom} from '../app-state'\n\ninterface FlamechartSetters {\n  setLogicalSpaceViewportSize: (logicalSpaceViewportSize: Vec2) => void\n  setConfigSpaceViewportRect: (configSpaceViewportRect: Rect) => void\n  setNodeHover: (hover: {node: CallTreeNode; event: MouseEvent} | null) => void\n  setSelectedNode: (node: CallTreeNode | null) => void\n}\n\nexport function useFlamechartSetters(id: FlamechartID): FlamechartSetters {\n  return {\n    setNodeHover: useCallback(\n      (hover: {node: CallTreeNode; event: MouseEvent} | null) => {\n        profileGroupAtom.setFlamechartHoveredNode(id, hover)\n      },\n      [id],\n    ),\n    setLogicalSpaceViewportSize: useCallback(\n      (logicalSpaceViewportSize: Vec2) => {\n        profileGroupAtom.setLogicalSpaceViewportSize(id, logicalSpaceViewportSize)\n      },\n      [id],\n    ),\n    setConfigSpaceViewportRect: useCallback(\n      (configSpaceViewportRect: Rect) => {\n        profileGroupAtom.setConfigSpaceViewportRect(id, configSpaceViewportRect)\n      },\n      [id],\n    ),\n    setSelectedNode: useCallback(\n      (selectedNode: CallTreeNode | null) => {\n        profileGroupAtom.setSelectedNode(id, selectedNode)\n      },\n      [id],\n    ),\n  }\n}\n\nexport type FlamechartViewProps = {\n  theme: Theme\n  canvasContext: CanvasContext\n  flamechart: Flamechart\n  flamechartRenderer: FlamechartRenderer\n  renderInverted: boolean\n  getCSSColorForFrame: (frame: Frame) => string\n} & FlamechartSetters &\n  FlamechartViewState\n\nexport const getChronoViewFlamechart = memoizeByShallowEquality(\n  ({\n    profile,\n    getColorBucketForFrame,\n  }: {\n    profile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: profile.getTotalWeight.bind(profile),\n      forEachCall: profile.forEachCall.bind(profile),\n      formatValue: profile.formatValue.bind(profile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nexport const createMemoizedFlamechartRenderer = (options?: FlamechartRendererOptions) =>\n  memoizeByShallowEquality(\n    ({\n      canvasContext,\n      flamechart,\n    }: {\n      canvasContext: CanvasContext\n      flamechart: Flamechart\n    }): FlamechartRenderer => {\n      return new FlamechartRenderer(\n        canvasContext.gl,\n        getRowAtlas(canvasContext),\n        flamechart,\n        canvasContext.rectangleBatchRenderer,\n        canvasContext.flamechartColorPassRenderer,\n        options,\n      )\n    },\n  )\n\nconst getChronoViewFlamechartRenderer = createMemoizedFlamechartRenderer()\n\nexport interface FlamechartViewContainerProps {\n  activeProfileState: ActiveProfileState\n  glCanvas: HTMLCanvasElement\n}\n\nexport const ChronoFlamechartView = memo((props: FlamechartViewContainerProps) => {\n  const {activeProfileState, glCanvas} = props\n  const {profile, chronoViewState} = activeProfileState\n\n  const theme = useTheme()\n\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const flamechart = getChronoViewFlamechart({profile, getColorBucketForFrame})\n  const flamechartRenderer = getChronoViewFlamechartRenderer({\n    canvasContext,\n    flamechart,\n  })\n\n  const setters = useFlamechartSetters(FlamechartID.CHRONO)\n\n  return (\n    <FlamechartSearchContextProvider\n      flamechart={flamechart}\n      selectedNode={chronoViewState.selectedNode}\n      setSelectedNode={setters.setSelectedNode}\n      configSpaceViewportRect={chronoViewState.configSpaceViewportRect}\n      setConfigSpaceViewportRect={setters.setConfigSpaceViewportRect}\n    >\n      <FlamechartView\n        theme={theme}\n        renderInverted={false}\n        flamechart={flamechart}\n        flamechartRenderer={flamechartRenderer}\n        canvasContext={canvasContext}\n        getCSSColorForFrame={getCSSColorForFrame}\n        {...chronoViewState}\n        {...setters}\n      />\n    </FlamechartSearchContextProvider>\n  )\n})\n\nexport const getLeftHeavyFlamechart = memoizeByShallowEquality(\n  ({\n    profile,\n    getColorBucketForFrame,\n  }: {\n    profile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: profile.getTotalNonIdleWeight.bind(profile),\n      forEachCall: profile.forEachCallGrouped.bind(profile),\n      formatValue: profile.formatValue.bind(profile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nconst getLeftHeavyFlamechartRenderer = createMemoizedFlamechartRenderer()\n\nexport const LeftHeavyFlamechartView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState, glCanvas} = ownProps\n\n  const {profile, leftHeavyViewState} = activeProfileState\n\n  const theme = useTheme()\n\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const flamechart = getLeftHeavyFlamechart({\n    profile,\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getLeftHeavyFlamechartRenderer({\n    canvasContext,\n    flamechart,\n  })\n\n  const setters = useFlamechartSetters(FlamechartID.LEFT_HEAVY)\n\n  return (\n    <FlamechartSearchContextProvider\n      flamechart={flamechart}\n      selectedNode={leftHeavyViewState.selectedNode}\n      setSelectedNode={setters.setSelectedNode}\n      configSpaceViewportRect={leftHeavyViewState.configSpaceViewportRect}\n      setConfigSpaceViewportRect={setters.setConfigSpaceViewportRect}\n    >\n      <FlamechartView\n        theme={theme}\n        renderInverted={false}\n        flamechart={flamechart}\n        flamechartRenderer={flamechartRenderer}\n        canvasContext={canvasContext}\n        getCSSColorForFrame={getCSSColorForFrame}\n        {...leftHeavyViewState}\n        {...setters}\n      />\n    </FlamechartSearchContextProvider>\n  )\n})\n","import {CallTreeNode} from '../lib/profile'\nimport {StyleSheet, css} from 'aphrodite'\nimport {h} from 'preact'\nimport {commonStyle} from './style'\nimport {Rect, AffineTransform, Vec2} from '../lib/math'\nimport {FlamechartPanZoomView} from './flamechart-pan-zoom-view'\nimport {noop, formatPercent} from '../lib/utils'\nimport {Hovertip} from './hovertip'\nimport {FlamechartViewProps} from './flamechart-view-container'\nimport {withTheme} from './themes/theme'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\nexport class FlamechartWrapper extends StatelessComponent<FlamechartViewProps> {\n  private clampViewportToFlamegraph(viewportRect: Rect) {\n    const {flamechart, renderInverted} = this.props\n    return flamechart.getClampedConfigSpaceViewportRect({\n      configSpaceViewportRect: viewportRect,\n      renderInverted,\n    })\n  }\n  private setConfigSpaceViewportRect = (configSpaceViewportRect: Rect) => {\n    this.props.setConfigSpaceViewportRect(this.clampViewportToFlamegraph(configSpaceViewportRect))\n  }\n  private setLogicalSpaceViewportSize = (logicalSpaceViewportSize: Vec2): void => {\n    this.props.setLogicalSpaceViewportSize(logicalSpaceViewportSize)\n  }\n\n  private transformViewport = (transform: AffineTransform) => {\n    this.setConfigSpaceViewportRect(transform.transformRect(this.props.configSpaceViewportRect))\n  }\n  private formatValue(weight: number) {\n    const totalWeight = this.props.flamechart.getTotalWeight()\n    const percent = (100 * weight) / totalWeight\n    const formattedPercent = formatPercent(percent)\n    return `${this.props.flamechart.formatValue(weight)} (${formattedPercent})`\n  }\n  private renderTooltip() {\n    if (!this.container) return null\n    const {hover} = this.props\n    if (!hover) return null\n    const {width, height, left, top} = this.container.getBoundingClientRect()\n    const offset = new Vec2(hover.event.clientX - left, hover.event.clientY - top)\n    const style = getStyle(this.props.theme)\n    const frame = hover.node.frame\n\n    return (\n      <Hovertip containerSize={new Vec2(width, height)} offset={offset}>\n        <span className={css(style.hoverCount)}>\n          {this.formatValue(hover.node.getTotalWeight())}\n        </span>{' '}\n        {frame.name}\n        {frame.file ? (\n          <div>\n            {frame.file}:{frame.line}\n          </div>\n        ) : undefined}\n      </Hovertip>\n    )\n  }\n  container: HTMLDivElement | null = null\n  containerRef = (container: Element | null) => {\n    this.container = (container as HTMLDivElement) || null\n  }\n  private setNodeHover = (\n    hover: {\n      node: CallTreeNode\n      event: MouseEvent\n    } | null,\n  ) => {\n    this.props.setNodeHover(hover)\n  }\n  render() {\n    return (\n      <div\n        className={css(commonStyle.fillY, commonStyle.fillX, commonStyle.vbox)}\n        ref={this.containerRef}\n      >\n        <FlamechartPanZoomView\n          theme={this.props.theme}\n          selectedNode={null}\n          onNodeHover={this.setNodeHover}\n          onNodeSelect={noop}\n          configSpaceViewportRect={this.props.configSpaceViewportRect}\n          setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n          transformViewport={this.transformViewport}\n          flamechart={this.props.flamechart}\n          flamechartRenderer={this.props.flamechartRenderer}\n          canvasContext={this.props.canvasContext}\n          renderInverted={this.props.renderInverted}\n          logicalSpaceViewportSize={this.props.logicalSpaceViewportSize}\n          setLogicalSpaceViewportSize={this.setLogicalSpaceViewportSize}\n          searchResults={null}\n        />\n        {this.renderTooltip()}\n      </div>\n    )\n  }\n}\n\nexport const getStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverCount: {\n      color: theme.weightColor,\n    },\n  }),\n)\n","import {memoizeByShallowEquality, noop} from '../lib/utils'\nimport {Profile, Frame} from '../lib/profile'\nimport {Flamechart} from '../lib/flamechart'\nimport {\n  createMemoizedFlamechartRenderer,\n  FlamechartViewContainerProps,\n  useFlamechartSetters,\n} from './flamechart-view-container'\nimport {\n  getCanvasContext,\n  createGetColorBucketForFrame,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {FlamechartWrapper} from './flamechart-wrapper'\nimport {h} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useTheme} from './themes/theme'\nimport {FlamechartID} from '../app-state/profile-group'\nimport {flattenRecursionAtom, glCanvasAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nconst getInvertedCallerProfile = memoizeByShallowEquality(\n  ({\n    profile,\n    frame,\n    flattenRecursion,\n  }: {\n    profile: Profile\n    frame: Frame\n    flattenRecursion: boolean\n  }): Profile => {\n    let p = profile.getInvertedProfileForCallersOf(frame)\n    return flattenRecursion ? p.getProfileWithRecursionFlattened() : p\n  },\n)\n\nconst getInvertedCallerFlamegraph = memoizeByShallowEquality(\n  ({\n    invertedCallerProfile,\n    getColorBucketForFrame,\n  }: {\n    invertedCallerProfile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: invertedCallerProfile.getTotalNonIdleWeight.bind(invertedCallerProfile),\n      forEachCall: invertedCallerProfile.forEachCallGrouped.bind(invertedCallerProfile),\n      formatValue: invertedCallerProfile.formatValue.bind(invertedCallerProfile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nconst getInvertedCallerFlamegraphRenderer = createMemoizedFlamechartRenderer({inverted: true})\n\nexport const InvertedCallerFlamegraphView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  let {profile, sandwichViewState} = activeProfileState\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const glCanvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n\n  if (!profile) throw new Error('profile missing')\n  if (!glCanvas) throw new Error('glCanvas missing')\n  const {callerCallee} = sandwichViewState\n  if (!callerCallee) throw new Error('callerCallee missing')\n  const {selectedFrame} = callerCallee\n\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n\n  const flamechart = getInvertedCallerFlamegraph({\n    invertedCallerProfile: getInvertedCallerProfile({\n      profile,\n      frame: selectedFrame,\n      flattenRecursion,\n    }),\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getInvertedCallerFlamegraphRenderer({canvasContext, flamechart})\n\n  return (\n    <FlamechartWrapper\n      theme={theme}\n      renderInverted={true}\n      flamechart={flamechart}\n      flamechartRenderer={flamechartRenderer}\n      canvasContext={canvasContext}\n      getCSSColorForFrame={getCSSColorForFrame}\n      {...useFlamechartSetters(FlamechartID.SANDWICH_INVERTED_CALLERS)}\n      {...callerCallee.invertedCallerFlamegraph}\n      // This overrides the setSelectedNode specified in useFlamechartSettesr\n      setSelectedNode={noop}\n    />\n  )\n})\n","import {memoizeByShallowEquality, noop} from '../lib/utils'\nimport {Profile, Frame} from '../lib/profile'\nimport {Flamechart} from '../lib/flamechart'\nimport {\n  createMemoizedFlamechartRenderer,\n  FlamechartViewContainerProps,\n  useFlamechartSetters,\n} from './flamechart-view-container'\nimport {\n  getCanvasContext,\n  createGetColorBucketForFrame,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {FlamechartWrapper} from './flamechart-wrapper'\nimport {h} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useTheme} from './themes/theme'\nimport {FlamechartID} from '../app-state/profile-group'\nimport {flattenRecursionAtom, glCanvasAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nconst getCalleeProfile = memoizeByShallowEquality<\n  {\n    profile: Profile\n    frame: Frame\n    flattenRecursion: boolean\n  },\n  Profile\n>(({profile, frame, flattenRecursion}) => {\n  let p = profile.getProfileForCalleesOf(frame)\n  return flattenRecursion ? p.getProfileWithRecursionFlattened() : p\n})\n\nconst getCalleeFlamegraph = memoizeByShallowEquality<\n  {\n    calleeProfile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  },\n  Flamechart\n>(({calleeProfile, getColorBucketForFrame}) => {\n  return new Flamechart({\n    getTotalWeight: calleeProfile.getTotalNonIdleWeight.bind(calleeProfile),\n    forEachCall: calleeProfile.forEachCallGrouped.bind(calleeProfile),\n    formatValue: calleeProfile.formatValue.bind(calleeProfile),\n    getColorBucketForFrame,\n  })\n})\n\nconst getCalleeFlamegraphRenderer = createMemoizedFlamechartRenderer()\n\nexport const CalleeFlamegraphView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  const {profile, sandwichViewState} = activeProfileState\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const glCanvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n\n  if (!profile) throw new Error('profile missing')\n  if (!glCanvas) throw new Error('glCanvas missing')\n  const {callerCallee} = sandwichViewState\n  if (!callerCallee) throw new Error('callerCallee missing')\n  const {selectedFrame} = callerCallee\n\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n\n  const flamechart = getCalleeFlamegraph({\n    calleeProfile: getCalleeProfile({profile, frame: selectedFrame, flattenRecursion}),\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getCalleeFlamegraphRenderer({canvasContext, flamechart})\n\n  return (\n    <FlamechartWrapper\n      theme={theme}\n      renderInverted={false}\n      flamechart={flamechart}\n      flamechartRenderer={flamechartRenderer}\n      canvasContext={canvasContext}\n      getCSSColorForFrame={getCSSColorForFrame}\n      {...useFlamechartSetters(FlamechartID.SANDWICH_CALLEES)}\n      {...callerCallee.calleeFlamegraph}\n      // This overrides the setSelectedNode specified in useFlamechartSettesr\n      setSelectedNode={noop}\n    />\n  )\n})\n","import {memo} from 'preact/compat'\nimport {useContext, useMemo} from 'preact/hooks'\nimport {SearchView} from './search-view'\nimport {h} from 'preact'\nimport {SandwichViewContext} from './sandwich-view'\n\nexport const SandwichSearchView = memo(() => {\n  const sandwichViewContext = useContext(SandwichViewContext)\n\n  const rowList = sandwichViewContext != null ? sandwichViewContext.rowList : null\n  const resultIndex =\n    sandwichViewContext?.selectedFrame != null\n      ? sandwichViewContext.getIndexForFrame(sandwichViewContext.selectedFrame)\n      : null\n  const numResults = rowList != null ? rowList.length : null\n\n  const {selectPrev, selectNext} = useMemo(() => {\n    if (rowList == null || numResults == null || numResults === 0 || sandwichViewContext == null) {\n      return {selectPrev: () => {}, selectNext: () => {}}\n    }\n\n    return {\n      selectPrev: () => {\n        let index = resultIndex == null ? numResults - 1 : resultIndex - 1\n        if (index < 0) index = numResults - 1\n        sandwichViewContext.setSelectedFrame(rowList[index])\n      },\n      selectNext: () => {\n        let index = resultIndex == null ? 0 : resultIndex + 1\n        if (index >= numResults) index = 0\n        sandwichViewContext.setSelectedFrame(rowList[index])\n      },\n    }\n  }, [resultIndex, rowList, numResults, sandwichViewContext])\n\n  return (\n    <SearchView\n      resultIndex={resultIndex}\n      numResults={numResults}\n      selectPrev={selectPrev}\n      selectNext={selectNext}\n    />\n  )\n})\n","import {Frame} from '../lib/profile'\nimport {StyleSheet, css} from 'aphrodite'\nimport {ProfileTableViewContainer} from './profile-table-view'\nimport {h, JSX, createContext} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useCallback, useMemo, useContext} from 'preact/hooks'\nimport {commonStyle, Sizes, FontSize} from './style'\nimport {InvertedCallerFlamegraphView} from './inverted-caller-flamegraph-view'\nimport {CalleeFlamegraphView} from './callee-flamegraph-view'\nimport {SandwichSearchView} from './sandwich-search-view'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {sortBy} from '../lib/utils'\nimport {ProfileSearchContext} from './search-view'\nimport {Theme, useTheme, withTheme} from './themes/theme'\nimport {SortField, SortDirection, profileGroupAtom, tableSortMethodAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\ninterface SandwichViewProps {\n  selectedFrame: Frame | null\n  profileIndex: number\n  theme: Theme\n  activeProfileState: ActiveProfileState\n  setSelectedFrame: (selectedFrame: Frame | null) => void\n  glCanvas: HTMLCanvasElement\n}\n\nclass SandwichView extends StatelessComponent<SandwichViewProps> {\n  private setSelectedFrame = (selectedFrame: Frame | null) => {\n    this.props.setSelectedFrame(selectedFrame)\n  }\n\n  onWindowKeyPress = (ev: KeyboardEvent) => {\n    if (ev.key === 'Escape') {\n      this.setSelectedFrame(null)\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.onWindowKeyPress)\n  }\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onWindowKeyPress)\n  }\n\n  render() {\n    const style = getStyle(this.props.theme)\n\n    const {selectedFrame} = this.props\n    let flamegraphViews: JSX.Element | null = null\n\n    if (selectedFrame) {\n      flamegraphViews = (\n        <div className={css(commonStyle.fillY, style.callersAndCallees, commonStyle.vbox)}>\n          <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n            <div className={css(style.flamechartLabelParent)}>\n              <div className={css(style.flamechartLabel)}>Callers</div>\n            </div>\n            <InvertedCallerFlamegraphView\n              glCanvas={this.props.glCanvas}\n              activeProfileState={this.props.activeProfileState}\n            />\n          </div>\n          <div className={css(style.divider)} />\n          <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n            <div className={css(style.flamechartLabelParent, style.flamechartLabelParentBottom)}>\n              <div className={css(style.flamechartLabel, style.flamechartLabelBottom)}>Callees</div>\n            </div>\n            <CalleeFlamegraphView\n              glCanvas={this.props.glCanvas}\n              activeProfileState={this.props.activeProfileState}\n            />\n          </div>\n        </div>\n      )\n    }\n\n    return (\n      <div className={css(commonStyle.hbox, commonStyle.fillY)}>\n        <div className={css(style.tableView)}>\n          <ProfileTableViewContainer activeProfileState={this.props.activeProfileState} />\n          <SandwichSearchView />\n        </div>\n        {flamegraphViews}\n      </div>\n    )\n  }\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    tableView: {\n      position: 'relative',\n      flex: 1,\n    },\n    panZoomViewWraper: {\n      flex: 1,\n    },\n    flamechartLabelParent: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'flex-end',\n      alignItems: 'flex-start',\n      fontSize: FontSize.TITLE,\n      width: FontSize.TITLE * 1.2,\n      borderRight: `1px solid ${theme.fgSecondaryColor}`,\n    },\n    flamechartLabelParentBottom: {\n      justifyContent: 'flex-start',\n    },\n    flamechartLabel: {\n      transform: 'rotate(-90deg)',\n      transformOrigin: '50% 50% 0',\n      width: FontSize.TITLE * 1.2,\n      flexShrink: 1,\n    },\n    flamechartLabelBottom: {\n      transform: 'rotate(-90deg)',\n      display: 'flex',\n      justifyContent: 'flex-end',\n    },\n    callersAndCallees: {\n      flex: 1,\n      borderLeft: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n    },\n    divider: {\n      height: 2,\n      background: theme.fgSecondaryColor,\n    },\n  }),\n)\n\ninterface SandwichViewContainerProps {\n  activeProfileState: ActiveProfileState\n  glCanvas: HTMLCanvasElement\n}\n\ninterface SandwichViewContextData {\n  rowList: Frame[]\n  selectedFrame: Frame | null\n  setSelectedFrame: (frame: Frame | null) => void\n  getIndexForFrame: (frame: Frame) => number | null\n  getSearchMatchForFrame: (frame: Frame) => [number, number][] | null\n}\n\nexport const SandwichViewContext = createContext<SandwichViewContextData | null>(null)\n\nexport const SandwichViewContainer = memo((ownProps: SandwichViewContainerProps) => {\n  const {activeProfileState, glCanvas} = ownProps\n  const {sandwichViewState, index} = activeProfileState\n  const {callerCallee} = sandwichViewState\n\n  const theme = useTheme()\n  const setSelectedFrame = useCallback((selectedFrame: Frame | null) => {\n    profileGroupAtom.setSelectedFrame(selectedFrame)\n  }, [])\n\n  const profile = activeProfileState.profile\n  const tableSortMethod = useAtom(tableSortMethodAtom)\n  const profileSearchResults = useContext(ProfileSearchContext)\n\n  const selectedFrame = callerCallee ? callerCallee.selectedFrame : null\n\n  const rowList: Frame[] = useMemo(() => {\n    const rowList: Frame[] = []\n\n    profile.forEachFrame(frame => {\n      if (profileSearchResults && !profileSearchResults.getMatchForFrame(frame)) {\n        return\n      }\n      rowList.push(frame)\n    })\n\n    switch (tableSortMethod.field) {\n      case SortField.SYMBOL_NAME: {\n        sortBy(rowList, f => f.name.toLowerCase())\n        break\n      }\n      case SortField.SELF: {\n        sortBy(rowList, f => f.getSelfWeight())\n        break\n      }\n      case SortField.TOTAL: {\n        sortBy(rowList, f => f.getTotalWeight())\n        break\n      }\n    }\n    if (tableSortMethod.direction === SortDirection.DESCENDING) {\n      rowList.reverse()\n    }\n\n    return rowList\n  }, [profile, profileSearchResults, tableSortMethod])\n\n  const getIndexForFrame: (frame: Frame) => number | null = useMemo(() => {\n    const indexByFrame = new Map<Frame, number>()\n    for (let i = 0; i < rowList.length; i++) {\n      indexByFrame.set(rowList[i], i)\n    }\n    return (frame: Frame) => {\n      const index = indexByFrame.get(frame)\n      return index == null ? null : index\n    }\n  }, [rowList])\n\n  const getSearchMatchForFrame: (frame: Frame) => [number, number][] | null = useMemo(() => {\n    return (frame: Frame) => {\n      if (profileSearchResults == null) return null\n      return profileSearchResults.getMatchForFrame(frame)\n    }\n  }, [profileSearchResults])\n\n  const contextData: SandwichViewContextData = {\n    rowList,\n    selectedFrame,\n    setSelectedFrame,\n    getIndexForFrame,\n    getSearchMatchForFrame,\n  }\n\n  return (\n    <SandwichViewContext.Provider value={contextData}>\n      <SandwichView\n        theme={theme}\n        activeProfileState={activeProfileState}\n        glCanvas={glCanvas}\n        setSelectedFrame={setSelectedFrame}\n        selectedFrame={selectedFrame}\n        profileIndex={index}\n      />\n    </SandwichViewContext.Provider>\n  )\n})\n","import {h} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\n\nimport {CallTreeNode, Frame, Profile, ProfileGroup} from '../lib/profile'\nimport {FontFamily, FontSize, Duration} from './style'\nimport {SandwichViewContainer} from './sandwich-view'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {LeftHeavyFlamechartView, ChronoFlamechartView} from './flamechart-view-container'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {Theme, withTheme} from './themes/theme'\nimport {ViewMode} from '../lib/view-mode'\nimport {ProfileGroupState} from '../app-state/profile-group'\nimport {HashParams} from '../lib/hash-params'\nimport {StatelessComponent} from '../lib/preact-helpers'\nimport { CallTree } from './app_types'\n\ndeclare global {\n  interface Window { sample: boolean; }\n}\n\nfunction convert(root: CallTree): Profile {\n  console.log(root);\n  if (!root.children) {\n    return new Profile(0);\n  }\n\n  const sum = root.children.reduce((n, i) => i.total_samples + n, 0);\n  const prof = new Profile(sum);\n  prof.setName(\"a\");\n\n  let root_node = new CallTreeNode(Frame.root, null);\n\n  function aux(curr: CallTreeNode, curr_node: CallTree): CallTreeNode {\n    curr.frame = Frame.getOrInsert(prof.frames, {\n      color_key: curr_node.item?.code_type ?? \"\",\n      key: curr_node.item?.name ?? \"\",\n      name: curr_node.item?.name ?? \"(unk)\",\n    });\n    curr.frame.addToSelfWeight(curr_node.self_samples);\n    curr.frame.addToTotalWeight(curr_node.total_samples);\n\n    if (curr_node.total_samples > 0) {\n      prof.samples.push(curr);\n      prof.weights.push(curr_node.self_samples);\n    }\n\n    for (let child_node of curr_node.children ?? []) {\n      const child_ctn = new CallTreeNode(Frame.root, curr);\n      aux(child_ctn, child_node);\n    }\n    return curr;\n  }\n\n  aux(root_node, root);\n  return prof;\n}\n\n\n// Force eager loading of a few code-split modules.\n//\n// We put them all in one place so we can directly control the relative priority\n// of these.\nimport('../lib/demangle-cpp').then(() => {})\nimport('source-map').then(() => {})\n\ndeclare function require(x: string): any\n\ninterface GLCanvasProps {\n  canvasContext: CanvasContext | null\n  theme: Theme\n  setGLCanvas: (canvas: HTMLCanvasElement | null) => void\n}\nexport class GLCanvas extends StatelessComponent<GLCanvasProps> {\n  private canvas: HTMLCanvasElement | null = null\n\n  private ref = (canvas: Element | null) => {\n    if (canvas instanceof HTMLCanvasElement) {\n      this.canvas = canvas\n    } else {\n      this.canvas = null\n    }\n\n    this.props.setGLCanvas(this.canvas)\n  }\n\n  private container: HTMLElement | null = null\n  private containerRef = (container: Element | null) => {\n    if (container instanceof HTMLElement) {\n      this.container = container\n    } else {\n      this.container = null\n    }\n  }\n\n  private maybeResize = () => {\n    if (!this.container) return\n    if (!this.props.canvasContext) return\n\n    let {width, height} = this.container.getBoundingClientRect()\n\n    const widthInAppUnits = width\n    const heightInAppUnits = height\n    const widthInPixels = width * window.devicePixelRatio\n    const heightInPixels = height * window.devicePixelRatio\n\n    this.props.canvasContext.gl.resize(\n      widthInPixels,\n      heightInPixels,\n      widthInAppUnits,\n      heightInAppUnits,\n    )\n  }\n\n  onWindowResize = () => {\n    if (this.props.canvasContext) {\n      this.props.canvasContext.requestFrame()\n    }\n  }\n  componentWillReceiveProps(nextProps: GLCanvasProps) {\n    if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.maybeResize)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n  componentDidMount() {\n    window.addEventListener('resize', this.onWindowResize)\n  }\n  componentWillUnmount() {\n    if (this.props.canvasContext) {\n      this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize)\n    }\n    window.removeEventListener('resize', this.onWindowResize)\n  }\n  render() {\n    const style = getStyle(this.props.theme)\n    return (\n      <div ref={this.containerRef} className={css(style.glCanvasView)}>\n        <canvas ref={this.ref} width={1} height={1} />\n      </div>\n    )\n  }\n}\n\nexport type ApplicationProps = {\n  setGLCanvas: (canvas: HTMLCanvasElement | null) => void\n  setLoading: (loading: boolean) => void\n  setError: (error: boolean) => void\n  setProfileGroup: (profileGroup: ProfileGroup) => void\n  setDragActive: (dragActive: boolean) => void\n  setViewMode: (viewMode: ViewMode) => void\n  setFlattenRecursion: (flattenRecursion: boolean) => void\n  setProfileIndexToView: (profileIndex: number) => void\n  activeProfileState: ActiveProfileState | null\n  canvasContext: CanvasContext | null\n  theme: Theme\n  profileGroup: ProfileGroupState\n  flattenRecursion: boolean\n  viewMode: ViewMode\n  hashParams: HashParams\n  dragActive: boolean\n  loading: boolean\n  glCanvas: HTMLCanvasElement | null\n  error: boolean\n}\n\nexport class Application extends StatelessComponent<ApplicationProps> {\n  private async loadProfile(loader: () => Promise<ProfileGroup | null>) {\n    // this.props.setLoading(true)\n    await new Promise(resolve => setTimeout(resolve, 0))\n\n    if (!this.props.glCanvas) return\n\n    console.time('import')\n\n    let profileGroup: ProfileGroup | null = null\n    try {\n      profileGroup = await loader()\n    } catch (e) {\n      console.log('Failed to load format', e)\n      this.props.setError(true)\n      return\n    }\n\n    // TODO(jlfwong): Make these into nicer overlays\n    if (profileGroup == null) {\n      alert('Unrecognized format! See documentation about supported formats.')\n      // this.props.setLoading(false)\n      return\n    } else if (profileGroup.profile === null) {\n      alert(\"Successfully imported profile, but it's empty!\")\n      // this.props.setLoading(false)\n      return\n    }\n\n    if (this.props.hashParams.title) {\n      profileGroup = {\n        ...profileGroup,\n        name: this.props.hashParams.title,\n      }\n    }\n    document.title = `${profileGroup.name} - speedscope`\n\n    // if (this.props.hashParams.viewMode) {\n    //   this.props.setViewMode(this.props.hashParams.viewMode)\n    // }\n\n    // for (let profile of profileGroup.profiles) {\n    //   await profile.demangle()\n    // }\n\n    const title = this.props.hashParams.title || profileGroup.profile.getName()\n    profileGroup.profile.setName(title)\n\n    console.timeEnd('import')\n\n    this.props.setProfileGroup(profileGroup)\n    // this.props.setLoading(false)\n  }\n\n  getStyle(): ReturnType<typeof getStyle> {\n    return getStyle(this.props.theme)\n  }\n\n  loadSample() {\n    var load = async () => {\n      let f = await fetch(\"/sample.json\");\n      let j: CallTree = await f.json();\n      let profile = convert(j);\n      console.log(profile);\n      let ret: ProfileGroup = {\n        name: \"default\",\n        profile,\n      };\n      return ret;\n    };\n\n    console.log(\"test\");\n    this.loadProfile(load);\n    const evtSource = new EventSource(\"/api/events\");\n    console.log(evtSource);\n    evtSource.onmessage = (event) => {\n      this.loadProfile(load);\n    };\n  }\n\n\n  loadFromApi(url?: string) {\n    var load = async () => {\n      let f = await fetch(url ?? \"/api/current\");\n      let j: CallTree = await f.json();\n      let profile = convert(j);\n      console.log(profile);\n      let ret: ProfileGroup = {\n        name: \"default\",\n        profile,\n      };\n      return ret;\n    };\n\n    this.loadProfile(load);\n    const evtSource = new EventSource(\"/api/events\");\n    console.log(evtSource);\n    evtSource.onmessage = (event) => {\n      console.log(event);\n      this.loadProfile(load);\n    };\n  }\n\n  onWindowKeyPress = async (ev: KeyboardEvent) => {\n    if (ev.key === '1') {\n      this.props.setViewMode(ViewMode.CHRONO_FLAME_CHART)\n    } else if (ev.key === '2') {\n      this.props.setViewMode(ViewMode.LEFT_HEAVY_FLAME_GRAPH)\n    } else if (ev.key === '3') {\n      this.props.setViewMode(ViewMode.SANDWICH_VIEW)\n    } else if (ev.key === 'r') {\n      const {flattenRecursion} = this.props\n      this.props.setFlattenRecursion(!flattenRecursion)\n    } else if (ev.key === 'n') {\n    } else if (ev.key === 'p') {\n    }\n  }\n\n  private onWindowKeyDown = async (ev: KeyboardEvent) => {\n    // This has to be handled on key down in order to prevent the default\n    // page save action.\n    if (ev.key === 's' && (ev.ctrlKey || ev.metaKey)) {\n      ev.preventDefault()\n    } else if (ev.key === 'o' && (ev.ctrlKey || ev.metaKey)) {\n      ev.preventDefault()\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.onWindowKeyDown)\n    window.addEventListener('keypress', this.onWindowKeyPress)\n    this.load();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onWindowKeyDown)\n    window.removeEventListener('keypress', this.onWindowKeyPress)\n  }\n\n  load() {\n    const queryString = window.location.search;\n    const urlParams = new URLSearchParams(queryString);\n    const profileURL = urlParams.get(\"profileURL\");\n    if (profileURL !== null) {\n      return this.loadFromApi(profileURL);\n    }\n\n    return this.loadFromApi();\n  }\n\n  renderLanding() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.landingContainer)}>\n        <div className={css(style.landingMessage)}>\n          {/* <p className={css(style.landingP)}>\n            <a onClick={() => this.loadFromApi()}>start</a>\n          </p> */}\n{/* \n          <p className={css(style.landingP)}>\n            👋 Hi there! Welcome to 🔬speedscope, an interactive{' '}\n            <a\n              className={css(style.link)}\n              href=\"http://www.brendangregg.com/FlameGraphs/cpuflamegraphs.html\"\n            >\n              flamegraph\n            </a>{' '}\n            visualizer. Use it to help you make your software faster.\n          </p>\n          {canUseXHR ? (\n            <p className={css(style.landingP)}>\n              Drag and drop a profile file onto this window to get started, click the big blue\n              button below to browse for a profile to explore, or{' '}\n              <a tabIndex={0} className={css(style.link)} onClick={this.loadExample}>\n                click here\n              </a>{' '}\n              to load an example profile.\n            </p>\n          ) : (\n            <p className={css(style.landingP)}>\n              Drag and drop a profile file onto this window to get started, or click the big blue\n              button below to browse for a profile to explore.\n            </p>\n          )}\n          <div className={css(style.browseButtonContainer)}>\n            <input\n              type=\"file\"\n              name=\"file\"\n              id=\"file\"\n              onChange={this.onFileSelect}\n              className={css(style.hide)}\n            />\n            <label for=\"file\" className={css(style.browseButton)} tabIndex={0}>\n              Browse\n            </label>\n          </div>\n\n          <p className={css(style.landingP)}>\n            See the{' '}\n            <a\n              className={css(style.link)}\n              href=\"https://github.com/jlfwong/speedscope#usage\"\n              target=\"_blank\"\n            >\n              documentation\n            </a>{' '}\n            for information about supported file formats, keyboard shortcuts, and how to navigate\n            around the profile.\n          </p>\n\n          <p className={css(style.landingP)}>\n            speedscope is open source. Please{' '}\n            <a\n              className={css(style.link)}\n              target=\"_blank\"\n              href=\"https://github.com/jlfwong/speedscope/issues\"\n            >\n              report any issues on GitHub\n            </a>\n            .\n          </p> */}\n        </div>\n      </div>\n    )\n  }\n\n  renderError() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.error)}>\n        <div>😿 Something went wrong.</div>\n        <div>Check the JS console for more details.</div>\n      </div>\n    )\n  }\n\n  renderLoadingBar() {\n    const style = this.getStyle()\n    return <div className={css(style.loading)} />\n  }\n\n  renderContent() {\n    const {viewMode, activeProfileState, error, loading, glCanvas} = this.props\n\n    if (error) {\n      return this.renderError()\n    }\n\n    if (loading) {\n      return this.renderLoadingBar()\n    }\n\n    if (!activeProfileState || !glCanvas) {\n      return this.renderLanding()\n    }\n\n    switch (viewMode) {\n      case ViewMode.CHRONO_FLAME_CHART: {\n        return <ChronoFlamechartView activeProfileState={activeProfileState} glCanvas={glCanvas} />\n      }\n      case ViewMode.LEFT_HEAVY_FLAME_GRAPH: {\n        return (\n          <LeftHeavyFlamechartView activeProfileState={activeProfileState} glCanvas={glCanvas} />\n        )\n      }\n      case ViewMode.SANDWICH_VIEW: {\n        return <SandwichViewContainer activeProfileState={activeProfileState} glCanvas={glCanvas} />\n      }\n    }\n  }\n\n  render() {\n    const style = this.getStyle()\n    return (\n      <div\n        className={css(style.root, this.props.dragActive && style.dragTargetRoot)}\n        // style={{maxWidth:\"300px\", maxHeight:\"300px\"}}\n      >\n        <GLCanvas\n          setGLCanvas={this.props.setGLCanvas}\n          canvasContext={this.props.canvasContext}\n          theme={this.props.theme}\n        />\n        <div className={css(style.contentContainer)}>{this.renderContent()}</div>\n        {this.props.dragActive && <div className={css(style.dragTarget)} />}\n      </div>\n    )\n  }\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    glCanvasView: {\n      position: 'absolute',\n      width: '100vw',\n      height: '100vh',\n      zIndex: -1,\n      pointerEvents: 'none',\n    },\n    error: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: '100%',\n    },\n    loading: {\n      height: 3,\n      marginBottom: -3,\n      background: theme.selectionPrimaryColor,\n      transformOrigin: '0% 50%',\n      animationName: [\n        {\n          from: {\n            transform: `scaleX(0)`,\n          },\n          to: {\n            transform: `scaleX(1)`,\n          },\n        },\n      ],\n      animationTimingFunction: 'cubic-bezier(0, 1, 0, 1)',\n      animationDuration: '30s',\n    },\n    root: {\n      width: '100vw',\n      height: '100vh',\n      overflow: 'hidden',\n      display: 'flex',\n      flexDirection: 'column',\n      position: 'relative',\n      fontFamily: FontFamily.MONOSPACE,\n      lineHeight: '20px',\n      color: theme.fgPrimaryColor,\n    },\n    dragTargetRoot: {\n      cursor: 'copy',\n    },\n    dragTarget: {\n      boxSizing: 'border-box',\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      border: `5px dashed ${theme.selectionPrimaryColor}`,\n      pointerEvents: 'none',\n    },\n    contentContainer: {\n      position: 'relative',\n      display: 'flex',\n      overflow: 'hidden',\n      flexDirection: 'column',\n      flex: 1,\n    },\n    landingContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flex: 1,\n    },\n    landingMessage: {\n      maxWidth: 600,\n    },\n    landingP: {\n      marginBottom: 16,\n    },\n    hide: {\n      display: 'none',\n    },\n    browseButtonContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n    },\n    browseButton: {\n      marginBottom: 16,\n      height: 72,\n      flex: 1,\n      maxWidth: 256,\n      textAlign: 'center',\n      fontSize: FontSize.BIG_BUTTON,\n      lineHeight: '72px',\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        background: theme.selectionSecondaryColor,\n      },\n    },\n    link: {\n      color: theme.selectionPrimaryColor,\n      cursor: 'pointer',\n      textDecoration: 'none',\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        color: theme.selectionSecondaryColor,\n      },\n    },\n  }),\n)\n","import {h} from 'preact'\nimport {getCanvasContext} from '../app-state/getters'\nimport {memo, useMemo} from 'preact/compat'\nimport {useActiveProfileState} from '../app-state/active-profile-state'\nimport {useTheme} from './themes/theme'\nimport {\n  dragActiveAtom,\n  errorAtom,\n  flattenRecursionAtom,\n  glCanvasAtom,\n  hashParamsAtom,\n  loadingAtom,\n  profileGroupAtom,\n  viewModeAtom,\n} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {ProfileSearchContextProvider} from './search-view'\nimport {Application} from './application'\n\nexport const ApplicationContainer = memo(() => {\n  const canvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n  const canvasContext = useMemo(() => (canvas ? getCanvasContext({theme, canvas}) : null), [\n    theme,\n    canvas,\n  ])\n\n  return (\n    <ProfileSearchContextProvider>\n      <Application\n        activeProfileState={useActiveProfileState()}\n        canvasContext={canvasContext}\n        setGLCanvas={glCanvasAtom.set}\n        setLoading={loadingAtom.set}\n        setError={errorAtom.set}\n        setProfileGroup={profileGroupAtom.setProfileGroup}\n        setDragActive={dragActiveAtom.set}\n        setViewMode={viewModeAtom.set}\n        setFlattenRecursion={flattenRecursionAtom.set}\n        setProfileIndexToView={profileGroupAtom.setProfileIndexToView}\n        profileGroup={useAtom(profileGroupAtom)}\n        theme={theme}\n        flattenRecursion={useAtom(flattenRecursionAtom)}\n        viewMode={useAtom(viewModeAtom)}\n        hashParams={useAtom(hashParamsAtom)}\n        glCanvas={canvas}\n        dragActive={useAtom(dragActiveAtom)}\n        loading={useAtom(loadingAtom)}\n        error={useAtom(errorAtom)}\n      />\n    </ProfileSearchContextProvider>\n  )\n})\n","import {h, render} from 'preact'\nimport {ApplicationContainer} from './views/application-container'\nimport {ThemeProvider} from './views/themes/theme'\n\nconsole.log(`speedscope v${require('../package.json').version}`)\n\ndeclare const module: any\nif (module.hot) {\n  module.hot.dispose(() => {\n    // Force the old component go through teardown steps\n    render(<div />, document.body, document.body.lastElementChild || undefined)\n  })\n  module.hot.accept()\n}\n\nrender(\n  <ThemeProvider>\n    <ApplicationContainer />\n  </ThemeProvider>,\n  document.body,\n  document.body.lastElementChild || undefined,\n)\n"],"names":["$ceb4742e8f87f5bf$export$6503ec6e8aabbaf","$ceb4742e8f87f5bf$export$f7ad0328861e2f03","$ceb4742e8f87f5bf$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","module","exports","import","parcelRequire","resolve","then","JSON","parse","register","options","rerenderQueue","rerenderCount","defer","prevDebounce","IS_HYDRATE","EMPTY_OBJ","EMPTY_ARR","IS_NON_DIMENSIONAL","assign","obj","props","removeNode","node","parentNode","removeChild","createElement","type","children","normalizedProps","arguments","push","defaultProps","createVNode","key","ref","original","vnode","_children","_parent","_depth","_dom","_nextDom","_component","constructor","_original","Fragment","Component","context","getDomSibling","childIndex","indexOf","sibling","updateParentDomPointers","child","base","enqueueRender","c","_dirty","debounceRendering","process","queue","sort","a","b","_vnode","some","component","commitQueue","oldVNode","newDom","oldDom","parentDom","_parentDom","diff","_globalContext","ownerSVGElement","commitRoot","diffChildren","newParentVNode","oldParentVNode","globalContext","isSvg","excessDomChildren","isHydrating","j","sibDom","firstChildDom","refs","oldChildren","oldChildrenLength","toChildArray","childVNode","undefined","nextDom","outer","appendChild","nextSibling","insertBefore","value","unmount","applyRef","callback","flattened","Array","isArray","setStyle","style","setProperty","test","dom","name","oldValue","s","useCapture","nameLower","cssText","replace","toLowerCase","slice","addEventListener","eventProxy","_listeners","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","e","event","newVNode","tmp","isNew","oldProps","oldState","snapshot","clearProcessingException","newProps","provider","componentContext","newType","_diff","contextType","_id","_defaultValue","_processingException","_pendingError","prototype","render","doRender","sub","state","_renderCallbacks","_nextState","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","_force","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","_render","getChildContext","getSnapshotBeforeUpdate","oldHtml","newHtml","nodeType","localName","document","createTextNode","createElementNS","is","data","call","childNodes","dangerouslySetInnerHTML","attributes","__html","innerHTML","hydrate","diffProps","checked","diffElementNodes","diffed","_catchError","root","_commit","cb","current","parentVNode","skipRemove","r","componentWillUnmount","this","replaceNode","_root","createContext","defaultValue","ctx","Consumer","Provider","subs","_this","_props","old","splice","_contextRef","$a1b3691f0650ca97$export$891a5c5c55cf41aa","ts","$a1b3691f0650ca97$export$b035e44d7bb4278f","keyA","keyB","error","hasCaught","getDerivedStateFromError","setState","componentDidCatch","update","forceUpdate","Promise","bind","setTimeout","$a1b3691f0650ca97$export$d11afe6bddf499aa","map","Map","getOrInsert","t","existing","get","set","forEach","fn","Symbol","iterator","values","$a1b3691f0650ca97$export$32e6b1ae352e94d6","percent","formattedPercent","toFixed","$a1b3691f0650ca97$export$9eed783d03e0135c","x","Math","abs","floor","$a1b3691f0650ca97$export$a57bfe0eb79af278","$a1b3691f0650ca97$export$e3a1df85ec24ef54","lo","hi","f","target","targetRangeSize","console","assert","isNaN","mid","$a1b3691f0650ca97$export$8793edee2d425525","args","$a1b3691f0650ca97$export$4b9b62ff06c37fbc","key1","$a1b3691f0650ca97$export$d4cd83216784f1fe","last","result","$a1b3691f0650ca97$export$a8670da3886698cf","$a1b3691f0650ca97$export$22480462bbc6ab67","alphabet","ret","charAt","$b3cd09ae3b078073$var$ListNode","prev","next","$b3cd09ae3b078073$export$54c2e3dc7acea9f5","head","tail","size","getHead","getTail","getSize","append","prepend","pop","dequeue","remove","$b3cd09ae3b078073$export$182500e6725aad9a","capacity","list","has","listNode","getCapacity","insert","delete","removeLRU","oldest","clear","$21c129a94567057e$export$7d15b64cf5a3a4c4","minVal","maxVal","$21c129a94567057e$export$ac4bca90992eed1","y","withX","withY","plus","other","minus","times","scalar","timesPointwise","dividedByPointwise","dot","equals","approxEquals","epsilon","length2","sqrt","static","min","max","v","flatten","$21c129a94567057e$export$a1e14422480dc60","m00","m01","m02","m10","m11","m12","withScale","scaledBy","getScale","withTranslation","getTranslation","translatedBy","from","to","origin","timesScalar","det","adj","inverted","transformVector","inverseTransformVector","inv","transformPosition","inverseTransformPosition","transformRect","$21c129a94567057e$export$c79fc6492f3af13d","inverseTransformRect","isEmpty","width","height","left","right","top","bottom","topLeft","topRight","bottomRight","bottomLeft","withOrigin","withSize","closestPointTo","p","distanceFrom","contains","hasIntersectionWith","intersectWith","area","zero","unit","$0baf17bec83b5844$var$assert","condition","$0baf17bec83b5844$export$29d3e417456abdad","$0baf17bec83b5844$export$857ff34b2afe9bff","$41226012ea568170$export$a828a28bf9ab623b","material","transform","setUniformMat3","$41226012ea568170$export$cf7f6524784035f0","vec","setUniformVec2","$41226012ea568170$export$ce239f705f93fc16","gl","setRenderTarget","setViewport","texture","Rect","Color","redF","greenF","blueF","alphaF","BlendOperation","Primitive","AttributeType","PixelFilter","PixelWrap","Graphics","attributeByteLength","FLOAT","Context","setCopyBlendState","setBlendState","ONE","ZERO","setAddBlendState","setPremultipliedBlendState","INVERSE_SOURCE_ALPHA","setUnpremultipliedBlendState","SOURCE_ALPHA","resizeEventHandlers","Set","addAfterResizeEventHandler","add","removeAfterResizeEventHandler","Attribute","count","byteOffset","VertexFormat","_attributes","_stride","stride","VertexBuffer","uploadFloat32Array","floats","upload","Uint8Array","buffer","uploadFloats","Float32Array","TextureFormat","minFilter","magFilter","wrap","LINEAR","CLAMP","NEAREST","_attributeCount","_blendOperations","_contextResetHandlers","_currentClearColor","TRANSPARENT","_currentRenderTarget","_defaultViewport","_forceStateUpdate","_generation","_height","_oldBlendOperations","_oldRenderTarget","_oldViewport","_width","widthInPixels","heightInPixels","canvas","super","getContext","alpha","antialias","depth","preserveDrawingBuffer","stencil","_gl","preventDefault","handleWebglContextRestored","_blendOperationMap","SOURCE_COLOR","SRC_COLOR","TARGET_COLOR","DST_COLOR","INVERSE_SOURCE_COLOR","ONE_MINUS_SRC_COLOR","INVERSE_TARGET_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA","TARGET_ALPHA","DST_ALPHA","ONE_MINUS_SRC_ALPHA","INVERSE_TARGET_ALPHA","ONE_MINUS_DST_ALPHA","CONSTANT","CONSTANT_COLOR","INVERSE_CONSTANT","ONE_MINUS_CONSTANT_COLOR","handler","testContextLoss","generation","addContextResetHandler","removeContextResetHandler","index","$0baf17bec83b5844$var$removeOne","currentRenderTarget","beginFrame","endFrame","source","_packBlendModes","viewport","renderTargetWidthInPixels","renderTargetHeightInPixels","draw","primitive","vertices","_updateRenderTargetAndViewport","Material","prepare","_updateFormat","format","_updateBlendState","drawArrays","TRIANGLES","TRIANGLE_STRIP","byteCount","resize","widthInAppUnits","heightInAppUnits","bounds","getBoundingClientRect","color","clearColor","COLOR_BUFFER_BIT","renderTarget","RenderTarget","createMaterial","vertexSource","fragmentSource","program","createVertexBuffer","createTexture","pixels","Texture","createRenderTarget","ANGLE_instanced_arrays","ANGLE_instanced_arrays_generation","getANGLE_instanced_arrays","getExtension","bindFramebuffer","FRAMEBUFFER","framebuffer","operations","oldOperations","COPY_BLEND_OPERATIONS","disable","BLEND","enable","blendFunc","attribute","isByte","BYTE","vertexAttribPointer","UNSIGNED_BYTE","enableVertexAttribArray","disableVertexAttribArray","getWebGLInfo","ext","getParameter","UNMASKED_RENDERER_WEBGL","UNMASKED_VENDOR_WEBGL","VERSION","Uniform","_material","_name","_location","_isDirty","location","getUniformLocation","UniformFloat","_x","uniform1f","UniformInt","uniform1i","UniformVec2","_y","uniform2f","UniformVec3","_z","z","uniform3f","UniformVec4","_w","w","uniform4f","UniformMat3","_values","m20","m21","m22","_cachedValues","swap","uniformMatrix3fv","UniformSampler","_texture","_index","activeTexture","TEXTURE0","$0baf17bec83b5844$var$TEXTURE_N","bindTexture","TEXTURE_2D","_context","_format","_vertexSource","_fragmentSource","_uniformsMap","_uniformsList","_program","setUniformFloat","uniform","setUniformInt","setUniformVec3","setUniformVec4","setUniformSampler","createProgram","_compileShader","VERTEX_SHADER","FRAGMENT_SHADER","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","attachShader","_buffer","_bytes","_dirtyMin","INT_MAX","_dirtyMax","_totalMin","_totalMax","_byteCount","move","sourceByteOffset","targetByteOffset","subarray","_growDirtyRegion","bytes","free","deleteBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","bufferSubData","_pixels","_isFormatDirty","_isContentDirty","setFormat","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","REPEAT","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","deleteTexture","_framebuffer","_viewport","setColor","createFramebuffer","framebufferTexture2D","COLOR_ATTACHMENT0","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","deleteFramebuffer","$65897108c108b4f9$var$vertexFormat","$65897108c108b4f9$export$de350530845df844","rects","colors","getRectCount","getBuffer","corners","idx","rect","corner","g","addRect","$65897108c108b4f9$export$3f49cc7773303c04","configToPhysical","betweenRects","configSpaceSrcRect","physicalSpaceDstRect","viewportSize","batch","$5d5b8640573d1ed5$export$892596cec99bc70e","L","C","H","hPrime","X","R1","G1","B1","m","hex","parseInt","substr","withAlpha","toCSS","$2faea985926545a3$export$6c7fc68cf9db1b8f","rectangleBatchRenderer","textureRenderer","NEAREST_CLAMP","rowCache","clearLineBatch","getResolution","allocateLine","row","row1","writeToAtlasIfNeeded","textureRect","renderViaAtlas","dstRect","srcRect","$340d047b5a80d488$export$c2fb491145c3d9e3","vertexFormat","pos","uv","uvRect","ndcRect","NDC","$fb847b2fa4942cd4$var$vertexFormat","$fb847b2fa4942cd4$export$7d9ef8e5aa75002c","theme","fromCSSHex","fgSecondaryColor","rgb","$fb847b2fa4942cd4$var$frag","configSpaceToPhysicalViewSpace","configSpaceViewportRect","$8745987472ef7866$var$vertexFormat","$8745987472ef7866$export$7e180bd88c161328","colorForBucketGLSL","rectInfoTexture","uvTransform","positionTransform","uvSpacePixelSize","renderOutlines","$67101eb0b3f0bda5$export$eefcd8ea59422f9d","viewportRectangleRenderer","flamechartColorPassRenderer","onBeforeFrame","webGLInfo","log","renderer","vendor","version","window","animationFrameRequest","beforeFrameHandlers","addBeforeFrameHandler","removeBeforeFrameHandler","requestFrame","requestAnimationFrame","bgPrimaryColor","physicalBounds","viewportBefore","renderBehind","el","devicePixelRatio","$0329b2851cc73338$export$a4dc1a700a084484","CodeType","$f607ed3f7b1d6664$export$25ee60f6195d465f","frameToColorBucket","frame","color_key","$f607ed3f7b1d6664$export$41738d5deb2398de","getColorBucketForFrame","colorForBucket","$f607ed3f7b1d6664$export$f87f86bc40997ba6","$f607ed3f7b1d6664$export$d7e9c14beb1ca060","canvasContext","$f607ed3f7b1d6664$export$e5a34b94d5ce91d9","profile","flattenRecursion","getProfileWithRecursionFlattened","$f607ed3f7b1d6664$export$97826b466e839639","Native","Python","currentIndex","currentComponent","prevRaf","currentHook","afterPaintEffects","oldBeforeRender","oldAfterDiff","oldCommit","oldBeforeUnmount","getHookState","_hook","hooks","__hooks","_list","_pendingEffects","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","_value","action","nextValue","useEffect","_skipEffects","argsChanged","_args","useLayoutEffect","useRef","initialValue","useMemo","factory","_factory","useCallback","useContext","flushAfterPaintEffects","invokeCleanup","invokeEffect","hook","_cleanup","oldArgs","newArgs","arg","shallowDiffers","raf","done","clearTimeout","timeout","cancelAnimationFrame","filter","n","isPureReactComponent","create","__proto__","memo","comparer","shouldUpdate","nextProps","updateRef","Memoed","isReactComponent","displayName","_forwarded","oldDiffHook","oldCatchError","detachedClone","Suspense","_pendingSuspensionCount","_suspenders","_detachOnNextRender","suspended","_suspended","SuspenseList","_next","_map","_childDidSuspend","promise","suspendingComponent","onResolved","onSuspensionComplete","_suspendedComponentWillUnmount","fallback","revealOrder","delegated","unsuspend","wrappedUnsuspend","reverse","ContextProvider","CAMEL_PROPS","REACT_ELEMENT_TYPE","for","oldEventHook","setSafeDescriptor","proto","defineProperty","configurable","persist","stoppedPropagating","defaultPrevented","origStopPropagation","stopPropagation","origPreventDefault","isPropagationStopped","isDefaultPrevented","nativeEvent","classNameDescriptor","class","oldVNodeHook","$$typeof","className","enumerable","shouldSanitize","attrs","multiple","selected","ondoubleclick","ondblclick","onbeforeinput","onchange","normalized","oninput","_patchedLifecycles","$124802f44affb1ce$export$53ec42062883b2d4","$9f4f8377a915f70c$export$80986e6afdd7e0cb","debugKey","observers","subscribe","listener","unsubscribe","$9f4f8377a915f70c$export$83cf7ae8bb57e7ed","atom","setValue","$45bd7cc95e7dcdcd$export$60241385465d0a34","$45bd7cc95e7dcdcd$export$e5c5a5f917a5871c","ViewMode","$a81f3135edc5849d$var$getViewMode","CHRONO_FLAME_CHART","LEFT_HEAVY_FLAME_GRAPH","SANDWICH_VIEW","$80a01705ed451701$export$d47c3a0a207ab0db","FlamechartID","$80a01705ed451701$var$initialFlameChartViewState","hover","selectedNode","empty","logicalSpaceViewportSize","$df85532a33a8c58f$export$888a123ccfcd4a53","$df85532a33a8c58f$export$2ccbf3cddda1b8ce","$df85532a33a8c58f$export$e19cded8976145d0","$df85532a33a8c58f$export$cbbf02dcc9e0e3b2","$df85532a33a8c58f$export$dcdcf3152b2869b2","newState","getActiveProfile","setProfileGroup","group","chronoViewState","leftHeavyViewState","sandwichViewState","callerCallee","updateActiveProfileState","updateActiveSandwichViewState","setSelectedFrame","invertedCallerFlamegraph","calleeFlamegraph","selectedFrame","updateFlamechartState","CHRONO","LEFT_HEAVY","SANDWICH_CALLEES","SANDWICH_INVERTED_CALLERS","setFlamechartHoveredNode","setSelectedNode","setConfigSpaceViewportRect","setLogicalSpaceViewportSize","clearHoverNode","$df85532a33a8c58f$var$hashParams","hashContents","hash","startsWith","components","split","decodeURIComponent","profileURL","title","localProfilePath","mode","viewMode","$df85532a33a8c58f$export$12ead0bb736f7496","$df85532a33a8c58f$export$e7843da9370e3264","$df85532a33a8c58f$export$547be0abd8813a0d","$df85532a33a8c58f$var$protocol","protocol","$df85532a33a8c58f$var$isImmediatelyLoading","$df85532a33a8c58f$export$e68b3a893baef06a","$df85532a33a8c58f$export$76bc5db52f7f557c","$df85532a33a8c58f$export$c4fb72ec5ef10400","SortField","$df85532a33a8c58f$export$79e2d9500680dd96","SortDirection","$df85532a33a8c58f$export$1b0f458cc925a6e6","field","SELF","direction","DESCENDING","$5971878ccf2d1f2d$export$e36625433912fd9","profileGroupState","profileState","$11471ca46705abd3$export$610a58c777d52843","ColorScheme","$11471ca46705abd3$var$localStorageKey","$11471ca46705abd3$var$nextColorScheme","scheme","matchMedia","matches","$11471ca46705abd3$export$6fd607c9f8d4154f","cycleToNextColorScheme","storedPreference","localStorage","$11471ca46705abd3$var$getStoredPreference","$4a0313e471083a35$var$Colors","Colors","$4a0313e471083a35$var$colorForBucketGLSL","$4a0313e471083a35$export$3e936a8db52a10a0","fgPrimaryColor","LIGHTER_GRAY","GRAY","OFF_BLACK","bgSecondaryColor","DARKER_GRAY","altFgPrimaryColor","altFgSecondaryColor","altBgPrimaryColor","BLACK","altBgSecondaryColor","selectionPrimaryColor","BLUE","selectionSecondaryColor","PALE_BLUE","weightColor","GREEN","searchMatchTextColor","searchMatchPrimaryColor","BROWN","searchMatchSecondaryColor","LIGHT_BROWN","fromLumaChromaHue","$1553233033c82043$var$Colors","$1553233033c82043$var$colorForBucketGLSL","$1553233033c82043$export$f30cb9bc4f736419","LIGHT_GRAY","WHITE","OFF_WHITE","DARK_GRAY","DARK_BLUE","PALE_DARK_BLUE","ORANGE","YELLOW","$a7e88f94d7ed8ee2$export$2c657da244d00bd6","$92964d4f3799f19a$export$fd42f52fd3ae1109","$a7e88f94d7ed8ee2$export$93d4e7f90805808f","$45bd7cc95e7dcdcd$export$fae74005e78b1a27","$a7e88f94d7ed8ee2$export$e8748c6a27b910dc","$a7e88f94d7ed8ee2$var$matchMediaDarkColorScheme","$cfa731657d37b6e9$exports","default","property","$cfa731657d37b6e9$var$_isPrefixedValue2","$cfa731657d37b6e9$var$prefixes","prefix","$37f3afca439f8596$exports","$37f3afca439f8596$var$regex","__esModule","$4e18f485a2addec2$exports","$4e18f485a2addec2$var$_isPrefixedValue2","$4e18f485a2addec2$var$prefixes","$4e18f485a2addec2$var$_interopRequireDefault","$8c7954e2243042ed$exports","$8c7954e2243042ed$var$values","hasOwnProperty","$8c7954e2243042ed$var$prefixes","grab","grabbing","$997a3c2d3a8bfda7$exports","$997a3c2d3a8bfda7$var$_isPrefixedValue2","$997a3c2d3a8bfda7$var$prefixes","$997a3c2d3a8bfda7$var$_interopRequireDefault","$388827e530b07d61$exports","$388827e530b07d61$var$values","flex","$38f20d08605aa7cd$exports","$38f20d08605aa7cd$var$alternativeProps","$38f20d08605aa7cd$var$alternativeValues","alignContent","alignSelf","alignItems","justifyContent","order","flexGrow","flexShrink","flexBasis","$0dd6e6e1ba4aab9b$exports","WebkitBoxOrient","WebkitBoxDirection","$0dd6e6e1ba4aab9b$var$alternativeProps","$0dd6e6e1ba4aab9b$var$alternativeValues","flexWrap","$bef04550b5ea89c1$exports","$bef04550b5ea89c1$var$_isPrefixedValue2","$bef04550b5ea89c1$var$values","$bef04550b5ea89c1$var$prefixes","$bef04550b5ea89c1$var$_interopRequireDefault","$bfb2a11e9e815bc7$exports","$bfb2a11e9e815bc7$var$_isPrefixedValue2","$bfb2a11e9e815bc7$var$prefixes","$bfb2a11e9e815bc7$var$_interopRequireDefault","$d4fe8ac21bb3149e$exports","$9b738583e6c50b91$exports","$9b738583e6c50b91$var$properties","$9b738583e6c50b91$var$values","$9b738583e6c50b91$var$prefixes","maxHeight","maxWidth","columnWidth","minWidth","minHeight","$5f9fd35e2b655778$exports","propertyPrefixMap","$5f9fd35e2b655778$var$properties","outputValue","$5f9fd35e2b655778$var$_isPrefixedValue2","multipleValues","len","singleValue","dashCaseProperty","$5f9fd35e2b655778$var$_hyphenateProperty2","prefixes","pLen","unshift","$5f9fd35e2b655778$var$prefixMapping","join","$5f9fd35e2b655778$var$prefixValue","webkitOutput","val","mozOutput","$5f9fd35e2b655778$var$_capitalizeString2","$b8f13b81236714d2$exports","$b8f13b81236714d2$var$_hyphenateStyleName2","$7a36a300540f570f$var$uppercasePattern","$7a36a300540f570f$var$msPattern","$7a36a300540f570f$var$cache","$b8f13b81236714d2$var$_interopRequireDefault","string","$5f9fd35e2b655778$var$_interopRequireDefault","$013ab630280db2a5$exports","str","toUpperCase","transition","transitionProperty","WebkitTransition","WebkitTransitionProperty","MozTransition","MozTransitionProperty","Webkit","Moz","ms","$a3745222047730bb$exports","charCodeAt","$4d21ec6e5959b806$exports","_ref","prefixMap","plugins","prefixAll","$4d21ec6e5959b806$var$_isObject2","combinedValue","processedValue","$4d21ec6e5959b806$var$_prefixValue2","$4d21ec6e5959b806$var$_addNewValuesOnly2","_processedValue","$4d21ec6e5959b806$var$_prefixProperty2","$393f77595c64c71e$exports","prefixProperties","newStyle","requiredPrefixes","capitalizedProperty","$393f77595c64c71e$var$_capitalizeString2","styleProperty","$393f77595c64c71e$var$_interopRequireDefault","$4d21ec6e5959b806$var$_interopRequireDefault","$e22106298a3852dd$exports","metaData","$2d3ed75a80ebafd5$var$addIfNew","$2d3ed75a80ebafd5$exports","$4d1d0391466a2b3a$exports","$9ac7bd60ed088822$var$rawAsap","task","$9ac7bd60ed088822$var$queue","$9ac7bd60ed088822$var$requestFlush","$9ac7bd60ed088822$exports","$9ac7bd60ed088822$var$index","$9ac7bd60ed088822$var$flush","scan","newLength","toggle","observer","$9ac7bd60ed088822$var$scope","$parcel$global","self","$9ac7bd60ed088822$var$BrowserMutationObserver","MutationObserver","WebKitMutationObserver","$9ac7bd60ed088822$var$makeRequestCallFromTimer","timeoutHandle","handleTimer","intervalHandle","setInterval","clearInterval","observe","characterData","requestFlush","makeRequestCallFromTimer","$58fb369302c330f5$var$freeTasks","$58fb369302c330f5$var$pendingErrors","$58fb369302c330f5$var$requestErrorThrow","shift","$58fb369302c330f5$var$asap","rawTask","$58fb369302c330f5$var$RawTask","$58fb369302c330f5$exports","onerror","$bef4fd716e6dc9ea$var$w","$bef4fd716e6dc9ea$var$m","$bef4fd716e6dc9ea$var$ms","$bef4fd716e6dc9ea$var$wm","$bef4fd716e6dc9ea$var$wms","$bef4fd716e6dc9ea$var$wmms","$bef4fd716e6dc9ea$var$staticPrefixData","$parcel$interopDefault","transformOrigin","transformOriginX","transformOriginY","backfaceVisibility","perspective","perspectiveOrigin","transformStyle","transformOriginZ","animation","animationDelay","animationDirection","animationFillMode","animationDuration","animationIterationCount","animationName","animationPlayState","animationTimingFunction","appearance","userSelect","fontKerning","textEmphasisPosition","textEmphasis","textEmphasisStyle","textEmphasisColor","boxDecorationBreak","clipPath","maskImage","maskMode","maskRepeat","maskPosition","maskClip","maskOrigin","maskSize","maskComposite","mask","maskBorderSource","maskBorderMode","maskBorderSlice","maskBorderWidth","maskBorderOutset","maskBorderRepeat","maskBorder","maskType","textDecorationStyle","textDecorationSkip","textDecorationLine","textDecorationColor","fontFeatureSettings","breakAfter","breakBefore","breakInside","columnCount","columnFill","columnGap","columnRule","columnRuleColor","columnRuleStyle","columnRuleWidth","columns","columnSpan","writingMode","flexDirection","flexFlow","transitionDelay","transitionDuration","transitionTimingFunction","backdropFilter","scrollSnapType","scrollSnapPointsX","scrollSnapPointsY","scrollSnapDestination","scrollSnapCoordinate","shapeImageThreshold","shapeImageMargin","shapeImageOutside","hyphens","flowInto","flowFrom","regionFragment","boxSizing","textAlignLast","tabSize","wrapFlow","wrapThrough","wrapMargin","touchAction","gridTemplateColumns","gridTemplateRows","gridTemplateAreas","gridTemplate","gridAutoColumns","gridAutoRows","gridAutoFlow","grid","gridRowStart","gridColumnStart","gridRowEnd","gridRow","gridColumn","gridColumnEnd","gridColumnGap","gridRowGap","gridArea","gridGap","textSizeAdjust","borderImage","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","$bef4fd716e6dc9ea$var$_typeof","$bef4fd716e6dc9ea$var$_createClass","defineProperties","descriptor","writable","Constructor","protoProps","staticProps","$bef4fd716e6dc9ea$var$MAP_EXISTS","$bef4fd716e6dc9ea$var$OrderedElements","OrderedElements","instance","TypeError","$bef4fd716e6dc9ea$var$_classCallCheck","elements","keyOrder","shouldReorder","nested","_nested","styleType","$bef4fd716e6dc9ea$var$UPPERCASE_RE","$bef4fd716e6dc9ea$var$UPPERCASE_RE_TO_KEBAB","match","String","$bef4fd716e6dc9ea$var$isUnitlessNumber","boxFlex","boxFlexGroup","boxOrdinalGroup","flexPositive","flexNegative","flexOrder","fontWeight","lineClamp","lineHeight","opacity","orphans","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","$bef4fd716e6dc9ea$var$prefixes","prop","substring","$bef4fd716e6dc9ea$var$prefixKey","$bef4fd716e6dc9ea$var$stringifyValue","$bef4fd716e6dc9ea$var$stringifyAndImportantifyValue","$bef4fd716e6dc9ea$var$importantify","$bef4fd716e6dc9ea$var$hashString","toString","$bef4fd716e6dc9ea$var$prefixAll","$bef4fd716e6dc9ea$var$defaultSelectorHandlers","selector","baseSelector","generateSubtreeStyles","generated","$bef4fd716e6dc9ea$var$generateCSS","generateCSS","styleTypes","selectorHandlers","stringHandlers","useImportant","merged","addStyleType","plainDeclarations","generatedStyles","foundHandler","newSelector","apply","arr","arr2","$bef4fd716e6dc9ea$var$_toConsumableArray","warn","generatedRuleset","$bef4fd716e6dc9ea$var$generateCSSRuleset","$bef4fd716e6dc9ea$var$transformRule","transformValue","$bef4fd716e6dc9ea$var$arrayToObjectKeysReducer","acc","declarations","stringHandlerKeys","$bef4fd716e6dc9ea$var$runStringHandlers","originalElements","reduce","prefixedElements","elementNames","originalStyle","originalIndex","rules","_i","$bef4fd716e6dc9ea$var$_typeof$1","$bef4fd716e6dc9ea$var$styleTag","$bef4fd716e6dc9ea$var$stringHandlers","fontFamily","$bef4fd716e6dc9ea$var$injectStyleOnce","src","object","stringify","finalVal","valVal","valKey","$bef4fd716e6dc9ea$var$injectGeneratedCSSOnce","$bef4fd716e6dc9ea$var$alreadyInjected","$bef4fd716e6dc9ea$var$injectionBuffer","$bef4fd716e6dc9ea$var$isBuffering","generatedCSS","_injectionBuffer","$bef4fd716e6dc9ea$export$10de27beed9e83eb","$bef4fd716e6dc9ea$var$_toConsumableArray$1","definitions","$bef4fd716e6dc9ea$var$flushToArray","cssRules","querySelector","getElementsByTagName","sheet","styleSheet","insertRule","numRules","rule","innerText","$bef4fd716e6dc9ea$var$injectStyleTag","$bef4fd716e6dc9ea$var$addRenderedClassNames","classNames","$bef4fd716e6dc9ea$var$processStyleDefinitions","processStyleDefinitions","styleDefinitions","classNameBits","definitionBits","_definition","_len","$bef4fd716e6dc9ea$var$injectAndGetClassName","$bef4fd716e6dc9ea$var$unminifiedHashFn","$bef4fd716e6dc9ea$var$hashFn","$bef4fd716e6dc9ea$var$StyleSheet","sheetDefinition","mappedSheetDefinition","stringVal","rehydrate","renderedClassNames","$bef4fd716e6dc9ea$var$StyleSheetServer","renderStatic","renderFunc","$bef4fd716e6dc9ea$var$startBuffering","html","css","content","$bef4fd716e6dc9ea$var$Aphrodite","$bef4fd716e6dc9ea$var$makeExports","StyleSheet","extend","extensions","extensionSelectorHandlers","extension","selectorHandler","concat","StyleSheetServer","StyleSheetTestUtils","minify","shouldMinify","_key","$bef4fd716e6dc9ea$export$9d753cd7ae895cce","$bef4fd716e6dc9ea$export$dbf350e5966cf602","$e33e0d310b69e418$export$cd0608c167c7849e","$e33e0d310b69e418$export$80f2abd03de5ca5a","FontSize","$e33e0d310b69e418$export$f173127635a15d2","Sizes","$e33e0d310b69e418$export$3b11bc38611c5941","$e33e0d310b69e418$export$ccb31788083e2069","ZIndex","$e33e0d310b69e418$export$4f331b2d7d83c31c","fillY","fillX","hbox","display","position","overflow","vbox","$2dd34a636dd1cfac$export$8ecdc0bca999b700","FlamechartType","$2dd34a636dd1cfac$export$984551948500238e","searchQuery","getMatchForFrame","forEachFrame","text","pattern","lowerText","toLocaleLowerCase","lowerPattern","lastIndex","matchedRanges","$2dd34a636dd1cfac$export$199e766951286378","$2dd34a636dd1cfac$export$599f93a073170e9a","flamechart","profileResults","getResults","indexForNode","visit","configSpaceBounds","start","end","layers","getLayers","at","$d5036033fe9c176b$var$stopPropagation","ev","$d5036033fe9c176b$export$58a08c370e360ee4","$d5036033fe9c176b$export$84c2c43f158476d7","activeProfileState","searchIsActive","searchResults","$45bd7cc95e7dcdcd$export$1538c33de8887b59","$92964d4f3799f19a$export$c8a8987d4410bf2d","$d5036033fe9c176b$export$a7f9a17ce88d8bab","$2f1a4f75901846f4$export$7c73462e0d25e514","numResults","resultIndex","selectNext","selectPrev","$d5036033fe9c176b$var$getStyle","setSearchQuery","setSearchIsActive","onInput","$45bd7cc95e7dcdcd$export$35808ee640e87ca7","inputRef","$45bd7cc95e7dcdcd$export$b8f5890fc79d6aca","close","selectPrevOrNextResult","shiftKey","onKeyDown","metaKey","ctrlKey","select","$45bd7cc95e7dcdcd$export$6d9c69b0de29b591","onWindowKeyDown","searchView","icon","inputContainer","input","onKeyUp","onKeyPress","$92964d4f3799f19a$export$ffb0004e005737fa","resultCount","button","onClick","viewBox","fill","xmlns","d","stroke","TOOLBAR_HEIGHT","borderWidth","borderColor","borderStyle","fontSize","LABEL","background","border","outline","verticalAlign","margin","padding","$4258d4e5ac6926a2$export$62554da774c01373","toLocaleString","$8a5073690e626161$var$demangleCppModule","$8a5073690e626161$export$8ac72b58abe2ec8","selfWeight","totalWeight","getSelfWeight","getTotalWeight","addToTotalWeight","delta","addToSelfWeight","overwriteWeightWith","$8a5073690e626161$export$b89a827e9254211a","info","file","line","col","$8a5073690e626161$export$dd7b4544d3e8d686","isRoot","isFrozen","frozen","freeze","parent","$8a5073690e626161$export$5120f2d0b8d4cab8","frames","appendOrderCalltreeRoot","groupedCalltreeRoot","getAppendOrderCalltreeRoot","getGroupedCalltreeRoot","samples","weights","valueFormatter","shallowClone","formatValue","setValueFormatter","getWeightUnit","getName","setName","totalNonIdleWeight","getTotalNonIdleWeight","sortGroupedCallTree","forEachCallGrouped","openFrame","closeFrame","childTime","forEachCall","prevStack","sampleIndex","stackTop","lca","toOpen","node1","node2","getInvertedProfileForCallersOf","focalFrameInfo","focalFrame","builder","$8a5073690e626161$export$ff212496a468c638","nodes","stack","appendSampleWithWeight","build","getProfileForCalleesOf","findCalls","focalFrameNode","recordSubtree","async","demangleCpp","remapSymbols","remapped","_appendSample","weight","useAppendOrder","framesInStack","frameInfo","find","frame1","pendingSample","appendSampleWithTimestamp","timestamp","centralTimestamp","endTimestamp","startTimestamp","$dfcd81ca29f27ec6$export$99b90a32e17f3e39","$dfcd81ca29f27ec6$var$getStyle","stackChit","backgroundColor","marginRight","$d9e93057f6c094be$export$914c1af338698004","items","axis","renderItems","initialIndexInView","setViewportSize","viewportScrollOffset","setViewportScrollOffset","viewportRef","widthOrHeight","leftOrTop","scrollLeftOrScrollTop","initialScroll","viewportCallback","scrollTo","rangeResult","minY","maxY","total","invisiblePrefixSize","firstVisibleIndex","totalSize","onViewportScroll","resizeListener","visibleItems","lastVisibleIndex","onScroll","$199ce5ed98eda142$var$HBarDisplay","$199ce5ed98eda142$var$getStyle","hBarDisplay","hBarDisplayFilled","perc","$199ce5ed98eda142$var$SortIcon","activeDirection","upFill","ASCENDING","downFill","sortIcon","$199ce5ed98eda142$var$ProfileTableRowView","getCSSColorForFrame","totalPerc","selfPerc","tableRow","tableRowEven","tableRowSelected","numericCell","textCell","ranges","highlightedClassName","spans","range","$199ce5ed98eda142$var$highlightRanges","matched","matchedSelected","$199ce5ed98eda142$export$a1685835d634a07d","sortMethod","setSortMethod","onSortClick","SYMBOL_NAME","TOTAL","sandwichContext","$9d24351fb9f6cc71$export$bf6f737e6efba494","firstIndex","rows","rowList","getSearchMatchForFrame","emptyState","tableView","listItems","FRAME_HEIGHT","onTotalClick","onSelfClick","onSymbolNameClick","profileTableView","tableHeader","scrollView","getIndexForFrame","overflowY","overflowX","borderRadius","borderBottom","textAlign","textOverflow","whiteSpace","paddingRight","$199ce5ed98eda142$export$ea99ed11e1a27aec","ownProps","tableSortMethod","$6cb58a251d051f5c$export$60eecfd39873be6d","getMinFrameWidth","minFrameWidth","getClampedViewportWidth","viewportWidth","maxZoom","pow","getClampedConfigSpaceViewportRect","renderInverted","configSpaceSize","clamp","Infinity","layerIndex","isFinite","$30fc58c2097e6c88$var$RangeTreeLeafNode","numPrecedingRectanglesInRow","getBatch","getBounds","getChildren","getParity","forEachLeafNodeWithinBounds","$30fc58c2097e6c88$var$RangeTreeInteriorNode","rectCount","minLeft","maxRight","minTop","maxBottom","$30fc58c2097e6c88$export$fbbfbcf840f22b41","stackDepth","zoomLevel","$30fc58c2097e6c88$export$1f833ed4bb4d6884","rowAtlas","colorPassRenderer","rectInfoRenderTarget","atlasKeys","nLayers","leafNodes","layer","getRectInfoTexture","getRectInfoRenderTarget","configSpaceBoundsForKey","atlasKeysToRender","ceil","configSpaceContentWidth","numAtlasEntriesPerLayer","cacheCapacity","keysToRenderCached","keysToRenderUncached","textureDstRect","leaf","viewportRect","configToViewport","configSpaceSrcRect1","$5bd9a64c3e54fc25$export$77600ee502f92dd1","hoverCount","minimap","MINIMAP_HEIGHT","SEPARATOR_HEIGHT","panZoomView","detailView","DETAIL_VIEW_HEIGHT","borderTop","stackTraceViewPadding","stackTraceView","stackLine","stackFileLine","statsTable","statsTableHeader","statsTableCell","thisInstanceCell","allInstancesCell","barDisplay","$90eb6195c6758ce2$var$measureTextCache","$90eb6195c6758ce2$var$IndexTypeInTrimmed","$90eb6195c6758ce2$var$lastDevicePixelRatio","$90eb6195c6758ce2$export$9829b8aab24854","measureText","$90eb6195c6758ce2$export$f6e59a8b7e2fe3cc","trimmedString","trimmedLength","prefixLength","suffixLength","originalString","originalLength","suffix","$90eb6195c6758ce2$export$b58c197392981dcd","IndexTypeInTrimmed","$90eb6195c6758ce2$var$getIndexTypeInTrimmed","IN_PREFIX","ELIDED","IN_SUFFIX","$90eb6195c6758ce2$export$df3e4d3a22dd5436","trimmedText","rangesToHighlightInTrimmedText","lengthLoss","highlightedEllipsis","origStart","origEnd","startPosType","endPosType","$2431de7973c78586$var$DraggingMode","DraggingMode","$2431de7973c78586$export$af2f267d57ccb950","$92964d4f3799f19a$export$16fa2f45be04daa8","container","containerRef","element","overlayCanvas","overlayCtx","physicalViewSize","getStyle","minimapOrigin","logicalToPhysicalViewSpace","windowToLogicalViewSpace","renderRects","flamechartRenderer","renderOverlays","clearRect","targetInterval","physicalViewSpaceFrameHeight","physicalViewSpaceFontSize","labelPaddingPx","font","MONOSPACE","textBaseline","interval","log10","fillStyle","fillRect","round","labelText","textWidth","fillText","onWindowResize","renderCanvas","resizeOverlayCanvasIfNeeded","scaledWidth","scaledHeight","maybeClearInteractionLock","frameHadWheelEvent","framesWithoutWheelEvents","interactionLock","pan","logicalViewSpaceDelta","physicalDelta","configDelta","transformViewport","multiplier","configSpaceViewport","configSpaceCenter","zoomTransform","onWheel","deltaY","deltaX","configSpaceMouse","logicalSpaceMouse","clientX","clientY","physicalSpaceMouse","dragStartConfigSpaceMouse","dragConfigSpaceViewportOffset","draggingMode","onMouseDown","TRANSLATE_VIEWPORT","DRAW_NEW_VIEWPORT","onWindowMouseMove","onWindowMouseUp","updateCursor","configStart","configEnd","newOrigin","body","cursor","onMouseLeave","onMouseMove","overlayCanvasRef","$63014f87633110df$var$StatisticsTable","formatter","selectedTotal","selectedSelf","grandTotal","cellStyle","$63014f87633110df$var$StackTraceView","getFrameColor","$63014f87633110df$export$9341e44207a4b87e","$4364a2617bcbcfa5$export$bea695f2d962d90b","argsBatch","$4364a2617bcbcfa5$export$c1cda62c69aec3c0","drawPath","beginPath","h","closePath","lineWidth","strokeStyle","$bab4d82d41368603$export$a4901aaec78ebc0b","hoveredLabel","physicalViewportHeight","physicalFlamegraphHeight","LOGICAL_VIEW_SPACE_FRAME_HEIGHT","minWidthToRender","minConfigSpaceWidthToRender","LABEL_PADDING_PX","labelBatch","fadedLabelBatch","matchedTextHighlightBatch","directlySelectedOutlineBatch","indirectlySelectedOutlineBatch","matchedFrameBatch","renderFrameLabelAndChildren","physicalLabelBounds","lastEndIndex","startIndex","endIndex","highlightWidth","frameOutlineWidth","minConfigSpaceWidthToRenderOutline","renderSpecialFrameOutlines","physicalRectBounds","physicalRectBounds1","physicalViewBounds","strokeRect","renderTimeIndicators","updateConfigSpaceViewport","configSpaceViewportHeight","newSize","onNodeHover","logicalViewSpaceCenter","physicalCenter","lastDragPos","mouseDownPos","offsetX","offsetY","onMouseDrag","logicalMousePos","onDblClick","hoveredBounds","onNodeSelect","logicalViewSpaceMouse","physicalViewSpaceMouse","setHoveredLabel","isZoom","deltaMode","DOM_DELTA_LINE","onWindowKeyPress","code","$4bb82f1aee0f8b92$export$70bab6e8c24214c9","$4bb82f1aee0f8b92$var$getStyle","containerSize","offset","containerWidth","containerHeight","updateLocation","clientRect","leftEdgeX","topEdgeY","hoverTip","hoverTipRow","TOOLTIP_WIDTH_MAX","paddingTop","paddingBottom","pointerEvents","HOVERTIP","paddingLeft","$509aaa1c75f2338f$export$302252f7f09b23ec","$509aaa1c75f2338f$export$623c8eaaa38f74a8","profileSearchResults","flamechartSearchResults","results","$509aaa1c75f2338f$export$4bb223ff000ecad0","flamechartData","selectAndZoomToMatch","configSpaceResultBounds","$7870e0b2ac855436$export$a8bf80511a4bda80","$ec6592d9e8fd7fe0$export$99e3bfe2c27199cc","configSpaceDetailViewHeight","setNodeHover","onNodeClick","renderTooltip","$e943df7e744c21a0$export$543d38eab53a75d5","$e943df7e744c21a0$export$25d2a1bc6faef1d8","$e943df7e744c21a0$export$151a91121773c318","$e943df7e744c21a0$var$getChronoViewFlamechartRenderer","$e943df7e744c21a0$export$a008508e17b9c6c1","glCanvas","setters","$e943df7e744c21a0$export$1941e0c120080b28","$e943df7e744c21a0$var$getLeftHeavyFlamechartRenderer","$e943df7e744c21a0$export$12069d7bde6b8446","$577637b2b4d98305$export$b90f50957fa2de3a","clampViewportToFlamegraph","$577637b2b4d98305$export$3d2f074408bd1b82","$a8f2ab2c4e051a4d$var$getInvertedCallerProfile","$a8f2ab2c4e051a4d$var$getInvertedCallerFlamegraph","invertedCallerProfile","$a8f2ab2c4e051a4d$var$getInvertedCallerFlamegraphRenderer","$a8f2ab2c4e051a4d$export$aaf0b96abb345a5e","$9822a1fa9aea14a7$var$getCalleeProfile","$9822a1fa9aea14a7$var$getCalleeFlamegraph","calleeProfile","$9822a1fa9aea14a7$var$getCalleeFlamegraphRenderer","$9822a1fa9aea14a7$export$ec2676680b8c3ef0","$a761dec63bfbdd1b$export$a5ab6cea3f9564b3","sandwichViewContext","$9d24351fb9f6cc71$var$SandwichView","$9d24351fb9f6cc71$var$getStyle","flamegraphViews","callersAndCallees","panZoomViewWraper","flamechartLabelParent","flamechartLabel","divider","flamechartLabelParentBottom","flamechartLabelBottom","TITLE","borderRight","borderLeft","$9d24351fb9f6cc71$export$c3daef216e2796de","indexByFrame","contextData","profileIndex","$8f3ae730f35eb83f$var$convert","sum","total_samples","prof","aux","curr","curr_node","item","code_type","self_samples","child_node","$8f3ae730f35eb83f$export$9ac8499b9779ac36","HTMLCanvasElement","setGLCanvas","HTMLElement","maybeResize","$8f3ae730f35eb83f$var$getStyle","glCanvasView","$8f3ae730f35eb83f$export$16975c34e60e1e61","loader","time","profileGroup","setError","alert","hashParams","timeEnd","loadSample","load","fetch","json","loadProfile","evtSource","EventSource","onmessage","loadFromApi","url","setViewMode","setFlattenRecursion","queryString","search","URLSearchParams","renderLanding","landingContainer","landingMessage","renderError","renderLoadingBar","loading","renderContent","dragActive","dragTargetRoot","contentContainer","dragTarget","marginBottom","landingP","hide","browseButtonContainer","browseButton","BIG_BUTTON","HOVER_CHANGE","link","textDecoration","$a3dd42fc47cbe1bb$export$3477d6ec1f5fab32","setLoading","setDragActive","setProfileIndexToView","$92964d4f3799f19a$export$b3890eb0ae9dca99","systemPrefersDarkMode","setSystemPrefersDarkMode","matchMediaListener","media","colorScheme","SYSTEM","DARK","LIGHT","$a7e88f94d7ed8ee2$var$getTheme","lastElementChild"],"version":3,"file":"app.c8d29fc3.js.map"}